(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/index.ls":[function(require,module,exports){
var readout, Game;
readout = require('./readout');
Game = require('./game');
readout.install();
Game.start();
},{"./game":"/Users/lakmeer/Projects/cave-story/src/game.ls","./readout":"/Users/lakmeer/Projects/cave-story/src/readout.ls"}],"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/Func.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var apply, curry, flip, fix, over;
apply = curry$(function(f, list){
  return f.apply(null, list);
});
curry = function(f){
  return curry$(f);
};
flip = curry$(function(f, x, y){
  return f(y, x);
});
fix = function(f){
  return function(g){
    return function(){
      return f(g(g)).apply(null, arguments);
    };
  }(function(g){
    return function(){
      return f(g(g)).apply(null, arguments);
    };
  });
};
over = curry$(function(f, g, x, y){
  return f(g(x), g(y));
});
module.exports = {
  curry: curry,
  flip: flip,
  fix: fix,
  apply: apply,
  over: over
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/List.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var each, map, compact, filter, reject, partition, find, head, first, tail, last, initial, empty, reverse, unique, uniqueBy, fold, foldl, fold1, foldl1, foldr, foldr1, unfoldr, concat, concatMap, flatten, difference, intersection, union, countBy, groupBy, andList, orList, any, all, sort, sortWith, sortBy, sum, product, mean, average, maximum, minimum, maximumBy, minimumBy, scan, scanl, scan1, scanl1, scanr, scanr1, slice, take, drop, splitAt, takeWhile, dropWhile, span, breakList, zip, zipWith, zipAll, zipAllWith, at, elemIndex, elemIndices, findIndex, findIndices, toString$ = {}.toString, slice$ = [].slice;
each = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    f(x);
  }
  return xs;
});
map = curry$(function(f, xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    results$.push(f(x));
  }
  return results$;
});
compact = function(xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (x) {
      results$.push(x);
    }
  }
  return results$;
};
filter = curry$(function(f, xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (f(x)) {
      results$.push(x);
    }
  }
  return results$;
});
reject = curry$(function(f, xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!f(x)) {
      results$.push(x);
    }
  }
  return results$;
});
partition = curry$(function(f, xs){
  var passed, failed, i$, len$, x;
  passed = [];
  failed = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    (f(x) ? passed : failed).push(x);
  }
  return [passed, failed];
});
find = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (f(x)) {
      return x;
    }
  }
});
head = first = function(xs){
  return xs[0];
};
tail = function(xs){
  if (!xs.length) {
    return;
  }
  return xs.slice(1);
};
last = function(xs){
  return xs[xs.length - 1];
};
initial = function(xs){
  if (!xs.length) {
    return;
  }
  return xs.slice(0, -1);
};
empty = function(xs){
  return !xs.length;
};
reverse = function(xs){
  return xs.concat().reverse();
};
unique = function(xs){
  var result, i$, len$, x;
  result = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!in$(x, result)) {
      result.push(x);
    }
  }
  return result;
};
uniqueBy = curry$(function(f, xs){
  var seen, i$, len$, x, val, results$ = [];
  seen = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    val = f(x);
    if (in$(val, seen)) {
      continue;
    }
    seen.push(val);
    results$.push(x);
  }
  return results$;
});
fold = foldl = curry$(function(f, memo, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    memo = f(memo, x);
  }
  return memo;
});
fold1 = foldl1 = curry$(function(f, xs){
  return fold(f, xs[0], xs.slice(1));
});
foldr = curry$(function(f, memo, xs){
  var i$, x;
  for (i$ = xs.length - 1; i$ >= 0; --i$) {
    x = xs[i$];
    memo = f(x, memo);
  }
  return memo;
});
foldr1 = curry$(function(f, xs){
  return foldr(f, xs[xs.length - 1], xs.slice(0, -1));
});
unfoldr = curry$(function(f, b){
  var result, x, that;
  result = [];
  x = b;
  while ((that = f(x)) != null) {
    result.push(that[0]);
    x = that[1];
  }
  return result;
});
concat = function(xss){
  return [].concat.apply([], xss);
};
concatMap = curry$(function(f, xs){
  var x;
  return [].concat.apply([], (function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xs).length; i$ < len$; ++i$) {
      x = ref$[i$];
      results$.push(f(x));
    }
    return results$;
  }()));
});
flatten = function(xs){
  var x;
  return [].concat.apply([], (function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xs).length; i$ < len$; ++i$) {
      x = ref$[i$];
      if (toString$.call(x).slice(8, -1) === 'Array') {
        results$.push(flatten(x));
      } else {
        results$.push(x);
      }
    }
    return results$;
  }()));
};
difference = function(xs){
  var yss, results, i$, len$, x, j$, len1$, ys;
  yss = slice$.call(arguments, 1);
  results = [];
  outer: for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    for (j$ = 0, len1$ = yss.length; j$ < len1$; ++j$) {
      ys = yss[j$];
      if (in$(x, ys)) {
        continue outer;
      }
    }
    results.push(x);
  }
  return results;
};
intersection = function(xs){
  var yss, results, i$, len$, x, j$, len1$, ys;
  yss = slice$.call(arguments, 1);
  results = [];
  outer: for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    for (j$ = 0, len1$ = yss.length; j$ < len1$; ++j$) {
      ys = yss[j$];
      if (!in$(x, ys)) {
        continue outer;
      }
    }
    results.push(x);
  }
  return results;
};
union = function(){
  var xss, results, i$, len$, xs, j$, len1$, x;
  xss = slice$.call(arguments);
  results = [];
  for (i$ = 0, len$ = xss.length; i$ < len$; ++i$) {
    xs = xss[i$];
    for (j$ = 0, len1$ = xs.length; j$ < len1$; ++j$) {
      x = xs[j$];
      if (!in$(x, results)) {
        results.push(x);
      }
    }
  }
  return results;
};
countBy = curry$(function(f, xs){
  var results, i$, len$, x, key;
  results = {};
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    key = f(x);
    if (key in results) {
      results[key] += 1;
    } else {
      results[key] = 1;
    }
  }
  return results;
});
groupBy = curry$(function(f, xs){
  var results, i$, len$, x, key;
  results = {};
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    key = f(x);
    if (key in results) {
      results[key].push(x);
    } else {
      results[key] = [x];
    }
  }
  return results;
});
andList = function(xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!x) {
      return false;
    }
  }
  return true;
};
orList = function(xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (x) {
      return true;
    }
  }
  return false;
};
any = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (f(x)) {
      return true;
    }
  }
  return false;
});
all = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!f(x)) {
      return false;
    }
  }
  return true;
});
sort = function(xs){
  return xs.concat().sort(function(x, y){
    if (x > y) {
      return 1;
    } else if (x < y) {
      return -1;
    } else {
      return 0;
    }
  });
};
sortWith = curry$(function(f, xs){
  return xs.concat().sort(f);
});
sortBy = curry$(function(f, xs){
  return xs.concat().sort(function(x, y){
    if (f(x) > f(y)) {
      return 1;
    } else if (f(x) < f(y)) {
      return -1;
    } else {
      return 0;
    }
  });
});
sum = function(xs){
  var result, i$, len$, x;
  result = 0;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    result += x;
  }
  return result;
};
product = function(xs){
  var result, i$, len$, x;
  result = 1;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    result *= x;
  }
  return result;
};
mean = average = function(xs){
  var sum, i$, len$, x;
  sum = 0;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    sum += x;
  }
  return sum / xs.length;
};
maximum = function(xs){
  var max, i$, ref$, len$, x;
  max = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (x > max) {
      max = x;
    }
  }
  return max;
};
minimum = function(xs){
  var min, i$, ref$, len$, x;
  min = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (x < min) {
      min = x;
    }
  }
  return min;
};
maximumBy = curry$(function(f, xs){
  var max, i$, ref$, len$, x;
  max = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (f(x) > f(max)) {
      max = x;
    }
  }
  return max;
});
minimumBy = curry$(function(f, xs){
  var min, i$, ref$, len$, x;
  min = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (f(x) < f(min)) {
      min = x;
    }
  }
  return min;
});
scan = scanl = curry$(function(f, memo, xs){
  var last, x;
  last = memo;
  return [memo].concat((function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xs).length; i$ < len$; ++i$) {
      x = ref$[i$];
      results$.push(last = f(last, x));
    }
    return results$;
  }()));
});
scan1 = scanl1 = curry$(function(f, xs){
  if (!xs.length) {
    return;
  }
  return scan(f, xs[0], xs.slice(1));
});
scanr = curry$(function(f, memo, xs){
  xs = xs.concat().reverse();
  return scan(f, memo, xs).reverse();
});
scanr1 = curry$(function(f, xs){
  if (!xs.length) {
    return;
  }
  xs = xs.concat().reverse();
  return scan(f, xs[0], xs.slice(1)).reverse();
});
slice = curry$(function(x, y, xs){
  return xs.slice(x, y);
});
take = curry$(function(n, xs){
  if (n <= 0) {
    return xs.slice(0, 0);
  } else {
    return xs.slice(0, n);
  }
});
drop = curry$(function(n, xs){
  if (n <= 0) {
    return xs;
  } else {
    return xs.slice(n);
  }
});
splitAt = curry$(function(n, xs){
  return [take(n, xs), drop(n, xs)];
});
takeWhile = curry$(function(p, xs){
  var len, i;
  len = xs.length;
  if (!len) {
    return xs;
  }
  i = 0;
  while (i < len && p(xs[i])) {
    i += 1;
  }
  return xs.slice(0, i);
});
dropWhile = curry$(function(p, xs){
  var len, i;
  len = xs.length;
  if (!len) {
    return xs;
  }
  i = 0;
  while (i < len && p(xs[i])) {
    i += 1;
  }
  return xs.slice(i);
});
span = curry$(function(p, xs){
  return [takeWhile(p, xs), dropWhile(p, xs)];
});
breakList = curry$(function(p, xs){
  return span(function(){
    return not$(p.apply(this, arguments));
  }, xs);
});
zip = curry$(function(xs, ys){
  var result, len, i$, len$, i, x;
  result = [];
  len = ys.length;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (i === len) {
      break;
    }
    result.push([x, ys[i]]);
  }
  return result;
});
zipWith = curry$(function(f, xs, ys){
  var result, len, i$, len$, i, x;
  result = [];
  len = ys.length;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (i === len) {
      break;
    }
    result.push(f(x, ys[i]));
  }
  return result;
});
zipAll = function(){
  var xss, minLength, i$, len$, xs, ref$, i, lresult$, j$, results$ = [];
  xss = slice$.call(arguments);
  minLength = 9e9;
  for (i$ = 0, len$ = xss.length; i$ < len$; ++i$) {
    xs = xss[i$];
    minLength <= (ref$ = xs.length) || (minLength = ref$);
  }
  for (i$ = 0; i$ < minLength; ++i$) {
    i = i$;
    lresult$ = [];
    for (j$ = 0, len$ = xss.length; j$ < len$; ++j$) {
      xs = xss[j$];
      lresult$.push(xs[i]);
    }
    results$.push(lresult$);
  }
  return results$;
};
zipAllWith = function(f){
  var xss, minLength, i$, len$, xs, ref$, i, results$ = [];
  xss = slice$.call(arguments, 1);
  minLength = 9e9;
  for (i$ = 0, len$ = xss.length; i$ < len$; ++i$) {
    xs = xss[i$];
    minLength <= (ref$ = xs.length) || (minLength = ref$);
  }
  for (i$ = 0; i$ < minLength; ++i$) {
    i = i$;
    results$.push(f.apply(null, (fn$())));
  }
  return results$;
  function fn$(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xss).length; i$ < len$; ++i$) {
      xs = ref$[i$];
      results$.push(xs[i]);
    }
    return results$;
  }
};
at = curry$(function(n, xs){
  if (n < 0) {
    return xs[xs.length + n];
  } else {
    return xs[n];
  }
});
elemIndex = curry$(function(el, xs){
  var i$, len$, i, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (x === el) {
      return i;
    }
  }
});
elemIndices = curry$(function(el, xs){
  var i$, len$, i, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (x === el) {
      results$.push(i);
    }
  }
  return results$;
});
findIndex = curry$(function(f, xs){
  var i$, len$, i, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (f(x)) {
      return i;
    }
  }
});
findIndices = curry$(function(f, xs){
  var i$, len$, i, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (f(x)) {
      results$.push(i);
    }
  }
  return results$;
});
module.exports = {
  each: each,
  map: map,
  filter: filter,
  compact: compact,
  reject: reject,
  partition: partition,
  find: find,
  head: head,
  first: first,
  tail: tail,
  last: last,
  initial: initial,
  empty: empty,
  reverse: reverse,
  difference: difference,
  intersection: intersection,
  union: union,
  countBy: countBy,
  groupBy: groupBy,
  fold: fold,
  fold1: fold1,
  foldl: foldl,
  foldl1: foldl1,
  foldr: foldr,
  foldr1: foldr1,
  unfoldr: unfoldr,
  andList: andList,
  orList: orList,
  any: any,
  all: all,
  unique: unique,
  uniqueBy: uniqueBy,
  sort: sort,
  sortWith: sortWith,
  sortBy: sortBy,
  sum: sum,
  product: product,
  mean: mean,
  average: average,
  concat: concat,
  concatMap: concatMap,
  flatten: flatten,
  maximum: maximum,
  minimum: minimum,
  maximumBy: maximumBy,
  minimumBy: minimumBy,
  scan: scan,
  scan1: scan1,
  scanl: scanl,
  scanl1: scanl1,
  scanr: scanr,
  scanr1: scanr1,
  slice: slice,
  take: take,
  drop: drop,
  splitAt: splitAt,
  takeWhile: takeWhile,
  dropWhile: dropWhile,
  span: span,
  breakList: breakList,
  zip: zip,
  zipWith: zipWith,
  zipAll: zipAll,
  zipAllWith: zipAllWith,
  at: at,
  elemIndex: elemIndex,
  elemIndices: elemIndices,
  findIndex: findIndex,
  findIndices: findIndices
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
function in$(x, xs){
  var i = -1, l = xs.length >>> 0;
  while (++i < l) if (x === xs[i]) return true;
  return false;
}
function not$(x){ return !x; }
},{}],"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/Num.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var max, min, negate, abs, signum, quot, rem, div, mod, recip, pi, tau, exp, sqrt, ln, pow, sin, tan, cos, asin, acos, atan, atan2, truncate, round, ceiling, floor, isItNaN, even, odd, gcd, lcm;
max = curry$(function(x$, y$){
  return x$ > y$ ? x$ : y$;
});
min = curry$(function(x$, y$){
  return x$ < y$ ? x$ : y$;
});
negate = function(x){
  return -x;
};
abs = Math.abs;
signum = function(x){
  if (x < 0) {
    return -1;
  } else if (x > 0) {
    return 1;
  } else {
    return 0;
  }
};
quot = curry$(function(x, y){
  return ~~(x / y);
});
rem = curry$(function(x$, y$){
  return x$ % y$;
});
div = curry$(function(x, y){
  return Math.floor(x / y);
});
mod = curry$(function(x$, y$){
  var ref$;
  return ((x$) % (ref$ = y$) + ref$) % ref$;
});
recip = (function(it){
  return 1 / it;
});
pi = Math.PI;
tau = pi * 2;
exp = Math.exp;
sqrt = Math.sqrt;
ln = Math.log;
pow = curry$(function(x$, y$){
  return Math.pow(x$, y$);
});
sin = Math.sin;
tan = Math.tan;
cos = Math.cos;
asin = Math.asin;
acos = Math.acos;
atan = Math.atan;
atan2 = curry$(function(x, y){
  return Math.atan2(x, y);
});
truncate = function(x){
  return ~~x;
};
round = Math.round;
ceiling = Math.ceil;
floor = Math.floor;
isItNaN = function(x){
  return x !== x;
};
even = function(x){
  return x % 2 === 0;
};
odd = function(x){
  return x % 2 !== 0;
};
gcd = curry$(function(x, y){
  var z;
  x = Math.abs(x);
  y = Math.abs(y);
  while (y !== 0) {
    z = x % y;
    x = y;
    y = z;
  }
  return x;
});
lcm = curry$(function(x, y){
  return Math.abs(Math.floor(x / gcd(x, y) * y));
});
module.exports = {
  max: max,
  min: min,
  negate: negate,
  abs: abs,
  signum: signum,
  quot: quot,
  rem: rem,
  div: div,
  mod: mod,
  recip: recip,
  pi: pi,
  tau: tau,
  exp: exp,
  sqrt: sqrt,
  ln: ln,
  pow: pow,
  sin: sin,
  tan: tan,
  cos: cos,
  acos: acos,
  asin: asin,
  atan: atan,
  atan2: atan2,
  truncate: truncate,
  round: round,
  ceiling: ceiling,
  floor: floor,
  isItNaN: isItNaN,
  even: even,
  odd: odd,
  gcd: gcd,
  lcm: lcm
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/Obj.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var values, keys, pairsToObj, objToPairs, listsToObj, objToLists, empty, each, map, compact, filter, reject, partition, find;
values = function(object){
  var i$, x, results$ = [];
  for (i$ in object) {
    x = object[i$];
    results$.push(x);
  }
  return results$;
};
keys = function(object){
  var x, results$ = [];
  for (x in object) {
    results$.push(x);
  }
  return results$;
};
pairsToObj = function(object){
  var i$, len$, x, results$ = {};
  for (i$ = 0, len$ = object.length; i$ < len$; ++i$) {
    x = object[i$];
    results$[x[0]] = x[1];
  }
  return results$;
};
objToPairs = function(object){
  var key, value, results$ = [];
  for (key in object) {
    value = object[key];
    results$.push([key, value]);
  }
  return results$;
};
listsToObj = curry$(function(keys, values){
  var i$, len$, i, key, results$ = {};
  for (i$ = 0, len$ = keys.length; i$ < len$; ++i$) {
    i = i$;
    key = keys[i$];
    results$[key] = values[i];
  }
  return results$;
});
objToLists = function(object){
  var keys, values, key, value;
  keys = [];
  values = [];
  for (key in object) {
    value = object[key];
    keys.push(key);
    values.push(value);
  }
  return [keys, values];
};
empty = function(object){
  var x;
  for (x in object) {
    return false;
  }
  return true;
};
each = curry$(function(f, object){
  var i$, x;
  for (i$ in object) {
    x = object[i$];
    f(x);
  }
  return object;
});
map = curry$(function(f, object){
  var k, x, results$ = {};
  for (k in object) {
    x = object[k];
    results$[k] = f(x);
  }
  return results$;
});
compact = function(object){
  var k, x, results$ = {};
  for (k in object) {
    x = object[k];
if (x) {
      results$[k] = x;
    }
  }
  return results$;
};
filter = curry$(function(f, object){
  var k, x, results$ = {};
  for (k in object) {
    x = object[k];
if (f(x)) {
      results$[k] = x;
    }
  }
  return results$;
});
reject = curry$(function(f, object){
  var k, x, results$ = {};
  for (k in object) {
    x = object[k];
if (!f(x)) {
      results$[k] = x;
    }
  }
  return results$;
});
partition = curry$(function(f, object){
  var passed, failed, k, x;
  passed = {};
  failed = {};
  for (k in object) {
    x = object[k];
    (f(x) ? passed : failed)[k] = x;
  }
  return [passed, failed];
});
find = curry$(function(f, object){
  var i$, x;
  for (i$ in object) {
    x = object[i$];
    if (f(x)) {
      return x;
    }
  }
});
module.exports = {
  values: values,
  keys: keys,
  pairsToObj: pairsToObj,
  objToPairs: objToPairs,
  listsToObj: listsToObj,
  objToLists: objToLists,
  empty: empty,
  each: each,
  map: map,
  filter: filter,
  compact: compact,
  reject: reject,
  partition: partition,
  find: find
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/Str.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var split, join, lines, unlines, words, unwords, chars, unchars, reverse, repeat, capitalize, camelize, dasherize;
split = curry$(function(sep, str){
  return str.split(sep);
});
join = curry$(function(sep, xs){
  return xs.join(sep);
});
lines = function(str){
  if (!str.length) {
    return [];
  }
  return str.split('\n');
};
unlines = function(it){
  return it.join('\n');
};
words = function(str){
  if (!str.length) {
    return [];
  }
  return str.split(/[ ]+/);
};
unwords = function(it){
  return it.join(' ');
};
chars = function(it){
  return it.split('');
};
unchars = function(it){
  return it.join('');
};
reverse = function(str){
  return str.split('').reverse().join('');
};
repeat = curry$(function(n, str){
  var result, i$;
  result = '';
  for (i$ = 0; i$ < n; ++i$) {
    result += str;
  }
  return result;
});
capitalize = function(str){
  return str.charAt(0).toUpperCase() + str.slice(1);
};
camelize = function(it){
  return it.replace(/[-_]+(.)?/g, function(arg$, c){
    return (c != null ? c : '').toUpperCase();
  });
};
dasherize = function(str){
  return str.replace(/([^-A-Z])([A-Z]+)/g, function(arg$, lower, upper){
    return lower + "-" + (upper.length > 1
      ? upper
      : upper.toLowerCase());
  }).replace(/^([A-Z]+)/, function(arg$, upper){
    if (upper.length > 1) {
      return upper + "-";
    } else {
      return upper.toLowerCase();
    }
  });
};
module.exports = {
  split: split,
  join: join,
  lines: lines,
  unlines: unlines,
  words: words,
  unwords: unwords,
  chars: chars,
  unchars: unchars,
  reverse: reverse,
  repeat: repeat,
  capitalize: capitalize,
  camelize: camelize,
  dasherize: dasherize
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/index.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var Func, List, Obj, Str, Num, id, isType, replicate, prelude, toString$ = {}.toString;
Func = require('./Func.js');
List = require('./List.js');
Obj = require('./Obj.js');
Str = require('./Str.js');
Num = require('./Num.js');
id = function(x){
  return x;
};
isType = curry$(function(type, x){
  return toString$.call(x).slice(8, -1) === type;
});
replicate = curry$(function(n, x){
  var i$, results$ = [];
  for (i$ = 0; i$ < n; ++i$) {
    results$.push(x);
  }
  return results$;
});
Str.empty = List.empty;
Str.slice = List.slice;
Str.take = List.take;
Str.drop = List.drop;
Str.splitAt = List.splitAt;
Str.takeWhile = List.takeWhile;
Str.dropWhile = List.dropWhile;
Str.span = List.span;
Str.breakStr = List.breakList;
prelude = {
  Func: Func,
  List: List,
  Obj: Obj,
  Str: Str,
  Num: Num,
  id: id,
  isType: isType,
  replicate: replicate
};
prelude.each = List.each;
prelude.map = List.map;
prelude.filter = List.filter;
prelude.compact = List.compact;
prelude.reject = List.reject;
prelude.partition = List.partition;
prelude.find = List.find;
prelude.head = List.head;
prelude.first = List.first;
prelude.tail = List.tail;
prelude.last = List.last;
prelude.initial = List.initial;
prelude.empty = List.empty;
prelude.reverse = List.reverse;
prelude.difference = List.difference;
prelude.intersection = List.intersection;
prelude.union = List.union;
prelude.countBy = List.countBy;
prelude.groupBy = List.groupBy;
prelude.fold = List.fold;
prelude.foldl = List.foldl;
prelude.fold1 = List.fold1;
prelude.foldl1 = List.foldl1;
prelude.foldr = List.foldr;
prelude.foldr1 = List.foldr1;
prelude.unfoldr = List.unfoldr;
prelude.andList = List.andList;
prelude.orList = List.orList;
prelude.any = List.any;
prelude.all = List.all;
prelude.unique = List.unique;
prelude.uniqueBy = List.uniqueBy;
prelude.sort = List.sort;
prelude.sortWith = List.sortWith;
prelude.sortBy = List.sortBy;
prelude.sum = List.sum;
prelude.product = List.product;
prelude.mean = List.mean;
prelude.average = List.average;
prelude.concat = List.concat;
prelude.concatMap = List.concatMap;
prelude.flatten = List.flatten;
prelude.maximum = List.maximum;
prelude.minimum = List.minimum;
prelude.maximumBy = List.maximumBy;
prelude.minimumBy = List.minimumBy;
prelude.scan = List.scan;
prelude.scanl = List.scanl;
prelude.scan1 = List.scan1;
prelude.scanl1 = List.scanl1;
prelude.scanr = List.scanr;
prelude.scanr1 = List.scanr1;
prelude.slice = List.slice;
prelude.take = List.take;
prelude.drop = List.drop;
prelude.splitAt = List.splitAt;
prelude.takeWhile = List.takeWhile;
prelude.dropWhile = List.dropWhile;
prelude.span = List.span;
prelude.breakList = List.breakList;
prelude.zip = List.zip;
prelude.zipWith = List.zipWith;
prelude.zipAll = List.zipAll;
prelude.zipAllWith = List.zipAllWith;
prelude.at = List.at;
prelude.elemIndex = List.elemIndex;
prelude.elemIndices = List.elemIndices;
prelude.findIndex = List.findIndex;
prelude.findIndices = List.findIndices;
prelude.apply = Func.apply;
prelude.curry = Func.curry;
prelude.flip = Func.flip;
prelude.fix = Func.fix;
prelude.over = Func.over;
prelude.split = Str.split;
prelude.join = Str.join;
prelude.lines = Str.lines;
prelude.unlines = Str.unlines;
prelude.words = Str.words;
prelude.unwords = Str.unwords;
prelude.chars = Str.chars;
prelude.unchars = Str.unchars;
prelude.repeat = Str.repeat;
prelude.capitalize = Str.capitalize;
prelude.camelize = Str.camelize;
prelude.dasherize = Str.dasherize;
prelude.values = Obj.values;
prelude.keys = Obj.keys;
prelude.pairsToObj = Obj.pairsToObj;
prelude.objToPairs = Obj.objToPairs;
prelude.listsToObj = Obj.listsToObj;
prelude.objToLists = Obj.objToLists;
prelude.max = Num.max;
prelude.min = Num.min;
prelude.negate = Num.negate;
prelude.abs = Num.abs;
prelude.signum = Num.signum;
prelude.quot = Num.quot;
prelude.rem = Num.rem;
prelude.div = Num.div;
prelude.mod = Num.mod;
prelude.recip = Num.recip;
prelude.pi = Num.pi;
prelude.tau = Num.tau;
prelude.exp = Num.exp;
prelude.sqrt = Num.sqrt;
prelude.ln = Num.ln;
prelude.pow = Num.pow;
prelude.sin = Num.sin;
prelude.tan = Num.tan;
prelude.cos = Num.cos;
prelude.acos = Num.acos;
prelude.asin = Num.asin;
prelude.atan = Num.atan;
prelude.atan2 = Num.atan2;
prelude.truncate = Num.truncate;
prelude.round = Num.round;
prelude.ceiling = Num.ceiling;
prelude.floor = Num.floor;
prelude.isItNaN = Num.isItNaN;
prelude.even = Num.even;
prelude.odd = Num.odd;
prelude.gcd = Num.gcd;
prelude.lcm = Num.lcm;
prelude.VERSION = '1.1.1';
module.exports = prelude;
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{"./Func.js":"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/Func.js","./List.js":"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/List.js","./Num.js":"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/Num.js","./Obj.js":"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/Obj.js","./Str.js":"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/Str.js"}],"/Users/lakmeer/Projects/cave-story/src/animated-sprite.ls":[function(require,module,exports){
var std, units, Sprite, AnimatedSprite;
std = require('std');
units = require('./units');
Sprite = require('./sprite');
module.exports = AnimatedSprite = (function(superclass){
  var prototype = extend$((import$(AnimatedSprite, superclass).displayName = 'AnimatedSprite', AnimatedSprite), superclass).prototype, constructor = AnimatedSprite;
  function AnimatedSprite(graphics, path, sourceX, sourceY, width, height, fps, numFrames){
    this.width = width;
    this.height = height;
    this.fps = fps;
    this.numFrames = numFrames;
    AnimatedSprite.superclass.apply(this, arguments);
    this.frameTime = 1000 / this.fps;
    this.currentFrame = 0;
    this.elapsedTime = 0;
  }
  prototype.update = function(elapsedTime){
    this.elapsedTime += elapsedTime;
    if (this.elapsedTime > this.frameTime) {
      this.currentFrame += 1;
      this.elapsedTime = 0;
      if (this.currentFrame < this.numFrames) {
        return this.sourceRect.x += this.sourceRect.w;
      } else {
        this.sourceRect.x -= this.sourceRect.w * (this.numFrames - 1);
        return this.currentFrame = 0;
      }
    }
  };
  return AnimatedSprite;
}(Sprite));
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"./sprite":"/Users/lakmeer/Projects/cave-story/src/sprite.ls","./units":"/Users/lakmeer/Projects/cave-story/src/units.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/backdrop.ls":[function(require,module,exports){
var std, SDL, units, config, kScreenWidth, kScreenHeight, kBackgroundSize, FixedBackdrop, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
SDL = require('SDL');
units = require('./units');
config = require('./config');
kScreenWidth = config.kScreenWidth, kScreenHeight = config.kScreenHeight;
kBackgroundSize = 4;
out$.FixedBackdrop = FixedBackdrop = (function(){
  FixedBackdrop.displayName = 'FixedBackdrop';
  var prototype = FixedBackdrop.prototype, constructor = FixedBackdrop;
  function FixedBackdrop(path, graphics){
    this.surface = graphics.loadImage(path);
  }
  prototype.draw = function(graphics){
    var i$, step$, to$, x, lresult$, j$, step1$, to1$, y, destRect, results$ = [];
    for (i$ = 0, to$ = units.tileToPx(kScreenWidth + kBackgroundSize), step$ = units.tileToPx(kBackgroundSize); step$ < 0 ? i$ >= to$ : i$ <= to$; i$ += step$) {
      x = i$;
      lresult$ = [];
      for (j$ = 0, to1$ = units.tileToPx(kScreenHeight + kBackgroundSize), step1$ = units.tileToPx(kBackgroundSize); step1$ < 0 ? j$ >= to1$ : j$ <= to1$; j$ += step1$) {
        y = j$;
        destRect = new SDL.Rect(x, y, units.tileToPx(kBackgroundSize), units.tileToPx(kBackgroundSize));
        lresult$.push(graphics.blitSurface(this.surface, null, destRect));
      }
      results$.push(lresult$);
    }
    return results$;
  };
  return FixedBackdrop;
}());
},{"./config":"/Users/lakmeer/Projects/cave-story/src/config.ls","./units":"/Users/lakmeer/Projects/cave-story/src/units.ls","SDL":"/Users/lakmeer/Projects/cave-story/src/sdl/index.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/config.ls":[function(require,module,exports){
var kScreenWidth, kScreenHeight, kFps, kDebugMode, out$ = typeof exports != 'undefined' && exports || this;
out$.kScreenWidth = kScreenWidth = 20;
out$.kScreenHeight = kScreenHeight = 15;
out$.kFps = kFps = 60;
out$.kDebugMode = kDebugMode = true;
},{}],"/Users/lakmeer/Projects/cave-story/src/game.ls":[function(require,module,exports){
var std, SDL, input, units, config, readout, graphics, Map, Player, FixedBackdrop, kScreenWidth, kScreenHeight, kFps, kDebugMode, running, player, map, lastFrameTime, anyKeysPressed, eventLoop, update, draw, createTestWorld, start, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
SDL = require('SDL');
input = require('./input');
units = require('./units');
config = require('./config');
readout = require('./readout');
graphics = require('./graphics');
Map = require('./map');
Player = require('./player').Player;
FixedBackdrop = require('./backdrop').FixedBackdrop;
kScreenWidth = config.kScreenWidth, kScreenHeight = config.kScreenHeight, kFps = config.kFps, kDebugMode = config.kDebugMode;
running = true;
player = null;
map = null;
lastFrameTime = 0;
anyKeysPressed = false;
eventLoop = function(){
  var startTime, event, Δt, elapsedTime;
  startTime = SDL.getTicks();
  input.beginNewFrame();
  while (event = SDL.pollEvent()) {
    anyKeysPressed = true;
    readout.update('willstop', false);
    switch (event.type) {
    case SDL.KEYDOWN:
      input.keyDownEvent(event);
      break;
    case SDL.KEYUP:
      input.keyUpEvent(event);
      break;
    default:
      throw new Error({
        message: "Unknown event type: " + event
      });
    }
  }
  if (input.wasKeyPressed(SDL.KEY.ESCAPE)) {
    running = false;
  }
  if (input.isKeyHeld(SDL.KEY.LEFT) && input.isKeyHeld(SDL.KEY.RIGHT)) {
    player.stopMoving();
  } else if (input.isKeyHeld(SDL.KEY.LEFT)) {
    player.startMovingLeft();
  } else if (input.isKeyHeld(SDL.KEY.RIGHT)) {
    player.startMovingRight();
  } else {
    player.stopMoving();
  }
  if (input.wasKeyPressed(SDL.KEY.Z)) {
    player.startJump();
  } else if (input.wasKeyReleased(SDL.KEY.Z)) {
    player.stopJump();
  }
  if (input.isKeyHeld(SDL.KEY.UP) && input.isKeyHeld(SDL.KEY.DOWN)) {
    player.lookHorizontal();
  } else if (input.isKeyHeld(SDL.KEY.UP)) {
    player.lookUp();
  } else if (input.isKeyHeld(SDL.KEY.DOWN)) {
    player.lookDown();
  } else {
    player.lookHorizontal();
  }
  Δt = SDL.getTicks() - lastFrameTime;
  update(Δt);
  draw();
  if (running) {
    lastFrameTime = SDL.getTicks();
    elapsedTime = lastFrameTime - startTime;
    readout.update('frametime', std.floor(1000 / Δt));
    readout.update('drawtime', elapsedTime);
    return SDL.delay(1000 / kFps - elapsedTime, eventLoop);
  } else {
    return std.log('Game stopped.');
  }
};
update = function(elapsedTime){
  player.update(elapsedTime, map);
  return map.update(elapsedTime);
};
draw = function(){
  graphics.clear();
  map.drawBackground(graphics);
  player.draw(graphics);
  return map.draw(graphics);
};
createTestWorld = function(){
  player = new Player(units.tileToGame(kScreenWidth / 2), units.tileToGame(kScreenHeight / 2));
  return map = Map.createTestMap(graphics);
};
out$.start = start = function(){
  SDL.init(SDL.INIT_EVERYTHING);
  readout.addReader('frametime', 'Frame time');
  readout.addReader('drawtime', 'Draw time');
  readout.addReader('willstop', 'Will stop', true);
  createTestWorld();
  eventLoop();
  return std.delay(5000, function(){
    if (!anyKeysPressed) {
      return running = false;
    } else {
      return std.log("Game being interacted with. Don't shut down");
    }
  });
};
},{"./backdrop":"/Users/lakmeer/Projects/cave-story/src/backdrop.ls","./config":"/Users/lakmeer/Projects/cave-story/src/config.ls","./graphics":"/Users/lakmeer/Projects/cave-story/src/graphics.ls","./input":"/Users/lakmeer/Projects/cave-story/src/input.ls","./map":"/Users/lakmeer/Projects/cave-story/src/map.ls","./player":"/Users/lakmeer/Projects/cave-story/src/player.ls","./readout":"/Users/lakmeer/Projects/cave-story/src/readout.ls","./units":"/Users/lakmeer/Projects/cave-story/src/units.ls","SDL":"/Users/lakmeer/Projects/cave-story/src/sdl/index.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/graphics.ls":[function(require,module,exports){
var std, SDL, config, units, kScreenWidth, kScreenHeight, kTransparentColor, screen, spritesheets, loadImage, blitSurface, clear, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
SDL = require('SDL');
config = require('./config');
units = require('./units');
kScreenWidth = config.kScreenWidth, kScreenHeight = config.kScreenHeight;
kTransparentColor = [0, 0, 0];
screen = SDL.setVideoMode(units.tileToPx(kScreenWidth), units.tileToPx(kScreenHeight), 2);
spritesheets = {};
out$.loadImage = loadImage = function(path, useTransparency){
  useTransparency == null && (useTransparency = false);
  if (spritesheets[path] == null) {
    spritesheets[path] = SDL.loadImage(path);
    if (useTransparency) {
      SDL.setColorKey(spritesheets[path], kTransparentColor);
    }
    if (config.kDebugMode) {
      document.body.appendChild(spritesheets[path].canvas);
    }
  }
  return spritesheets[path];
};
out$.blitSurface = blitSurface = function(source, srcRect, destRect){
  return SDL.blitSurface(source, srcRect, screen, destRect);
};
out$.clear = clear = function(){
  return screen.clear();
};
},{"./config":"/Users/lakmeer/Projects/cave-story/src/config.ls","./units":"/Users/lakmeer/Projects/cave-story/src/units.ls","SDL":"/Users/lakmeer/Projects/cave-story/src/sdl/index.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/input.ls":[function(require,module,exports){
var std, Input;
std = require('std');
Input = (function(){
  Input.displayName = 'Input';
  var prototype = Input.prototype, constructor = Input;
  function Input(){
    this.heldKeys = {};
    this.pressedKeys = {};
    this.releasedKeys = {};
  }
  prototype.beginNewFrame = function(){
    this.pressedKeys = {};
    return this.releasedKeys = {};
  };
  prototype.keyDownEvent = function(event){
    this.pressedKeys[event.key] = true;
    return this.heldKeys[event.key] = true;
  };
  prototype.keyUpEvent = function(event){
    this.releasedKeys[event.key] = true;
    return this.heldKeys[event.key] = false;
  };
  prototype.wasKeyPressed = function(key){
    return this.pressedKeys[key];
  };
  prototype.wasKeyReleased = function(key){
    return this.releasedKeys[key];
  };
  prototype.isKeyHeld = function(key){
    return this.heldKeys[key];
  };
  return Input;
}());
module.exports = new Input;
},{"std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/map.ls":[function(require,module,exports){
var std, units, div, Sprite, Rect, FixedBackdrop, ref$, AIR_TILE, WALL_TILE, Tile, CollisionTile, Map;
std = require('std');
units = require('./units');
div = std.div;
Sprite = require('./sprite');
Rect = require('./rectangle').Rectangle;
FixedBackdrop = require('./backdrop').FixedBackdrop;
ref$ = std['enum'], AIR_TILE = ref$[0], WALL_TILE = ref$[1];
Tile = (function(){
  Tile.displayName = 'Tile';
  var prototype = Tile.prototype, constructor = Tile;
  function Tile(type, sprite){
    this.type = type != null ? type : AIR_TILE;
    this.sprite = sprite;
  }
  return Tile;
}());
CollisionTile = (function(){
  CollisionTile.displayName = 'CollisionTile';
  var prototype = CollisionTile.prototype, constructor = CollisionTile;
  function CollisionTile(row, col, type){
    this.row = row;
    this.col = col;
    this.type = type;
  }
  return CollisionTile;
}());
module.exports = Map = (function(){
  Map.displayName = 'Map';
  var prototype = Map.prototype, constructor = Map;
  function Map(){
    this.backdrop = null;
    this.tiles = Map.createMatrix(new Tile, 20, 15);
    this.bgTiles = Map.createMatrix(null, 20, 15);
  }
  prototype.update = function(elapsedTime){
    var i$, ref$, len$, row, lresult$, j$, len1$, tile, ref1$, results$ = [];
    for (i$ = 0, len$ = (ref$ = this.tiles).length; i$ < len$; ++i$) {
      row = ref$[i$];
      lresult$ = [];
      for (j$ = 0, len1$ = row.length; j$ < len1$; ++j$) {
        tile = row[j$];
        lresult$.push((ref1$ = tile.sprite) != null ? ref1$.update(elapsedTime) : void 8);
      }
      results$.push(lresult$);
    }
    return results$;
  };
  prototype.draw = function(graphics){
    var i$, ref$, len$, y, row, lresult$, j$, len1$, x, tile, ref1$, results$ = [];
    for (i$ = 0, len$ = (ref$ = this.tiles).length; i$ < len$; ++i$) {
      y = i$;
      row = ref$[i$];
      lresult$ = [];
      for (j$ = 0, len1$ = row.length; j$ < len1$; ++j$) {
        x = j$;
        tile = row[j$];
        lresult$.push((ref1$ = tile.sprite) != null ? ref1$.draw(graphics, units.tileToGame(x), units.tileToGame(y)) : void 8);
      }
      results$.push(lresult$);
    }
    return results$;
  };
  prototype.drawBackground = function(graphics){
    var i$, ref$, len$, y, row, lresult$, j$, len1$, x, sprite, results$ = [];
    this.backdrop.draw(graphics);
    for (i$ = 0, len$ = (ref$ = this.bgTiles).length; i$ < len$; ++i$) {
      y = i$;
      row = ref$[i$];
      lresult$ = [];
      for (j$ = 0, len1$ = row.length; j$ < len1$; ++j$) {
        x = j$;
        sprite = row[j$];
        lresult$.push(sprite != null ? sprite.draw(graphics, units.tileToGame(x), units.tileToGame(y)) : void 8);
      }
      results$.push(lresult$);
    }
    return results$;
  };
  prototype.getCollidingTiles = function(rect){
    var firstRow, lastRow, firstCol, lastCol, collisionTiles, i$, row, j$, col;
    firstRow = div(units.gameToPx(rect.top), units.tileToPx(1));
    lastRow = div(units.gameToPx(rect.bottom), units.tileToPx(1));
    firstCol = div(units.gameToPx(rect.left), units.tileToPx(1));
    lastCol = div(units.gameToPx(rect.right), units.tileToPx(1));
    collisionTiles = [];
    for (i$ = firstRow; i$ <= lastRow; ++i$) {
      row = i$;
      for (j$ = firstCol; j$ <= lastCol; ++j$) {
        col = j$;
        collisionTiles.push(new CollisionTile(row, col, this.tiles[row][col].type));
      }
    }
    return collisionTiles;
  };
  Map.createTestMap = function(graphics){
    var map, numRows, numCols, row, tile, i$, col, chainTop, chainMid, chainBtm;
    map = new Map;
    map.backdrop = new FixedBackdrop('data/16x16/bkBlue.bmp', graphics);
    numRows = 15;
    numCols = 20;
    row = 11;
    tile = new Tile(WALL_TILE, new Sprite(graphics, 'data/16x16/Stage/PrtCave.bmp', units.tileToPx(1), 0, units.tileToPx(1), units.tileToPx(1)));
    for (i$ = 0; i$ <= numCols; ++i$) {
      col = i$;
      map.tiles[row][col] = tile;
    }
    map.tiles[10][5] = tile;
    map.tiles[9][4] = tile;
    map.tiles[8][3] = tile;
    map.tiles[7][2] = tile;
    map.tiles[10][3] = tile;
    chainTop = new Sprite(graphics, 'data/16x16/Stage/PrtCave.bmp', units.tileToPx(11), units.tileToPx(2), units.tileToPx(1), units.tileToPx(1));
    chainMid = new Sprite(graphics, 'data/16x16/Stage/PrtCave.bmp', units.tileToPx(12), units.tileToPx(2), units.tileToPx(1), units.tileToPx(1));
    chainBtm = new Sprite(graphics, 'data/16x16/Stage/PrtCave.bmp', units.tileToPx(13), units.tileToPx(2), units.tileToPx(1), units.tileToPx(1));
    map.bgTiles[8][2] = chainTop;
    map.bgTiles[9][2] = chainMid;
    map.bgTiles[10][2] = chainBtm;
    return map;
  };
  Map.createMatrix = function(value, cols, rows){
    var i$, y, lresult$, j$, z, results$ = [];
    for (i$ = 0; i$ <= rows; ++i$) {
      y = i$;
      lresult$ = [];
      for (j$ = 0; j$ <= cols; ++j$) {
        z = j$;
        lresult$.push(value);
      }
      results$.push(lresult$);
    }
    return results$;
  };
  Map.WALL_TILE = WALL_TILE;
  Map.AIR_TILE = AIR_TILE;
  return Map;
}());
},{"./backdrop":"/Users/lakmeer/Projects/cave-story/src/backdrop.ls","./rectangle":"/Users/lakmeer/Projects/cave-story/src/rectangle.ls","./sprite":"/Users/lakmeer/Projects/cave-story/src/sprite.ls","./units":"/Users/lakmeer/Projects/cave-story/src/units.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/player.ls":[function(require,module,exports){
var std, units, config, readout, graphics, Sprite, AnimatedSprite, WALL_TILE, Rect, kCharacterFrame, kWalkFrame, kStandFrame, kJumpFrame, kFallFrame, kUpFrameOffset, kDownFrame, kBackFrame, kWalkFps, kFriction, kGravity, kWalkingAcceleration, kAirAcceleration, kMaxSpeedX, kMaxSpeedY, kJumpSpeed, kJumpGravity, kCollisionX, kCollisionY, ref$, STANDING, WALKING, JUMPING, FALLING, INTERACTING, LEFT, RIGHT, UP, DOWN, HORIZONTAL, SpriteState, Player, out$ = typeof exports != 'undefined' && exports || this, slice$ = [].slice;
std = require('std');
units = require('./units');
config = require('./config');
readout = require('./readout');
graphics = require('./graphics');
Sprite = require('./sprite');
AnimatedSprite = require('./animated-sprite');
WALL_TILE = require('./map').WALL_TILE;
Rect = require('./rectangle').Rectangle;
kCharacterFrame = 0;
kWalkFrame = 0;
kStandFrame = 0;
kJumpFrame = 1;
kFallFrame = 2;
kUpFrameOffset = 3;
kDownFrame = 6;
kBackFrame = 7;
kWalkFps = 15;
kFriction = 0.00049804687;
kGravity = 0.00078125;
kWalkingAcceleration = 0.00083007812;
kAirAcceleration = 0.0003125;
kMaxSpeedX = 0.15859375;
kMaxSpeedY = 0.2998046875;
kJumpSpeed = 0.25;
kJumpGravity = 0.0003125;
kCollisionX = new Rect(6, 10, 20, 12);
kCollisionY = new Rect(10, 2, 12, 30);
ref$ = ['S', 'W', 'J', 'F', 'I'], STANDING = ref$[0], WALKING = ref$[1], JUMPING = ref$[2], FALLING = ref$[3], INTERACTING = ref$[4];
ref$ = ['L', 'R'], LEFT = ref$[0], RIGHT = ref$[1];
ref$ = ['U', 'D', 'H'], UP = ref$[0], DOWN = ref$[1], HORIZONTAL = ref$[2];
out$.SpriteState = SpriteState = (function(){
  SpriteState.displayName = 'SpriteState';
  var prototype = SpriteState.prototype, constructor = SpriteState;
  function SpriteState(motionType, horizontalFacing, verticalFacing){
    this.motionType = motionType != null ? motionType : STANDING;
    this.horizontalFacing = horizontalFacing != null ? horizontalFacing : LEFT;
    this.verticalFacing = verticalFacing != null ? verticalFacing : HORIZONTAL;
  }
  prototype.key = function(){
    return this.motionType + "-" + this.horizontalFacing + "-" + this.verticalFacing;
  };
  SpriteState.key = function(){
    var args;
    args = slice$.call(arguments);
    return args.join('-');
  };
  return SpriteState;
}());
out$.Player = Player = (function(){
  Player.displayName = 'Player';
  var prototype = Player.prototype, constructor = Player;
  function Player(x, y){
    this.x = x;
    this.y = y;
    this.velocityY = 0;
    this.velocityX = 0;
    this.accelerationX = 0;
    this.horizontalFacing = LEFT;
    this.verticalFacing = HORIZONTAL;
    this.onGround = false;
    this.jumpActive = false;
    this.interacting = false;
    this.sprites = this.initialiseSprites();
    if (config.kDebugMode) {
      readout.addReader('spritestate', 'SpriteState');
    }
  }
  prototype.initialiseSprite = function(motion, hfacing, vfacing){
    var tileX, tileY, sourceX;
    tileX = (function(){
      switch (motion) {
      case WALKING:
        return kWalkFrame;
      case STANDING:
        return kStandFrame;
      case JUMPING:
        return kJumpFrame;
      case FALLING:
        return kFallFrame;
      case INTERACTING:
        return kBackFrame;
      }
    }());
    tileX += vfacing === UP ? kUpFrameOffset : 0;
    tileY = kCharacterFrame + (hfacing === LEFT ? 0 : 1);
    if (motion === WALKING) {
      return new AnimatedSprite(graphics, 'data/16x16/MyChar.bmp', units.tileToPx(tileX), units.tileToPx(tileY), units.tileToPx(1), units.tileToPx(1), kWalkFps, 3);
    } else {
      if (vfacing === DOWN && (motion === JUMPING || motion === FALLING)) {
        sourceX = kDownFrame;
      }
      return new Sprite(graphics, 'data/16x16/MyChar.bmp', units.tileToPx(tileX), units.tileToPx(tileY), units.tileToPx(1), units.tileToPx(1));
    }
  };
  prototype.initialiseSprites = function(spriteMap){
    var i$, ref$, len$, motion, j$, ref1$, len1$, hfacing, k$, ref2$, len2$, vfacing;
    spriteMap == null && (spriteMap = {});
    for (i$ = 0, len$ = (ref$ = [STANDING, WALKING, JUMPING, FALLING, INTERACTING]).length; i$ < len$; ++i$) {
      motion = ref$[i$];
      for (j$ = 0, len1$ = (ref1$ = [LEFT, RIGHT]).length; j$ < len1$; ++j$) {
        hfacing = ref1$[j$];
        for (k$ = 0, len2$ = (ref2$ = [UP, DOWN, HORIZONTAL]).length; k$ < len2$; ++k$) {
          vfacing = ref2$[k$];
          spriteMap[SpriteState.key(motion, hfacing, vfacing)] = this.initialiseSprite(motion, hfacing, vfacing);
        }
      }
    }
    return spriteMap;
  };
  prototype.update = function(elapsedTime, map){
    this.sprites[this.getSpriteState()].update(elapsedTime);
    this.updateX(elapsedTime, map);
    return this.updateY(elapsedTime, map);
  };
  prototype.updateX = function(elapsedTime, map){
    var accX, Δx;
    accX = this.onGround ? kWalkingAcceleration : kAirAcceleration;
    this.velocityX += this.accelerationX * accX * elapsedTime;
    if (this.accelerationX < 0) {
      this.velocityX = std.max(this.velocityX, -kMaxSpeedX);
    } else if (this.accelerationX > 0) {
      this.velocityX = std.min(this.velocityX, kMaxSpeedX);
    } else if (this.onGround) {
      this.velocityX = this.velocityX > 0
        ? std.max(0, this.velocityX - kFriction * elapsedTime)
        : std.min(0, this.velocityX + kFriction * elapsedTime);
    }
    Δx = this.velocityX * elapsedTime;
    if (Δx > 0) {
      this.onWallCollision(map, this.rightCollision(Δx), function(tile){
        if (tile) {
          this.x = units.tileToGame(tile.col) - kCollisionX.right;
          return this.velocityX = 0;
        } else {
          return this.x += Δx;
        }
      });
      return this.onWallCollision(map, this.leftCollision(0), function(tile){
        if (tile) {
          return this.x = units.tileToGame(tile.col) + kCollisionX.right;
        }
      });
    } else {
      this.onWallCollision(map, this.leftCollision(Δx), function(tile){
        if (tile) {
          this.x = units.tileToGame(tile.col) + kCollisionX.right;
          return this.velocityX = 0;
        } else {
          return this.x += Δx;
        }
      });
      return this.onWallCollision(map, this.rightCollision(0), function(tile){
        if (tile) {
          return this.x = units.tileToGame(tile.col) - kCollisionX.right;
        }
      });
    }
  };
  prototype.updateY = function(elapsedTime, map){
    var gravity, Δy;
    gravity = this.jumpActive && this.velocityY < 0 ? kJumpGravity : kGravity;
    this.velocityY = std.min(this.velocityY + gravity * elapsedTime, kMaxSpeedY);
    Δy = this.velocityY * elapsedTime;
    if (Δy > 0) {
      this.onWallCollision(map, this.bottomCollision(Δy), function(tile){
        if (tile) {
          this.y = units.tileToGame(tile.row) - kCollisionY.bottom;
          this.velocityY = 0;
          return this.onGround = true;
        } else {
          this.y += Δy;
          return this.onGround = false;
        }
      });
      return this.onWallCollision(map, this.topCollision(0), function(tile){
        if (tile) {
          return this.y = units.tileToGame(tile.row) + kCollisionY.h;
        }
      });
    } else {
      this.onWallCollision(map, this.topCollision(Δy), function(tile){
        if (tile) {
          this.y = units.tileToGame(tile.row) + kCollisionY.h;
          return this.velocityY = 0;
        } else {
          this.y += Δy;
          return this.onGround = false;
        }
      });
      return this.onWallCollision(map, this.bottomCollision(0), function(tile){
        if (tile) {
          this.y = units.tileToGame(tile.row) - kCollisionY.bottom;
          return this.onGround = true;
        }
      });
    }
  };
  prototype.draw = function(graphics){
    return this.sprites[this.getSpriteState()].draw(graphics, this.x, this.y);
  };
  prototype.getSpriteState = function(){
    var motionType, key;
    motionType = this.interacting
      ? INTERACTING
      : this.onGround
        ? this.accelerationX === 0 ? STANDING : WALKING
        : this.velocityY < 0 ? JUMPING : FALLING;
    key = SpriteState.key(motionType, this.horizontalFacing, this.verticalFacing);
    readout.update('spritestate', key);
    return key;
  };
  prototype.leftCollision = function(Δ){
    return new Rect(this.x + kCollisionX.left + Δ, this.y + kCollisionX.top, kCollisionX.w / 2 - Δ, kCollisionX.h);
  };
  prototype.rightCollision = function(Δ){
    return new Rect(this.x + kCollisionX.left + kCollisionX.w / 2, this.y + kCollisionX.top, kCollisionX.w / 2 + Δ, kCollisionX.h);
  };
  prototype.topCollision = function(Δ){
    return new Rect(this.x + kCollisionY.left, this.y + kCollisionY.top + Δ, kCollisionY.w, kCollisionY.h / 2 - Δ);
  };
  prototype.bottomCollision = function(Δ){
    return new Rect(this.x + kCollisionY.left, this.y + kCollisionY.top + kCollisionY.h / 2 + Δ, kCollisionY.w, kCollisionY.h / 2 + Δ);
  };
  prototype.onWallCollision = function(map, rect, λ){
    var i$, ref$, len$, tile;
    for (i$ = 0, len$ = (ref$ = map.getCollidingTiles(rect)).length; i$ < len$; ++i$) {
      tile = ref$[i$];
      if (tile.type === WALL_TILE) {
        return λ.call(this, tile);
      }
    }
    return λ.call(this);
  };
  prototype.startMovingLeft = function(){
    this.horizontalFacing = LEFT;
    this.accelerationX = -1;
    return this.interacting = false;
  };
  prototype.startMovingRight = function(){
    this.horizontalFacing = RIGHT;
    this.accelerationX = 1;
    return this.interacting = false;
  };
  prototype.stopMoving = function(){
    return this.accelerationX = 0;
  };
  prototype.startJump = function(){
    this.jumpActive = true;
    this.interacting = false;
    if (this.onGround) {
      return this.velocityY = -kJumpSpeed;
    }
  };
  prototype.stopJump = function(){
    return this.jumpActive = false;
  };
  prototype.lookUp = function(){
    this.verticalFacing = UP;
    return this.interacting = false;
  };
  prototype.lookDown = function(){
    if (this.verticalFacing === DOWN) {
      return;
    }
    this.verticalFacing = DOWN;
    return this.interacting = this.onGround;
  };
  prototype.lookHorizontal = function(){
    return this.verticalFacing = HORIZONTAL;
  };
  return Player;
}());
},{"./animated-sprite":"/Users/lakmeer/Projects/cave-story/src/animated-sprite.ls","./config":"/Users/lakmeer/Projects/cave-story/src/config.ls","./graphics":"/Users/lakmeer/Projects/cave-story/src/graphics.ls","./map":"/Users/lakmeer/Projects/cave-story/src/map.ls","./readout":"/Users/lakmeer/Projects/cave-story/src/readout.ls","./rectangle":"/Users/lakmeer/Projects/cave-story/src/rectangle.ls","./sprite":"/Users/lakmeer/Projects/cave-story/src/sprite.ls","./units":"/Users/lakmeer/Projects/cave-story/src/units.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/readout.ls":[function(require,module,exports){
var elm, applyStyles, Reader, host, readers, install, addReader, update, removeReader, out$ = typeof exports != 'undefined' && exports || this;
elm = bind$(document, 'createElement');
applyStyles = function(el, styles){
  var k, v, results$ = [];
  for (k in styles) {
    v = styles[k];
    results$.push(el.style[k] = v);
  }
  return results$;
};
Reader = (function(){
  Reader.displayName = 'Reader';
  var prototype = Reader.prototype, constructor = Reader;
  function Reader(name, labelText, value){
    var that;
    this.name = name;
    this.labelText = labelText;
    this.value = value;
    this.dom = elm('tr');
    this.label = elm('td');
    this.output = elm('td');
    this.dom.appendChild(this.label);
    this.dom.appendChild(this.output);
    this.label.innerHTML = this.labelText;
    if (that = this.value) {
      this.output.innerHTML = that;
    }
  }
  prototype.update = function(value){
    this.value = value;
    return this.output.innerHTML = this.value;
  };
  prototype.hide = function(){
    return this.dom.styles.display = 'none';
  };
  prototype.show = function(){
    return this.dom.styles.display = 'block';
  };
  prototype.install = function(host){
    return host.appendChild(this.dom);
  };
  prototype['delete'] = function(){
    return this.dom.parentNode.removeChild(this.dom);
  };
  return Reader;
}());
host = elm('table');
readers = {};
applyStyles(host, {
  fontFamily: 'monospace',
  width: '100%',
  paddingLeft: '10px',
  color: 'lightgrey',
  borderWidth: "3px 1px"
});
out$.install = install = function(){
  return document.body.appendChild(host);
};
out$.addReader = addReader = function(name, label, value){
  readers[name] = new Reader(name, label, value);
  return readers[name].install(host);
};
out$.update = update = function(readerName, value){
  var ref$;
  return (ref$ = readers[readerName]) != null ? ref$.update(value) : void 8;
};
out$.removeReader = removeReader = function(name){
  var ref$;
  readers[name]['delete']();
  return ref$ = readers[name], delete readers[name], ref$;
};
function bind$(obj, key, target){
  return function(){ return (target || obj)[key].apply(obj, arguments) };
}
},{}],"/Users/lakmeer/Projects/cave-story/src/rectangle.ls":[function(require,module,exports){
var Rectangle, out$ = typeof exports != 'undefined' && exports || this;
out$.Rectangle = Rectangle = (function(){
  Rectangle.displayName = 'Rectangle';
  var prototype = Rectangle.prototype, constructor = Rectangle;
  function Rectangle(x, y, w, h, m){
    m == null && (m = 1);
    this.x = x * m;
    this.y = y * m;
    this.w = w * m;
    this.h = h * m;
    this.top = this.y;
    this.left = this.x;
    this.right = this.x + this.w;
    this.bottom = this.y + this.h;
  }
  return Rectangle;
}());
},{}],"/Users/lakmeer/Projects/cave-story/src/sdl/delay.ls":[function(require,module,exports){
var raf, out$ = typeof exports != 'undefined' && exports || this;
raf = requestAnimationFrame;
import$(out$, {
  delay: function(time, λ){
    return raf(λ);
  }
});
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{}],"/Users/lakmeer/Projects/cave-story/src/sdl/event-queue.ls":[function(require,module,exports){
var std, queue, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
queue = [];
import$(out$, {
  pushEvent: function(event){
    return queue.push(event);
  },
  pollEvent: function(){
    if (queue.length) {
      return queue.shift();
    }
  }
});
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/sdl/index.ls":[function(require,module,exports){
var std, delay, timer, screen, keyboard, eventQueue, Rect, Surface, ref$, INIT_EVERYTHING, FULLSCREEN, init, KEY, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
delay = require('./delay');
timer = require('./timer');
screen = require('./screen');
keyboard = require('./keyboard');
eventQueue = require('./event-queue');
out$.Rect = Rect = require('./rect');
out$.Surface = Surface = require('./surface');
ref$ = std['enum'], INIT_EVERYTHING = ref$[0], FULLSCREEN = ref$[1];
out$.init = init = function(mode){
  std.log("SDL::Init - with mode:", mode);
  timer.init();
  return keyboard.init();
};
out$.INIT_EVERYTHING = INIT_EVERYTHING;
out$.FULLSCREEN = FULLSCREEN;
out$.KEYDOWN = keyboard.KEYDOWN;
out$.KEYUP = keyboard.KEYUP;
out$.KEY = KEY = keyboard.KEYCODES;
out$.delay = delay.delay;
out$.getTicks = timer.getTicks;
out$.pollEvent = eventQueue.pollEvent;
out$.setVideoMode = screen.setVideoMode;
out$.blitSurface = Surface.blitSurface;
out$.setColorKey = Surface.setColorKey;
out$.loadImage = Surface.loadImage;
},{"./delay":"/Users/lakmeer/Projects/cave-story/src/sdl/delay.ls","./event-queue":"/Users/lakmeer/Projects/cave-story/src/sdl/event-queue.ls","./keyboard":"/Users/lakmeer/Projects/cave-story/src/sdl/keyboard.ls","./rect":"/Users/lakmeer/Projects/cave-story/src/sdl/rect.ls","./screen":"/Users/lakmeer/Projects/cave-story/src/sdl/screen.ls","./surface":"/Users/lakmeer/Projects/cave-story/src/sdl/surface.ls","./timer":"/Users/lakmeer/Projects/cave-story/src/sdl/timer.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/sdl/keyboard.ls":[function(require,module,exports){
var std, queue, ref$, KEYDOWN, KEYUP, KEYCODES, monitorKeys, init, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
queue = require('./event-queue');
ref$ = std['enum'], KEYDOWN = ref$[0], KEYUP = ref$[1];
out$.KEYCODES = KEYCODES = {
  ESCAPE: 27,
  LEFT: 37,
  UP: 38,
  RIGHT: 39,
  DOWN: 40,
  A: 65,
  Q: 81,
  S: 83,
  W: 87,
  X: 88,
  Z: 90
};
monitorKeys = function(){
  document.addEventListener('keydown', function(arg$){
    var which;
    which = arg$.which;
    queue.pushEvent({
      type: KEYDOWN,
      key: which
    });
    return event.preventDefault();
  });
  return document.addEventListener('keyup', function(arg$){
    var which;
    which = arg$.which;
    queue.pushEvent({
      type: KEYUP,
      key: which
    });
    return event.preventDefault();
  });
};
out$.init = init = function(){
  std.log("SDL::Keyboard - Monitoring key input");
  return monitorKeys();
};
out$.KEYDOWN = KEYDOWN;
out$.KEYUP = KEYUP;
},{"./event-queue":"/Users/lakmeer/Projects/cave-story/src/sdl/event-queue.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/sdl/rect.ls":[function(require,module,exports){
var Rect;
module.exports = Rect = (function(){
  Rect.displayName = 'Rect';
  var prototype = Rect.prototype, constructor = Rect;
  function Rect(x, y, w, h){
    this.x = x;
    this.y = y;
    this.w = w;
    this.h = h;
  }
  return Rect;
}());
},{}],"/Users/lakmeer/Projects/cave-story/src/sdl/screen.ls":[function(require,module,exports){
var std, Surface, applyScaleStyles, createNewScreen, setVideoMode, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
Surface = require('./surface');
applyScaleStyles = function(canvas, scaleFactor){
  if (scaleFactor !== 0) {
    return canvas.style.width = canvas.width * scaleFactor + 'px';
  }
};
createNewScreen = function(w, h, scaleFactor){
  var screen;
  screen = new Surface(null, w, h);
  document.body.appendChild(screen.canvas);
  applyScaleStyles(screen.canvas, scaleFactor);
  return screen;
};
out$.setVideoMode = setVideoMode = function(width, height, scaleFactor){
  scaleFactor == null && (scaleFactor = 1);
  return createNewScreen(width, height, scaleFactor);
};
},{"./surface":"/Users/lakmeer/Projects/cave-story/src/sdl/surface.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/sdl/surface.ls":[function(require,module,exports){
var std, Rect, makeTransparent, Surface;
std = require('std');
Rect = require('./rect');
makeTransparent = function(data, color){
  var canvas, context, pixels, i$, to$, i;
  canvas = document.createElement('canvas');
  canvas.width = data.width;
  canvas.height = data.height;
  context = canvas.getContext('2d');
  context.drawImage(data, 0, 0);
  pixels = context.getImageData(0, 0, canvas.width, canvas.height);
  for (i$ = 0, to$ = pixels.data.length; i$ <= to$; i$ += 4) {
    i = i$;
    if (pixels.data[i + 0] === color[0] && pixels.data[i + 1] === color[1] && pixels.data[i + 2] === color[2]) {
      pixels.data[i + 3] = 0;
    }
  }
  context.putImageData(pixels, 0, 0);
  return canvas;
};
module.exports = Surface = (function(){
  Surface.displayName = 'Surface';
  var prototype = Surface.prototype, constructor = Surface;
  function Surface(src, width, height){
    this.width = width;
    this.height = height;
    this.canvas = document.createElement('canvas');
    this.ctx = this.canvas.getContext('2d');
    this.ready = false;
    this.colorKey = null;
    this.resetCanvasSize();
    this.ctx.fillStyle = 'red';
    this.ctx.fillRect(0, 0, this.width, this.height);
    if (typeof src === 'string') {
      this.loadImageData(src);
    } else if (src != null) {
      this.saveImageData(src);
    } else {}
  }
  prototype.resetCanvasSize = function(){
    this.canvas.width = this.width;
    return this.canvas.height = this.height;
  };
  prototype.inheritSizeFromImage = function(data){
    if (this.width == null && this.height == null) {
      this.width = data.naturalWidth;
      this.height = data.naturalHeight;
      return this.resetCanvasSize();
    }
  };
  prototype.loadImageData = function(path){
    var data, this$ = this;
    data = new Image;
    data.onload = function(){
      this$.inheritSizeFromImage(data);
      return this$.saveImageData(data);
    };
    data.onerror = function(){
      std.log("Cant load:", path);
      return this$.ctx.fillRect(0, 0, this$.width, this$.height);
    };
    return data.src = path;
  };
  prototype.saveImageData = function(data){
    this.data = this.colorKey ? makeTransparent(data, this.colorKey) : data;
    this.ready = true;
    this.ctx.clearRect(0, 0, this.width, this.height);
    return this.ctx.drawImage(this.data, 0, 0, this.width, this.height);
  };
  prototype.setColorKey = function(color){
    this.colorKey = color;
    if (this.ready) {
      return this.saveImageData(this.data);
    }
  };
  prototype.clear = function(){
    return this.ctx.clearRect(0, 0, this.width, this.height);
  };
  Surface.setColorKey = function(surface, color){
    return surface.setColorKey(color);
  };
  Surface.blitSurface = function(source, srcRect, dest, destRect){
    if (srcRect) {
      return dest.ctx.drawImage(source.canvas, srcRect.x, srcRect.y, srcRect.w, srcRect.h, destRect.x, destRect.y, destRect.w, destRect.h);
    } else {
      return dest.ctx.drawImage(source.canvas, destRect.x, destRect.y, destRect.w, destRect.h);
    }
  };
  Surface.loadImage = function(path){
    return new Surface(path);
  };
  return Surface;
}());
},{"./rect":"/Users/lakmeer/Projects/cave-story/src/sdl/rect.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/sdl/timer.ls":[function(require,module,exports){
var startTime, out$ = typeof exports != 'undefined' && exports || this;
startTime = 0;
import$(out$, {
  init: function(){
    return startTime = Date.now();
  },
  getTicks: function(){
    return Date.now() - startTime;
  }
});
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{}],"/Users/lakmeer/Projects/cave-story/src/sprite.ls":[function(require,module,exports){
var SDL, std, units, Sprite;
SDL = require('SDL');
std = require('std');
units = require('./units');
module.exports = Sprite = (function(){
  Sprite.displayName = 'Sprite';
  var prototype = Sprite.prototype, constructor = Sprite;
  function Sprite(graphics, path, sourceX, sourceY, width, height){
    this.width = width;
    this.height = height;
    this.sourceRect = new SDL.Rect(sourceX, sourceY, width, height);
    this.spriteSheet = graphics.loadImage(path, true);
  }
  prototype.update = function(){};
  prototype.draw = function(graphics, x, y){
    var destRect;
    destRect = new SDL.Rect(units.gameToPx(x), units.gameToPx(y), this.width, this.height);
    return graphics.blitSurface(this.spriteSheet, this.sourceRect, destRect);
  };
  return Sprite;
}());
},{"./units":"/Users/lakmeer/Projects/cave-story/src/units.ls","SDL":"/Users/lakmeer/Projects/cave-story/src/sdl/index.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}],"/Users/lakmeer/Projects/cave-story/src/std/index.ls":[function(require,module,exports){
var ref$, id, map, filter, any, div, log, info, objMap, flip, delay, round, floor, abs, max, min, out$ = typeof exports != 'undefined' && exports || this;
ref$ = require('prelude-ls'), id = ref$.id, map = ref$.map, filter = ref$.filter, any = ref$.any, div = ref$.div;
out$.log = log = function(){
  console.log.apply(console, arguments);
  return arguments[0];
};
out$.info = info = function(){
  console.info.apply(console, arguments);
  return arguments[0];
};
out$.objMap = objMap = curry$(function(λ, o){
  var k, v, results$ = [];
  for (k in o) {
    v = o[k];
    results$.push(λ(k, v));
  }
  return results$;
});
out$.flip = flip = function(λ){
  return curry$(function(a, b){
    return λ(b, a);
  });
};
out$.delay = delay = flip(setTimeout);
out$.round = round = Math.round;
out$.floor = floor = Math.floor;
out$.abs = abs = Math.abs;
out$.max = max = Math.max;
out$.min = min = Math.min;
ref$ = out$;
ref$.id = id;
ref$.any = any;
ref$.map = map;
ref$.filter = filter;
ref$.div = div;
ref$['enum'] = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{"prelude-ls":"/Users/lakmeer/Projects/cave-story/node_modules/prelude-ls/lib/index.js"}],"/Users/lakmeer/Projects/cave-story/src/units.ls":[function(require,module,exports){
var std, config, kTileSize, Game, Pixel, Tile, FPS, MS, Velocity, Acceleration, gameToPx, gameToTile, tileToGame, tileToPx, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
config = require('./config');
kTileSize = 32;
out$.Game = Game = std.id;
out$.Pixel = Pixel = std.floor;
out$.Tile = Tile = function(){
  return std.abs(std.floor.apply(this, arguments));
};
out$.FPS = FPS = std.id;
out$.MS = MS = std.id;
out$.Velocity = Velocity = std.id;
out$.Acceleration = Acceleration = std.id;
out$.gameToPx = gameToPx = function(){
  return Pixel((function(it){
    return it / 2;
  }).apply(this, arguments));
};
out$.gameToTile = gameToTile = function(){
  return Tile((function(it){
    return it / kTileSize;
  }).apply(this, arguments));
};
out$.tileToGame = tileToGame = (function(it){
  return it * kTileSize;
});
out$.tileToPx = tileToPx = function(){
  return gameToPx(tileToGame.apply(this, arguments));
};
},{"./config":"/Users/lakmeer/Projects/cave-story/src/config.ls","std":"/Users/lakmeer/Projects/cave-story/src/std/index.ls"}]},{},["./src/index.ls"])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9sYWttZWVyL1Byb2plY3RzL2NhdmUtc3Rvcnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi4vc3JjL2luZGV4LmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9ub2RlX21vZHVsZXMvcHJlbHVkZS1scy9saWIvRnVuYy5qcyIsIi9Vc2Vycy9sYWttZWVyL1Byb2plY3RzL2NhdmUtc3Rvcnkvbm9kZV9tb2R1bGVzL3ByZWx1ZGUtbHMvbGliL0xpc3QuanMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9OdW0uanMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9PYmouanMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9TdHIuanMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9pbmRleC5qcyIsIi9Vc2Vycy9sYWttZWVyL1Byb2plY3RzL2NhdmUtc3Rvcnkvc3JjL2FuaW1hdGVkLXNwcml0ZS5scyIsIi9Vc2Vycy9sYWttZWVyL1Byb2plY3RzL2NhdmUtc3Rvcnkvc3JjL2JhY2tkcm9wLmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvY29uZmlnLmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvZ2FtZS5scyIsIi9Vc2Vycy9sYWttZWVyL1Byb2plY3RzL2NhdmUtc3Rvcnkvc3JjL2dyYXBoaWNzLmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvaW5wdXQubHMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L3NyYy9tYXAubHMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L3NyYy9wbGF5ZXIubHMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L3NyYy9yZWFkb3V0LmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvcmVjdGFuZ2xlLmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvc2RsL2RlbGF5LmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvc2RsL2V2ZW50LXF1ZXVlLmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvc2RsL2luZGV4LmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvc2RsL2tleWJvYXJkLmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvc2RsL3JlY3QubHMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L3NyYy9zZGwvc2NyZWVuLmxzIiwiL1VzZXJzL2xha21lZXIvUHJvamVjdHMvY2F2ZS1zdG9yeS9zcmMvc2RsL3N1cmZhY2UubHMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L3NyYy9zZGwvdGltZXIubHMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L3NyYy9zcHJpdGUubHMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L3NyYy9zdGQvaW5kZXgubHMiLCIvVXNlcnMvbGFrbWVlci9Qcm9qZWN0cy9jYXZlLXN0b3J5L3NyYy91bml0cy5scyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciByZWFkb3V0LCBHYW1lO1xucmVhZG91dCA9IHJlcXVpcmUoJy4vcmVhZG91dCcpO1xuR2FtZSA9IHJlcXVpcmUoJy4vZ2FtZScpO1xucmVhZG91dC5pbnN0YWxsKCk7XG5HYW1lLnN0YXJ0KCk7IiwiLy8gR2VuZXJhdGVkIGJ5IExpdmVTY3JpcHQgMS4yLjBcbnZhciBhcHBseSwgY3VycnksIGZsaXAsIGZpeCwgb3ZlcjtcbmFwcGx5ID0gY3VycnkkKGZ1bmN0aW9uKGYsIGxpc3Qpe1xuICByZXR1cm4gZi5hcHBseShudWxsLCBsaXN0KTtcbn0pO1xuY3VycnkgPSBmdW5jdGlvbihmKXtcbiAgcmV0dXJuIGN1cnJ5JChmKTtcbn07XG5mbGlwID0gY3VycnkkKGZ1bmN0aW9uKGYsIHgsIHkpe1xuICByZXR1cm4gZih5LCB4KTtcbn0pO1xuZml4ID0gZnVuY3Rpb24oZil7XG4gIHJldHVybiBmdW5jdGlvbihnKXtcbiAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiBmKGcoZykpLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfShmdW5jdGlvbihnKXtcbiAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiBmKGcoZykpLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSk7XG59O1xub3ZlciA9IGN1cnJ5JChmdW5jdGlvbihmLCBnLCB4LCB5KXtcbiAgcmV0dXJuIGYoZyh4KSwgZyh5KSk7XG59KTtcbm1vZHVsZS5leHBvcnRzID0ge1xuICBjdXJyeTogY3VycnksXG4gIGZsaXA6IGZsaXAsXG4gIGZpeDogZml4LFxuICBhcHBseTogYXBwbHksXG4gIG92ZXI6IG92ZXJcbn07XG5mdW5jdGlvbiBjdXJyeSQoZiwgYm91bmQpe1xuICB2YXIgY29udGV4dCxcbiAgX2N1cnJ5ID0gZnVuY3Rpb24oYXJncykge1xuICAgIHJldHVybiBmLmxlbmd0aCA+IDEgPyBmdW5jdGlvbigpe1xuICAgICAgdmFyIHBhcmFtcyA9IGFyZ3MgPyBhcmdzLmNvbmNhdCgpIDogW107XG4gICAgICBjb250ZXh0ID0gYm91bmQgPyBjb250ZXh0IHx8IHRoaXMgOiB0aGlzO1xuICAgICAgcmV0dXJuIHBhcmFtcy5wdXNoLmFwcGx5KHBhcmFtcywgYXJndW1lbnRzKSA8XG4gICAgICAgICAgZi5sZW5ndGggJiYgYXJndW1lbnRzLmxlbmd0aCA/XG4gICAgICAgIF9jdXJyeS5jYWxsKGNvbnRleHQsIHBhcmFtcykgOiBmLmFwcGx5KGNvbnRleHQsIHBhcmFtcyk7XG4gICAgfSA6IGY7XG4gIH07XG4gIHJldHVybiBfY3VycnkoKTtcbn0iLCIvLyBHZW5lcmF0ZWQgYnkgTGl2ZVNjcmlwdCAxLjIuMFxudmFyIGVhY2gsIG1hcCwgY29tcGFjdCwgZmlsdGVyLCByZWplY3QsIHBhcnRpdGlvbiwgZmluZCwgaGVhZCwgZmlyc3QsIHRhaWwsIGxhc3QsIGluaXRpYWwsIGVtcHR5LCByZXZlcnNlLCB1bmlxdWUsIHVuaXF1ZUJ5LCBmb2xkLCBmb2xkbCwgZm9sZDEsIGZvbGRsMSwgZm9sZHIsIGZvbGRyMSwgdW5mb2xkciwgY29uY2F0LCBjb25jYXRNYXAsIGZsYXR0ZW4sIGRpZmZlcmVuY2UsIGludGVyc2VjdGlvbiwgdW5pb24sIGNvdW50QnksIGdyb3VwQnksIGFuZExpc3QsIG9yTGlzdCwgYW55LCBhbGwsIHNvcnQsIHNvcnRXaXRoLCBzb3J0QnksIHN1bSwgcHJvZHVjdCwgbWVhbiwgYXZlcmFnZSwgbWF4aW11bSwgbWluaW11bSwgbWF4aW11bUJ5LCBtaW5pbXVtQnksIHNjYW4sIHNjYW5sLCBzY2FuMSwgc2NhbmwxLCBzY2Fuciwgc2NhbnIxLCBzbGljZSwgdGFrZSwgZHJvcCwgc3BsaXRBdCwgdGFrZVdoaWxlLCBkcm9wV2hpbGUsIHNwYW4sIGJyZWFrTGlzdCwgemlwLCB6aXBXaXRoLCB6aXBBbGwsIHppcEFsbFdpdGgsIGF0LCBlbGVtSW5kZXgsIGVsZW1JbmRpY2VzLCBmaW5kSW5kZXgsIGZpbmRJbmRpY2VzLCB0b1N0cmluZyQgPSB7fS50b1N0cmluZywgc2xpY2UkID0gW10uc2xpY2U7XG5lYWNoID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBmKHgpO1xuICB9XG4gIHJldHVybiB4cztcbn0pO1xubWFwID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4LCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICByZXN1bHRzJC5wdXNoKGYoeCkpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xuY29tcGFjdCA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4LCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoeCkge1xuICAgICAgcmVzdWx0cyQucHVzaCh4KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufTtcbmZpbHRlciA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgeCwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKGYoeCkpIHtcbiAgICAgIHJlc3VsdHMkLnB1c2goeCk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xucmVqZWN0ID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4LCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoIWYoeCkpIHtcbiAgICAgIHJlc3VsdHMkLnB1c2goeCk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xucGFydGl0aW9uID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIHBhc3NlZCwgZmFpbGVkLCBpJCwgbGVuJCwgeDtcbiAgcGFzc2VkID0gW107XG4gIGZhaWxlZCA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICAoZih4KSA/IHBhc3NlZCA6IGZhaWxlZCkucHVzaCh4KTtcbiAgfVxuICByZXR1cm4gW3Bhc3NlZCwgZmFpbGVkXTtcbn0pO1xuZmluZCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgeDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKGYoeCkpIHtcbiAgICAgIHJldHVybiB4O1xuICAgIH1cbiAgfVxufSk7XG5oZWFkID0gZmlyc3QgPSBmdW5jdGlvbih4cyl7XG4gIHJldHVybiB4c1swXTtcbn07XG50YWlsID0gZnVuY3Rpb24oeHMpe1xuICBpZiAoIXhzLmxlbmd0aCkge1xuICAgIHJldHVybjtcbiAgfVxuICByZXR1cm4geHMuc2xpY2UoMSk7XG59O1xubGFzdCA9IGZ1bmN0aW9uKHhzKXtcbiAgcmV0dXJuIHhzW3hzLmxlbmd0aCAtIDFdO1xufTtcbmluaXRpYWwgPSBmdW5jdGlvbih4cyl7XG4gIGlmICgheHMubGVuZ3RoKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHJldHVybiB4cy5zbGljZSgwLCAtMSk7XG59O1xuZW1wdHkgPSBmdW5jdGlvbih4cyl7XG4gIHJldHVybiAheHMubGVuZ3RoO1xufTtcbnJldmVyc2UgPSBmdW5jdGlvbih4cyl7XG4gIHJldHVybiB4cy5jb25jYXQoKS5yZXZlcnNlKCk7XG59O1xudW5pcXVlID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgcmVzdWx0LCBpJCwgbGVuJCwgeDtcbiAgcmVzdWx0ID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmICghaW4kKHgsIHJlc3VsdCkpIHtcbiAgICAgIHJlc3VsdC5wdXNoKHgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcbnVuaXF1ZUJ5ID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIHNlZW4sIGkkLCBsZW4kLCB4LCB2YWwsIHJlc3VsdHMkID0gW107XG4gIHNlZW4gPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgdmFsID0gZih4KTtcbiAgICBpZiAoaW4kKHZhbCwgc2VlbikpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBzZWVuLnB1c2godmFsKTtcbiAgICByZXN1bHRzJC5wdXNoKHgpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xuZm9sZCA9IGZvbGRsID0gY3VycnkkKGZ1bmN0aW9uKGYsIG1lbW8sIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBtZW1vID0gZihtZW1vLCB4KTtcbiAgfVxuICByZXR1cm4gbWVtbztcbn0pO1xuZm9sZDEgPSBmb2xkbDEgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICByZXR1cm4gZm9sZChmLCB4c1swXSwgeHMuc2xpY2UoMSkpO1xufSk7XG5mb2xkciA9IGN1cnJ5JChmdW5jdGlvbihmLCBtZW1vLCB4cyl7XG4gIHZhciBpJCwgeDtcbiAgZm9yIChpJCA9IHhzLmxlbmd0aCAtIDE7IGkkID49IDA7IC0taSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIG1lbW8gPSBmKHgsIG1lbW8pO1xuICB9XG4gIHJldHVybiBtZW1vO1xufSk7XG5mb2xkcjEgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICByZXR1cm4gZm9sZHIoZiwgeHNbeHMubGVuZ3RoIC0gMV0sIHhzLnNsaWNlKDAsIC0xKSk7XG59KTtcbnVuZm9sZHIgPSBjdXJyeSQoZnVuY3Rpb24oZiwgYil7XG4gIHZhciByZXN1bHQsIHgsIHRoYXQ7XG4gIHJlc3VsdCA9IFtdO1xuICB4ID0gYjtcbiAgd2hpbGUgKCh0aGF0ID0gZih4KSkgIT0gbnVsbCkge1xuICAgIHJlc3VsdC5wdXNoKHRoYXRbMF0pO1xuICAgIHggPSB0aGF0WzFdO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59KTtcbmNvbmNhdCA9IGZ1bmN0aW9uKHhzcyl7XG4gIHJldHVybiBbXS5jb25jYXQuYXBwbHkoW10sIHhzcyk7XG59O1xuY29uY2F0TWFwID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIHg7XG4gIHJldHVybiBbXS5jb25jYXQuYXBwbHkoW10sIChmdW5jdGlvbigpe1xuICAgIHZhciBpJCwgcmVmJCwgbGVuJCwgcmVzdWx0cyQgPSBbXTtcbiAgICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0geHMpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICB4ID0gcmVmJFtpJF07XG4gICAgICByZXN1bHRzJC5wdXNoKGYoeCkpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cyQ7XG4gIH0oKSkpO1xufSk7XG5mbGF0dGVuID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgeDtcbiAgcmV0dXJuIFtdLmNvbmNhdC5hcHBseShbXSwgKGZ1bmN0aW9uKCl7XG4gICAgdmFyIGkkLCByZWYkLCBsZW4kLCByZXN1bHRzJCA9IFtdO1xuICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB4cykubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgIHggPSByZWYkW2kkXTtcbiAgICAgIGlmICh0b1N0cmluZyQuY2FsbCh4KS5zbGljZSg4LCAtMSkgPT09ICdBcnJheScpIHtcbiAgICAgICAgcmVzdWx0cyQucHVzaChmbGF0dGVuKHgpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdHMkLnB1c2goeCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzJDtcbiAgfSgpKSk7XG59O1xuZGlmZmVyZW5jZSA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIHlzcywgcmVzdWx0cywgaSQsIGxlbiQsIHgsIGokLCBsZW4xJCwgeXM7XG4gIHlzcyA9IHNsaWNlJC5jYWxsKGFyZ3VtZW50cywgMSk7XG4gIHJlc3VsdHMgPSBbXTtcbiAgb3V0ZXI6IGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGZvciAoaiQgPSAwLCBsZW4xJCA9IHlzcy5sZW5ndGg7IGokIDwgbGVuMSQ7ICsraiQpIHtcbiAgICAgIHlzID0geXNzW2okXTtcbiAgICAgIGlmIChpbiQoeCwgeXMpKSB7XG4gICAgICAgIGNvbnRpbnVlIG91dGVyO1xuICAgICAgfVxuICAgIH1cbiAgICByZXN1bHRzLnB1c2goeCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7XG59O1xuaW50ZXJzZWN0aW9uID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgeXNzLCByZXN1bHRzLCBpJCwgbGVuJCwgeCwgaiQsIGxlbjEkLCB5cztcbiAgeXNzID0gc2xpY2UkLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgcmVzdWx0cyA9IFtdO1xuICBvdXRlcjogZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgZm9yIChqJCA9IDAsIGxlbjEkID0geXNzLmxlbmd0aDsgaiQgPCBsZW4xJDsgKytqJCkge1xuICAgICAgeXMgPSB5c3NbaiRdO1xuICAgICAgaWYgKCFpbiQoeCwgeXMpKSB7XG4gICAgICAgIGNvbnRpbnVlIG91dGVyO1xuICAgICAgfVxuICAgIH1cbiAgICByZXN1bHRzLnB1c2goeCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7XG59O1xudW5pb24gPSBmdW5jdGlvbigpe1xuICB2YXIgeHNzLCByZXN1bHRzLCBpJCwgbGVuJCwgeHMsIGokLCBsZW4xJCwgeDtcbiAgeHNzID0gc2xpY2UkLmNhbGwoYXJndW1lbnRzKTtcbiAgcmVzdWx0cyA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzcy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHhzID0geHNzW2kkXTtcbiAgICBmb3IgKGokID0gMCwgbGVuMSQgPSB4cy5sZW5ndGg7IGokIDwgbGVuMSQ7ICsraiQpIHtcbiAgICAgIHggPSB4c1tqJF07XG4gICAgICBpZiAoIWluJCh4LCByZXN1bHRzKSkge1xuICAgICAgICByZXN1bHRzLnB1c2goeCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRzO1xufTtcbmNvdW50QnkgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgcmVzdWx0cywgaSQsIGxlbiQsIHgsIGtleTtcbiAgcmVzdWx0cyA9IHt9O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBrZXkgPSBmKHgpO1xuICAgIGlmIChrZXkgaW4gcmVzdWx0cykge1xuICAgICAgcmVzdWx0c1trZXldICs9IDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdHNba2V5XSA9IDE7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRzO1xufSk7XG5ncm91cEJ5ID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIHJlc3VsdHMsIGkkLCBsZW4kLCB4LCBrZXk7XG4gIHJlc3VsdHMgPSB7fTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAga2V5ID0gZih4KTtcbiAgICBpZiAoa2V5IGluIHJlc3VsdHMpIHtcbiAgICAgIHJlc3VsdHNba2V5XS5wdXNoKHgpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHRzW2tleV0gPSBbeF07XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRzO1xufSk7XG5hbmRMaXN0ID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgaSQsIGxlbiQsIHg7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmICgheCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn07XG5vckxpc3QgPSBmdW5jdGlvbih4cyl7XG4gIHZhciBpJCwgbGVuJCwgeDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKHgpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuYW55ID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoZih4KSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn0pO1xuYWxsID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoIWYoeCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59KTtcbnNvcnQgPSBmdW5jdGlvbih4cyl7XG4gIHJldHVybiB4cy5jb25jYXQoKS5zb3J0KGZ1bmN0aW9uKHgsIHkpe1xuICAgIGlmICh4ID4geSkge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIGlmICh4IDwgeSkge1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH0pO1xufTtcbnNvcnRXaXRoID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgcmV0dXJuIHhzLmNvbmNhdCgpLnNvcnQoZik7XG59KTtcbnNvcnRCeSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHJldHVybiB4cy5jb25jYXQoKS5zb3J0KGZ1bmN0aW9uKHgsIHkpe1xuICAgIGlmIChmKHgpID4gZih5KSkge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIGlmIChmKHgpIDwgZih5KSkge1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH0pO1xufSk7XG5zdW0gPSBmdW5jdGlvbih4cyl7XG4gIHZhciByZXN1bHQsIGkkLCBsZW4kLCB4O1xuICByZXN1bHQgPSAwO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICByZXN1bHQgKz0geDtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcbnByb2R1Y3QgPSBmdW5jdGlvbih4cyl7XG4gIHZhciByZXN1bHQsIGkkLCBsZW4kLCB4O1xuICByZXN1bHQgPSAxO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICByZXN1bHQgKj0geDtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcbm1lYW4gPSBhdmVyYWdlID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgc3VtLCBpJCwgbGVuJCwgeDtcbiAgc3VtID0gMDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgc3VtICs9IHg7XG4gIH1cbiAgcmV0dXJuIHN1bSAvIHhzLmxlbmd0aDtcbn07XG5tYXhpbXVtID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgbWF4LCBpJCwgcmVmJCwgbGVuJCwgeDtcbiAgbWF4ID0geHNbMF07XG4gIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB4cy5zbGljZSgxKSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0gcmVmJFtpJF07XG4gICAgaWYgKHggPiBtYXgpIHtcbiAgICAgIG1heCA9IHg7XG4gICAgfVxuICB9XG4gIHJldHVybiBtYXg7XG59O1xubWluaW11bSA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIG1pbiwgaSQsIHJlZiQsIGxlbiQsIHg7XG4gIG1pbiA9IHhzWzBdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0geHMuc2xpY2UoMSkpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHJlZiRbaSRdO1xuICAgIGlmICh4IDwgbWluKSB7XG4gICAgICBtaW4gPSB4O1xuICAgIH1cbiAgfVxuICByZXR1cm4gbWluO1xufTtcbm1heGltdW1CeSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBtYXgsIGkkLCByZWYkLCBsZW4kLCB4O1xuICBtYXggPSB4c1swXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHhzLnNsaWNlKDEpKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSByZWYkW2kkXTtcbiAgICBpZiAoZih4KSA+IGYobWF4KSkge1xuICAgICAgbWF4ID0geDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG1heDtcbn0pO1xubWluaW11bUJ5ID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIG1pbiwgaSQsIHJlZiQsIGxlbiQsIHg7XG4gIG1pbiA9IHhzWzBdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0geHMuc2xpY2UoMSkpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHJlZiRbaSRdO1xuICAgIGlmIChmKHgpIDwgZihtaW4pKSB7XG4gICAgICBtaW4gPSB4O1xuICAgIH1cbiAgfVxuICByZXR1cm4gbWluO1xufSk7XG5zY2FuID0gc2NhbmwgPSBjdXJyeSQoZnVuY3Rpb24oZiwgbWVtbywgeHMpe1xuICB2YXIgbGFzdCwgeDtcbiAgbGFzdCA9IG1lbW87XG4gIHJldHVybiBbbWVtb10uY29uY2F0KChmdW5jdGlvbigpe1xuICAgIHZhciBpJCwgcmVmJCwgbGVuJCwgcmVzdWx0cyQgPSBbXTtcbiAgICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0geHMpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICB4ID0gcmVmJFtpJF07XG4gICAgICByZXN1bHRzJC5wdXNoKGxhc3QgPSBmKGxhc3QsIHgpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHMkO1xuICB9KCkpKTtcbn0pO1xuc2NhbjEgPSBzY2FubDEgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICBpZiAoIXhzLmxlbmd0aCkge1xuICAgIHJldHVybjtcbiAgfVxuICByZXR1cm4gc2NhbihmLCB4c1swXSwgeHMuc2xpY2UoMSkpO1xufSk7XG5zY2FuciA9IGN1cnJ5JChmdW5jdGlvbihmLCBtZW1vLCB4cyl7XG4gIHhzID0geHMuY29uY2F0KCkucmV2ZXJzZSgpO1xuICByZXR1cm4gc2NhbihmLCBtZW1vLCB4cykucmV2ZXJzZSgpO1xufSk7XG5zY2FucjEgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICBpZiAoIXhzLmxlbmd0aCkge1xuICAgIHJldHVybjtcbiAgfVxuICB4cyA9IHhzLmNvbmNhdCgpLnJldmVyc2UoKTtcbiAgcmV0dXJuIHNjYW4oZiwgeHNbMF0sIHhzLnNsaWNlKDEpKS5yZXZlcnNlKCk7XG59KTtcbnNsaWNlID0gY3VycnkkKGZ1bmN0aW9uKHgsIHksIHhzKXtcbiAgcmV0dXJuIHhzLnNsaWNlKHgsIHkpO1xufSk7XG50YWtlID0gY3VycnkkKGZ1bmN0aW9uKG4sIHhzKXtcbiAgaWYgKG4gPD0gMCkge1xuICAgIHJldHVybiB4cy5zbGljZSgwLCAwKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4geHMuc2xpY2UoMCwgbik7XG4gIH1cbn0pO1xuZHJvcCA9IGN1cnJ5JChmdW5jdGlvbihuLCB4cyl7XG4gIGlmIChuIDw9IDApIHtcbiAgICByZXR1cm4geHM7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHhzLnNsaWNlKG4pO1xuICB9XG59KTtcbnNwbGl0QXQgPSBjdXJyeSQoZnVuY3Rpb24obiwgeHMpe1xuICByZXR1cm4gW3Rha2UobiwgeHMpLCBkcm9wKG4sIHhzKV07XG59KTtcbnRha2VXaGlsZSA9IGN1cnJ5JChmdW5jdGlvbihwLCB4cyl7XG4gIHZhciBsZW4sIGk7XG4gIGxlbiA9IHhzLmxlbmd0aDtcbiAgaWYgKCFsZW4pIHtcbiAgICByZXR1cm4geHM7XG4gIH1cbiAgaSA9IDA7XG4gIHdoaWxlIChpIDwgbGVuICYmIHAoeHNbaV0pKSB7XG4gICAgaSArPSAxO1xuICB9XG4gIHJldHVybiB4cy5zbGljZSgwLCBpKTtcbn0pO1xuZHJvcFdoaWxlID0gY3VycnkkKGZ1bmN0aW9uKHAsIHhzKXtcbiAgdmFyIGxlbiwgaTtcbiAgbGVuID0geHMubGVuZ3RoO1xuICBpZiAoIWxlbikge1xuICAgIHJldHVybiB4cztcbiAgfVxuICBpID0gMDtcbiAgd2hpbGUgKGkgPCBsZW4gJiYgcCh4c1tpXSkpIHtcbiAgICBpICs9IDE7XG4gIH1cbiAgcmV0dXJuIHhzLnNsaWNlKGkpO1xufSk7XG5zcGFuID0gY3VycnkkKGZ1bmN0aW9uKHAsIHhzKXtcbiAgcmV0dXJuIFt0YWtlV2hpbGUocCwgeHMpLCBkcm9wV2hpbGUocCwgeHMpXTtcbn0pO1xuYnJlYWtMaXN0ID0gY3VycnkkKGZ1bmN0aW9uKHAsIHhzKXtcbiAgcmV0dXJuIHNwYW4oZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gbm90JChwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICB9LCB4cyk7XG59KTtcbnppcCA9IGN1cnJ5JChmdW5jdGlvbih4cywgeXMpe1xuICB2YXIgcmVzdWx0LCBsZW4sIGkkLCBsZW4kLCBpLCB4O1xuICByZXN1bHQgPSBbXTtcbiAgbGVuID0geXMubGVuZ3RoO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKGkgPT09IGxlbikge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJlc3VsdC5wdXNoKFt4LCB5c1tpXV0pO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59KTtcbnppcFdpdGggPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMsIHlzKXtcbiAgdmFyIHJlc3VsdCwgbGVuLCBpJCwgbGVuJCwgaSwgeDtcbiAgcmVzdWx0ID0gW107XG4gIGxlbiA9IHlzLmxlbmd0aDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIGkgPSBpJDtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmIChpID09PSBsZW4pIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXN1bHQucHVzaChmKHgsIHlzW2ldKSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn0pO1xuemlwQWxsID0gZnVuY3Rpb24oKXtcbiAgdmFyIHhzcywgbWluTGVuZ3RoLCBpJCwgbGVuJCwgeHMsIHJlZiQsIGksIGxyZXN1bHQkLCBqJCwgcmVzdWx0cyQgPSBbXTtcbiAgeHNzID0gc2xpY2UkLmNhbGwoYXJndW1lbnRzKTtcbiAgbWluTGVuZ3RoID0gOWU5O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzcy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHhzID0geHNzW2kkXTtcbiAgICBtaW5MZW5ndGggPD0gKHJlZiQgPSB4cy5sZW5ndGgpIHx8IChtaW5MZW5ndGggPSByZWYkKTtcbiAgfVxuICBmb3IgKGkkID0gMDsgaSQgPCBtaW5MZW5ndGg7ICsraSQpIHtcbiAgICBpID0gaSQ7XG4gICAgbHJlc3VsdCQgPSBbXTtcbiAgICBmb3IgKGokID0gMCwgbGVuJCA9IHhzcy5sZW5ndGg7IGokIDwgbGVuJDsgKytqJCkge1xuICAgICAgeHMgPSB4c3NbaiRdO1xuICAgICAgbHJlc3VsdCQucHVzaCh4c1tpXSk7XG4gICAgfVxuICAgIHJlc3VsdHMkLnB1c2gobHJlc3VsdCQpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn07XG56aXBBbGxXaXRoID0gZnVuY3Rpb24oZil7XG4gIHZhciB4c3MsIG1pbkxlbmd0aCwgaSQsIGxlbiQsIHhzLCByZWYkLCBpLCByZXN1bHRzJCA9IFtdO1xuICB4c3MgPSBzbGljZSQuY2FsbChhcmd1bWVudHMsIDEpO1xuICBtaW5MZW5ndGggPSA5ZTk7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHNzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeHMgPSB4c3NbaSRdO1xuICAgIG1pbkxlbmd0aCA8PSAocmVmJCA9IHhzLmxlbmd0aCkgfHwgKG1pbkxlbmd0aCA9IHJlZiQpO1xuICB9XG4gIGZvciAoaSQgPSAwOyBpJCA8IG1pbkxlbmd0aDsgKytpJCkge1xuICAgIGkgPSBpJDtcbiAgICByZXN1bHRzJC5wdXNoKGYuYXBwbHkobnVsbCwgKGZuJCgpKSkpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbiAgZnVuY3Rpb24gZm4kKCl7XG4gICAgdmFyIGkkLCByZWYkLCBsZW4kLCByZXN1bHRzJCA9IFtdO1xuICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB4c3MpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICB4cyA9IHJlZiRbaSRdO1xuICAgICAgcmVzdWx0cyQucHVzaCh4c1tpXSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzJDtcbiAgfVxufTtcbmF0ID0gY3VycnkkKGZ1bmN0aW9uKG4sIHhzKXtcbiAgaWYgKG4gPCAwKSB7XG4gICAgcmV0dXJuIHhzW3hzLmxlbmd0aCArIG5dO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB4c1tuXTtcbiAgfVxufSk7XG5lbGVtSW5kZXggPSBjdXJyeSQoZnVuY3Rpb24oZWwsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCBpLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKHggPT09IGVsKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbn0pO1xuZWxlbUluZGljZXMgPSBjdXJyeSQoZnVuY3Rpb24oZWwsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCBpLCB4LCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKHggPT09IGVsKSB7XG4gICAgICByZXN1bHRzJC5wdXNoKGkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbmZpbmRJbmRleCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgaSwgeDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIGkgPSBpJDtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmIChmKHgpKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbn0pO1xuZmluZEluZGljZXMgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIGksIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICBpID0gaSQ7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoZih4KSkge1xuICAgICAgcmVzdWx0cyQucHVzaChpKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufSk7XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZWFjaDogZWFjaCxcbiAgbWFwOiBtYXAsXG4gIGZpbHRlcjogZmlsdGVyLFxuICBjb21wYWN0OiBjb21wYWN0LFxuICByZWplY3Q6IHJlamVjdCxcbiAgcGFydGl0aW9uOiBwYXJ0aXRpb24sXG4gIGZpbmQ6IGZpbmQsXG4gIGhlYWQ6IGhlYWQsXG4gIGZpcnN0OiBmaXJzdCxcbiAgdGFpbDogdGFpbCxcbiAgbGFzdDogbGFzdCxcbiAgaW5pdGlhbDogaW5pdGlhbCxcbiAgZW1wdHk6IGVtcHR5LFxuICByZXZlcnNlOiByZXZlcnNlLFxuICBkaWZmZXJlbmNlOiBkaWZmZXJlbmNlLFxuICBpbnRlcnNlY3Rpb246IGludGVyc2VjdGlvbixcbiAgdW5pb246IHVuaW9uLFxuICBjb3VudEJ5OiBjb3VudEJ5LFxuICBncm91cEJ5OiBncm91cEJ5LFxuICBmb2xkOiBmb2xkLFxuICBmb2xkMTogZm9sZDEsXG4gIGZvbGRsOiBmb2xkbCxcbiAgZm9sZGwxOiBmb2xkbDEsXG4gIGZvbGRyOiBmb2xkcixcbiAgZm9sZHIxOiBmb2xkcjEsXG4gIHVuZm9sZHI6IHVuZm9sZHIsXG4gIGFuZExpc3Q6IGFuZExpc3QsXG4gIG9yTGlzdDogb3JMaXN0LFxuICBhbnk6IGFueSxcbiAgYWxsOiBhbGwsXG4gIHVuaXF1ZTogdW5pcXVlLFxuICB1bmlxdWVCeTogdW5pcXVlQnksXG4gIHNvcnQ6IHNvcnQsXG4gIHNvcnRXaXRoOiBzb3J0V2l0aCxcbiAgc29ydEJ5OiBzb3J0QnksXG4gIHN1bTogc3VtLFxuICBwcm9kdWN0OiBwcm9kdWN0LFxuICBtZWFuOiBtZWFuLFxuICBhdmVyYWdlOiBhdmVyYWdlLFxuICBjb25jYXQ6IGNvbmNhdCxcbiAgY29uY2F0TWFwOiBjb25jYXRNYXAsXG4gIGZsYXR0ZW46IGZsYXR0ZW4sXG4gIG1heGltdW06IG1heGltdW0sXG4gIG1pbmltdW06IG1pbmltdW0sXG4gIG1heGltdW1CeTogbWF4aW11bUJ5LFxuICBtaW5pbXVtQnk6IG1pbmltdW1CeSxcbiAgc2Nhbjogc2NhbixcbiAgc2NhbjE6IHNjYW4xLFxuICBzY2FubDogc2NhbmwsXG4gIHNjYW5sMTogc2NhbmwxLFxuICBzY2Fucjogc2NhbnIsXG4gIHNjYW5yMTogc2NhbnIxLFxuICBzbGljZTogc2xpY2UsXG4gIHRha2U6IHRha2UsXG4gIGRyb3A6IGRyb3AsXG4gIHNwbGl0QXQ6IHNwbGl0QXQsXG4gIHRha2VXaGlsZTogdGFrZVdoaWxlLFxuICBkcm9wV2hpbGU6IGRyb3BXaGlsZSxcbiAgc3Bhbjogc3BhbixcbiAgYnJlYWtMaXN0OiBicmVha0xpc3QsXG4gIHppcDogemlwLFxuICB6aXBXaXRoOiB6aXBXaXRoLFxuICB6aXBBbGw6IHppcEFsbCxcbiAgemlwQWxsV2l0aDogemlwQWxsV2l0aCxcbiAgYXQ6IGF0LFxuICBlbGVtSW5kZXg6IGVsZW1JbmRleCxcbiAgZWxlbUluZGljZXM6IGVsZW1JbmRpY2VzLFxuICBmaW5kSW5kZXg6IGZpbmRJbmRleCxcbiAgZmluZEluZGljZXM6IGZpbmRJbmRpY2VzXG59O1xuZnVuY3Rpb24gY3VycnkkKGYsIGJvdW5kKXtcbiAgdmFyIGNvbnRleHQsXG4gIF9jdXJyeSA9IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICByZXR1cm4gZi5sZW5ndGggPiAxID8gZnVuY3Rpb24oKXtcbiAgICAgIHZhciBwYXJhbXMgPSBhcmdzID8gYXJncy5jb25jYXQoKSA6IFtdO1xuICAgICAgY29udGV4dCA9IGJvdW5kID8gY29udGV4dCB8fCB0aGlzIDogdGhpcztcbiAgICAgIHJldHVybiBwYXJhbXMucHVzaC5hcHBseShwYXJhbXMsIGFyZ3VtZW50cykgPFxuICAgICAgICAgIGYubGVuZ3RoICYmIGFyZ3VtZW50cy5sZW5ndGggP1xuICAgICAgICBfY3VycnkuY2FsbChjb250ZXh0LCBwYXJhbXMpIDogZi5hcHBseShjb250ZXh0LCBwYXJhbXMpO1xuICAgIH0gOiBmO1xuICB9O1xuICByZXR1cm4gX2N1cnJ5KCk7XG59XG5mdW5jdGlvbiBpbiQoeCwgeHMpe1xuICB2YXIgaSA9IC0xLCBsID0geHMubGVuZ3RoID4+PiAwO1xuICB3aGlsZSAoKytpIDwgbCkgaWYgKHggPT09IHhzW2ldKSByZXR1cm4gdHJ1ZTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gbm90JCh4KXsgcmV0dXJuICF4OyB9IiwiLy8gR2VuZXJhdGVkIGJ5IExpdmVTY3JpcHQgMS4yLjBcbnZhciBtYXgsIG1pbiwgbmVnYXRlLCBhYnMsIHNpZ251bSwgcXVvdCwgcmVtLCBkaXYsIG1vZCwgcmVjaXAsIHBpLCB0YXUsIGV4cCwgc3FydCwgbG4sIHBvdywgc2luLCB0YW4sIGNvcywgYXNpbiwgYWNvcywgYXRhbiwgYXRhbjIsIHRydW5jYXRlLCByb3VuZCwgY2VpbGluZywgZmxvb3IsIGlzSXROYU4sIGV2ZW4sIG9kZCwgZ2NkLCBsY207XG5tYXggPSBjdXJyeSQoZnVuY3Rpb24oeCQsIHkkKXtcbiAgcmV0dXJuIHgkID4geSQgPyB4JCA6IHkkO1xufSk7XG5taW4gPSBjdXJyeSQoZnVuY3Rpb24oeCQsIHkkKXtcbiAgcmV0dXJuIHgkIDwgeSQgPyB4JCA6IHkkO1xufSk7XG5uZWdhdGUgPSBmdW5jdGlvbih4KXtcbiAgcmV0dXJuIC14O1xufTtcbmFicyA9IE1hdGguYWJzO1xuc2lnbnVtID0gZnVuY3Rpb24oeCl7XG4gIGlmICh4IDwgMCkge1xuICAgIHJldHVybiAtMTtcbiAgfSBlbHNlIGlmICh4ID4gMCkge1xuICAgIHJldHVybiAxO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAwO1xuICB9XG59O1xucXVvdCA9IGN1cnJ5JChmdW5jdGlvbih4LCB5KXtcbiAgcmV0dXJuIH5+KHggLyB5KTtcbn0pO1xucmVtID0gY3VycnkkKGZ1bmN0aW9uKHgkLCB5JCl7XG4gIHJldHVybiB4JCAlIHkkO1xufSk7XG5kaXYgPSBjdXJyeSQoZnVuY3Rpb24oeCwgeSl7XG4gIHJldHVybiBNYXRoLmZsb29yKHggLyB5KTtcbn0pO1xubW9kID0gY3VycnkkKGZ1bmN0aW9uKHgkLCB5JCl7XG4gIHZhciByZWYkO1xuICByZXR1cm4gKCh4JCkgJSAocmVmJCA9IHkkKSArIHJlZiQpICUgcmVmJDtcbn0pO1xucmVjaXAgPSAoZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gMSAvIGl0O1xufSk7XG5waSA9IE1hdGguUEk7XG50YXUgPSBwaSAqIDI7XG5leHAgPSBNYXRoLmV4cDtcbnNxcnQgPSBNYXRoLnNxcnQ7XG5sbiA9IE1hdGgubG9nO1xucG93ID0gY3VycnkkKGZ1bmN0aW9uKHgkLCB5JCl7XG4gIHJldHVybiBNYXRoLnBvdyh4JCwgeSQpO1xufSk7XG5zaW4gPSBNYXRoLnNpbjtcbnRhbiA9IE1hdGgudGFuO1xuY29zID0gTWF0aC5jb3M7XG5hc2luID0gTWF0aC5hc2luO1xuYWNvcyA9IE1hdGguYWNvcztcbmF0YW4gPSBNYXRoLmF0YW47XG5hdGFuMiA9IGN1cnJ5JChmdW5jdGlvbih4LCB5KXtcbiAgcmV0dXJuIE1hdGguYXRhbjIoeCwgeSk7XG59KTtcbnRydW5jYXRlID0gZnVuY3Rpb24oeCl7XG4gIHJldHVybiB+fng7XG59O1xucm91bmQgPSBNYXRoLnJvdW5kO1xuY2VpbGluZyA9IE1hdGguY2VpbDtcbmZsb29yID0gTWF0aC5mbG9vcjtcbmlzSXROYU4gPSBmdW5jdGlvbih4KXtcbiAgcmV0dXJuIHggIT09IHg7XG59O1xuZXZlbiA9IGZ1bmN0aW9uKHgpe1xuICByZXR1cm4geCAlIDIgPT09IDA7XG59O1xub2RkID0gZnVuY3Rpb24oeCl7XG4gIHJldHVybiB4ICUgMiAhPT0gMDtcbn07XG5nY2QgPSBjdXJyeSQoZnVuY3Rpb24oeCwgeSl7XG4gIHZhciB6O1xuICB4ID0gTWF0aC5hYnMoeCk7XG4gIHkgPSBNYXRoLmFicyh5KTtcbiAgd2hpbGUgKHkgIT09IDApIHtcbiAgICB6ID0geCAlIHk7XG4gICAgeCA9IHk7XG4gICAgeSA9IHo7XG4gIH1cbiAgcmV0dXJuIHg7XG59KTtcbmxjbSA9IGN1cnJ5JChmdW5jdGlvbih4LCB5KXtcbiAgcmV0dXJuIE1hdGguYWJzKE1hdGguZmxvb3IoeCAvIGdjZCh4LCB5KSAqIHkpKTtcbn0pO1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIG1heDogbWF4LFxuICBtaW46IG1pbixcbiAgbmVnYXRlOiBuZWdhdGUsXG4gIGFiczogYWJzLFxuICBzaWdudW06IHNpZ251bSxcbiAgcXVvdDogcXVvdCxcbiAgcmVtOiByZW0sXG4gIGRpdjogZGl2LFxuICBtb2Q6IG1vZCxcbiAgcmVjaXA6IHJlY2lwLFxuICBwaTogcGksXG4gIHRhdTogdGF1LFxuICBleHA6IGV4cCxcbiAgc3FydDogc3FydCxcbiAgbG46IGxuLFxuICBwb3c6IHBvdyxcbiAgc2luOiBzaW4sXG4gIHRhbjogdGFuLFxuICBjb3M6IGNvcyxcbiAgYWNvczogYWNvcyxcbiAgYXNpbjogYXNpbixcbiAgYXRhbjogYXRhbixcbiAgYXRhbjI6IGF0YW4yLFxuICB0cnVuY2F0ZTogdHJ1bmNhdGUsXG4gIHJvdW5kOiByb3VuZCxcbiAgY2VpbGluZzogY2VpbGluZyxcbiAgZmxvb3I6IGZsb29yLFxuICBpc0l0TmFOOiBpc0l0TmFOLFxuICBldmVuOiBldmVuLFxuICBvZGQ6IG9kZCxcbiAgZ2NkOiBnY2QsXG4gIGxjbTogbGNtXG59O1xuZnVuY3Rpb24gY3VycnkkKGYsIGJvdW5kKXtcbiAgdmFyIGNvbnRleHQsXG4gIF9jdXJyeSA9IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICByZXR1cm4gZi5sZW5ndGggPiAxID8gZnVuY3Rpb24oKXtcbiAgICAgIHZhciBwYXJhbXMgPSBhcmdzID8gYXJncy5jb25jYXQoKSA6IFtdO1xuICAgICAgY29udGV4dCA9IGJvdW5kID8gY29udGV4dCB8fCB0aGlzIDogdGhpcztcbiAgICAgIHJldHVybiBwYXJhbXMucHVzaC5hcHBseShwYXJhbXMsIGFyZ3VtZW50cykgPFxuICAgICAgICAgIGYubGVuZ3RoICYmIGFyZ3VtZW50cy5sZW5ndGggP1xuICAgICAgICBfY3VycnkuY2FsbChjb250ZXh0LCBwYXJhbXMpIDogZi5hcHBseShjb250ZXh0LCBwYXJhbXMpO1xuICAgIH0gOiBmO1xuICB9O1xuICByZXR1cm4gX2N1cnJ5KCk7XG59IiwiLy8gR2VuZXJhdGVkIGJ5IExpdmVTY3JpcHQgMS4yLjBcbnZhciB2YWx1ZXMsIGtleXMsIHBhaXJzVG9PYmosIG9ialRvUGFpcnMsIGxpc3RzVG9PYmosIG9ialRvTGlzdHMsIGVtcHR5LCBlYWNoLCBtYXAsIGNvbXBhY3QsIGZpbHRlciwgcmVqZWN0LCBwYXJ0aXRpb24sIGZpbmQ7XG52YWx1ZXMgPSBmdW5jdGlvbihvYmplY3Qpe1xuICB2YXIgaSQsIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtpJF07XG4gICAgcmVzdWx0cyQucHVzaCh4KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59O1xua2V5cyA9IGZ1bmN0aW9uKG9iamVjdCl7XG4gIHZhciB4LCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKHggaW4gb2JqZWN0KSB7XG4gICAgcmVzdWx0cyQucHVzaCh4KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59O1xucGFpcnNUb09iaiA9IGZ1bmN0aW9uKG9iamVjdCl7XG4gIHZhciBpJCwgbGVuJCwgeCwgcmVzdWx0cyQgPSB7fTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSBvYmplY3QubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0gb2JqZWN0W2kkXTtcbiAgICByZXN1bHRzJFt4WzBdXSA9IHhbMV07XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufTtcbm9ialRvUGFpcnMgPSBmdW5jdGlvbihvYmplY3Qpe1xuICB2YXIga2V5LCB2YWx1ZSwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgdmFsdWUgPSBvYmplY3Rba2V5XTtcbiAgICByZXN1bHRzJC5wdXNoKFtrZXksIHZhbHVlXSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufTtcbmxpc3RzVG9PYmogPSBjdXJyeSQoZnVuY3Rpb24oa2V5cywgdmFsdWVzKXtcbiAgdmFyIGkkLCBsZW4kLCBpLCBrZXksIHJlc3VsdHMkID0ge307XG4gIGZvciAoaSQgPSAwLCBsZW4kID0ga2V5cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIGkgPSBpJDtcbiAgICBrZXkgPSBrZXlzW2kkXTtcbiAgICByZXN1bHRzJFtrZXldID0gdmFsdWVzW2ldO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xub2JqVG9MaXN0cyA9IGZ1bmN0aW9uKG9iamVjdCl7XG4gIHZhciBrZXlzLCB2YWx1ZXMsIGtleSwgdmFsdWU7XG4gIGtleXMgPSBbXTtcbiAgdmFsdWVzID0gW107XG4gIGZvciAoa2V5IGluIG9iamVjdCkge1xuICAgIHZhbHVlID0gb2JqZWN0W2tleV07XG4gICAga2V5cy5wdXNoKGtleSk7XG4gICAgdmFsdWVzLnB1c2godmFsdWUpO1xuICB9XG4gIHJldHVybiBba2V5cywgdmFsdWVzXTtcbn07XG5lbXB0eSA9IGZ1bmN0aW9uKG9iamVjdCl7XG4gIHZhciB4O1xuICBmb3IgKHggaW4gb2JqZWN0KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiB0cnVlO1xufTtcbmVhY2ggPSBjdXJyeSQoZnVuY3Rpb24oZiwgb2JqZWN0KXtcbiAgdmFyIGkkLCB4O1xuICBmb3IgKGkkIGluIG9iamVjdCkge1xuICAgIHggPSBvYmplY3RbaSRdO1xuICAgIGYoeCk7XG4gIH1cbiAgcmV0dXJuIG9iamVjdDtcbn0pO1xubWFwID0gY3VycnkkKGZ1bmN0aW9uKGYsIG9iamVjdCl7XG4gIHZhciBrLCB4LCByZXN1bHRzJCA9IHt9O1xuICBmb3IgKGsgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtrXTtcbiAgICByZXN1bHRzJFtrXSA9IGYoeCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufSk7XG5jb21wYWN0ID0gZnVuY3Rpb24ob2JqZWN0KXtcbiAgdmFyIGssIHgsIHJlc3VsdHMkID0ge307XG4gIGZvciAoayBpbiBvYmplY3QpIHtcbiAgICB4ID0gb2JqZWN0W2tdO1xuaWYgKHgpIHtcbiAgICAgIHJlc3VsdHMkW2tdID0geDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufTtcbmZpbHRlciA9IGN1cnJ5JChmdW5jdGlvbihmLCBvYmplY3Qpe1xuICB2YXIgaywgeCwgcmVzdWx0cyQgPSB7fTtcbiAgZm9yIChrIGluIG9iamVjdCkge1xuICAgIHggPSBvYmplY3Rba107XG5pZiAoZih4KSkge1xuICAgICAgcmVzdWx0cyRba10gPSB4O1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbnJlamVjdCA9IGN1cnJ5JChmdW5jdGlvbihmLCBvYmplY3Qpe1xuICB2YXIgaywgeCwgcmVzdWx0cyQgPSB7fTtcbiAgZm9yIChrIGluIG9iamVjdCkge1xuICAgIHggPSBvYmplY3Rba107XG5pZiAoIWYoeCkpIHtcbiAgICAgIHJlc3VsdHMkW2tdID0geDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufSk7XG5wYXJ0aXRpb24gPSBjdXJyeSQoZnVuY3Rpb24oZiwgb2JqZWN0KXtcbiAgdmFyIHBhc3NlZCwgZmFpbGVkLCBrLCB4O1xuICBwYXNzZWQgPSB7fTtcbiAgZmFpbGVkID0ge307XG4gIGZvciAoayBpbiBvYmplY3QpIHtcbiAgICB4ID0gb2JqZWN0W2tdO1xuICAgIChmKHgpID8gcGFzc2VkIDogZmFpbGVkKVtrXSA9IHg7XG4gIH1cbiAgcmV0dXJuIFtwYXNzZWQsIGZhaWxlZF07XG59KTtcbmZpbmQgPSBjdXJyeSQoZnVuY3Rpb24oZiwgb2JqZWN0KXtcbiAgdmFyIGkkLCB4O1xuICBmb3IgKGkkIGluIG9iamVjdCkge1xuICAgIHggPSBvYmplY3RbaSRdO1xuICAgIGlmIChmKHgpKSB7XG4gICAgICByZXR1cm4geDtcbiAgICB9XG4gIH1cbn0pO1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHZhbHVlczogdmFsdWVzLFxuICBrZXlzOiBrZXlzLFxuICBwYWlyc1RvT2JqOiBwYWlyc1RvT2JqLFxuICBvYmpUb1BhaXJzOiBvYmpUb1BhaXJzLFxuICBsaXN0c1RvT2JqOiBsaXN0c1RvT2JqLFxuICBvYmpUb0xpc3RzOiBvYmpUb0xpc3RzLFxuICBlbXB0eTogZW1wdHksXG4gIGVhY2g6IGVhY2gsXG4gIG1hcDogbWFwLFxuICBmaWx0ZXI6IGZpbHRlcixcbiAgY29tcGFjdDogY29tcGFjdCxcbiAgcmVqZWN0OiByZWplY3QsXG4gIHBhcnRpdGlvbjogcGFydGl0aW9uLFxuICBmaW5kOiBmaW5kXG59O1xuZnVuY3Rpb24gY3VycnkkKGYsIGJvdW5kKXtcbiAgdmFyIGNvbnRleHQsXG4gIF9jdXJyeSA9IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICByZXR1cm4gZi5sZW5ndGggPiAxID8gZnVuY3Rpb24oKXtcbiAgICAgIHZhciBwYXJhbXMgPSBhcmdzID8gYXJncy5jb25jYXQoKSA6IFtdO1xuICAgICAgY29udGV4dCA9IGJvdW5kID8gY29udGV4dCB8fCB0aGlzIDogdGhpcztcbiAgICAgIHJldHVybiBwYXJhbXMucHVzaC5hcHBseShwYXJhbXMsIGFyZ3VtZW50cykgPFxuICAgICAgICAgIGYubGVuZ3RoICYmIGFyZ3VtZW50cy5sZW5ndGggP1xuICAgICAgICBfY3VycnkuY2FsbChjb250ZXh0LCBwYXJhbXMpIDogZi5hcHBseShjb250ZXh0LCBwYXJhbXMpO1xuICAgIH0gOiBmO1xuICB9O1xuICByZXR1cm4gX2N1cnJ5KCk7XG59IiwiLy8gR2VuZXJhdGVkIGJ5IExpdmVTY3JpcHQgMS4yLjBcbnZhciBzcGxpdCwgam9pbiwgbGluZXMsIHVubGluZXMsIHdvcmRzLCB1bndvcmRzLCBjaGFycywgdW5jaGFycywgcmV2ZXJzZSwgcmVwZWF0LCBjYXBpdGFsaXplLCBjYW1lbGl6ZSwgZGFzaGVyaXplO1xuc3BsaXQgPSBjdXJyeSQoZnVuY3Rpb24oc2VwLCBzdHIpe1xuICByZXR1cm4gc3RyLnNwbGl0KHNlcCk7XG59KTtcbmpvaW4gPSBjdXJyeSQoZnVuY3Rpb24oc2VwLCB4cyl7XG4gIHJldHVybiB4cy5qb2luKHNlcCk7XG59KTtcbmxpbmVzID0gZnVuY3Rpb24oc3RyKXtcbiAgaWYgKCFzdHIubGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHJldHVybiBzdHIuc3BsaXQoJ1xcbicpO1xufTtcbnVubGluZXMgPSBmdW5jdGlvbihpdCl7XG4gIHJldHVybiBpdC5qb2luKCdcXG4nKTtcbn07XG53b3JkcyA9IGZ1bmN0aW9uKHN0cil7XG4gIGlmICghc3RyLmxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICByZXR1cm4gc3RyLnNwbGl0KC9bIF0rLyk7XG59O1xudW53b3JkcyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGl0LmpvaW4oJyAnKTtcbn07XG5jaGFycyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGl0LnNwbGl0KCcnKTtcbn07XG51bmNoYXJzID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXQuam9pbignJyk7XG59O1xucmV2ZXJzZSA9IGZ1bmN0aW9uKHN0cil7XG4gIHJldHVybiBzdHIuc3BsaXQoJycpLnJldmVyc2UoKS5qb2luKCcnKTtcbn07XG5yZXBlYXQgPSBjdXJyeSQoZnVuY3Rpb24obiwgc3RyKXtcbiAgdmFyIHJlc3VsdCwgaSQ7XG4gIHJlc3VsdCA9ICcnO1xuICBmb3IgKGkkID0gMDsgaSQgPCBuOyArK2kkKSB7XG4gICAgcmVzdWx0ICs9IHN0cjtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufSk7XG5jYXBpdGFsaXplID0gZnVuY3Rpb24oc3RyKXtcbiAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKTtcbn07XG5jYW1lbGl6ZSA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGl0LnJlcGxhY2UoL1stX10rKC4pPy9nLCBmdW5jdGlvbihhcmckLCBjKXtcbiAgICByZXR1cm4gKGMgIT0gbnVsbCA/IGMgOiAnJykudG9VcHBlckNhc2UoKTtcbiAgfSk7XG59O1xuZGFzaGVyaXplID0gZnVuY3Rpb24oc3RyKXtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC8oW14tQS1aXSkoW0EtWl0rKS9nLCBmdW5jdGlvbihhcmckLCBsb3dlciwgdXBwZXIpe1xuICAgIHJldHVybiBsb3dlciArIFwiLVwiICsgKHVwcGVyLmxlbmd0aCA+IDFcbiAgICAgID8gdXBwZXJcbiAgICAgIDogdXBwZXIudG9Mb3dlckNhc2UoKSk7XG4gIH0pLnJlcGxhY2UoL14oW0EtWl0rKS8sIGZ1bmN0aW9uKGFyZyQsIHVwcGVyKXtcbiAgICBpZiAodXBwZXIubGVuZ3RoID4gMSkge1xuICAgICAgcmV0dXJuIHVwcGVyICsgXCItXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB1cHBlci50b0xvd2VyQ2FzZSgpO1xuICAgIH1cbiAgfSk7XG59O1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNwbGl0OiBzcGxpdCxcbiAgam9pbjogam9pbixcbiAgbGluZXM6IGxpbmVzLFxuICB1bmxpbmVzOiB1bmxpbmVzLFxuICB3b3Jkczogd29yZHMsXG4gIHVud29yZHM6IHVud29yZHMsXG4gIGNoYXJzOiBjaGFycyxcbiAgdW5jaGFyczogdW5jaGFycyxcbiAgcmV2ZXJzZTogcmV2ZXJzZSxcbiAgcmVwZWF0OiByZXBlYXQsXG4gIGNhcGl0YWxpemU6IGNhcGl0YWxpemUsXG4gIGNhbWVsaXplOiBjYW1lbGl6ZSxcbiAgZGFzaGVyaXplOiBkYXNoZXJpemVcbn07XG5mdW5jdGlvbiBjdXJyeSQoZiwgYm91bmQpe1xuICB2YXIgY29udGV4dCxcbiAgX2N1cnJ5ID0gZnVuY3Rpb24oYXJncykge1xuICAgIHJldHVybiBmLmxlbmd0aCA+IDEgPyBmdW5jdGlvbigpe1xuICAgICAgdmFyIHBhcmFtcyA9IGFyZ3MgPyBhcmdzLmNvbmNhdCgpIDogW107XG4gICAgICBjb250ZXh0ID0gYm91bmQgPyBjb250ZXh0IHx8IHRoaXMgOiB0aGlzO1xuICAgICAgcmV0dXJuIHBhcmFtcy5wdXNoLmFwcGx5KHBhcmFtcywgYXJndW1lbnRzKSA8XG4gICAgICAgICAgZi5sZW5ndGggJiYgYXJndW1lbnRzLmxlbmd0aCA/XG4gICAgICAgIF9jdXJyeS5jYWxsKGNvbnRleHQsIHBhcmFtcykgOiBmLmFwcGx5KGNvbnRleHQsIHBhcmFtcyk7XG4gICAgfSA6IGY7XG4gIH07XG4gIHJldHVybiBfY3VycnkoKTtcbn0iLCIvLyBHZW5lcmF0ZWQgYnkgTGl2ZVNjcmlwdCAxLjIuMFxudmFyIEZ1bmMsIExpc3QsIE9iaiwgU3RyLCBOdW0sIGlkLCBpc1R5cGUsIHJlcGxpY2F0ZSwgcHJlbHVkZSwgdG9TdHJpbmckID0ge30udG9TdHJpbmc7XG5GdW5jID0gcmVxdWlyZSgnLi9GdW5jLmpzJyk7XG5MaXN0ID0gcmVxdWlyZSgnLi9MaXN0LmpzJyk7XG5PYmogPSByZXF1aXJlKCcuL09iai5qcycpO1xuU3RyID0gcmVxdWlyZSgnLi9TdHIuanMnKTtcbk51bSA9IHJlcXVpcmUoJy4vTnVtLmpzJyk7XG5pZCA9IGZ1bmN0aW9uKHgpe1xuICByZXR1cm4geDtcbn07XG5pc1R5cGUgPSBjdXJyeSQoZnVuY3Rpb24odHlwZSwgeCl7XG4gIHJldHVybiB0b1N0cmluZyQuY2FsbCh4KS5zbGljZSg4LCAtMSkgPT09IHR5cGU7XG59KTtcbnJlcGxpY2F0ZSA9IGN1cnJ5JChmdW5jdGlvbihuLCB4KXtcbiAgdmFyIGkkLCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGkkID0gMDsgaSQgPCBuOyArK2kkKSB7XG4gICAgcmVzdWx0cyQucHVzaCh4KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcblN0ci5lbXB0eSA9IExpc3QuZW1wdHk7XG5TdHIuc2xpY2UgPSBMaXN0LnNsaWNlO1xuU3RyLnRha2UgPSBMaXN0LnRha2U7XG5TdHIuZHJvcCA9IExpc3QuZHJvcDtcblN0ci5zcGxpdEF0ID0gTGlzdC5zcGxpdEF0O1xuU3RyLnRha2VXaGlsZSA9IExpc3QudGFrZVdoaWxlO1xuU3RyLmRyb3BXaGlsZSA9IExpc3QuZHJvcFdoaWxlO1xuU3RyLnNwYW4gPSBMaXN0LnNwYW47XG5TdHIuYnJlYWtTdHIgPSBMaXN0LmJyZWFrTGlzdDtcbnByZWx1ZGUgPSB7XG4gIEZ1bmM6IEZ1bmMsXG4gIExpc3Q6IExpc3QsXG4gIE9iajogT2JqLFxuICBTdHI6IFN0cixcbiAgTnVtOiBOdW0sXG4gIGlkOiBpZCxcbiAgaXNUeXBlOiBpc1R5cGUsXG4gIHJlcGxpY2F0ZTogcmVwbGljYXRlXG59O1xucHJlbHVkZS5lYWNoID0gTGlzdC5lYWNoO1xucHJlbHVkZS5tYXAgPSBMaXN0Lm1hcDtcbnByZWx1ZGUuZmlsdGVyID0gTGlzdC5maWx0ZXI7XG5wcmVsdWRlLmNvbXBhY3QgPSBMaXN0LmNvbXBhY3Q7XG5wcmVsdWRlLnJlamVjdCA9IExpc3QucmVqZWN0O1xucHJlbHVkZS5wYXJ0aXRpb24gPSBMaXN0LnBhcnRpdGlvbjtcbnByZWx1ZGUuZmluZCA9IExpc3QuZmluZDtcbnByZWx1ZGUuaGVhZCA9IExpc3QuaGVhZDtcbnByZWx1ZGUuZmlyc3QgPSBMaXN0LmZpcnN0O1xucHJlbHVkZS50YWlsID0gTGlzdC50YWlsO1xucHJlbHVkZS5sYXN0ID0gTGlzdC5sYXN0O1xucHJlbHVkZS5pbml0aWFsID0gTGlzdC5pbml0aWFsO1xucHJlbHVkZS5lbXB0eSA9IExpc3QuZW1wdHk7XG5wcmVsdWRlLnJldmVyc2UgPSBMaXN0LnJldmVyc2U7XG5wcmVsdWRlLmRpZmZlcmVuY2UgPSBMaXN0LmRpZmZlcmVuY2U7XG5wcmVsdWRlLmludGVyc2VjdGlvbiA9IExpc3QuaW50ZXJzZWN0aW9uO1xucHJlbHVkZS51bmlvbiA9IExpc3QudW5pb247XG5wcmVsdWRlLmNvdW50QnkgPSBMaXN0LmNvdW50Qnk7XG5wcmVsdWRlLmdyb3VwQnkgPSBMaXN0Lmdyb3VwQnk7XG5wcmVsdWRlLmZvbGQgPSBMaXN0LmZvbGQ7XG5wcmVsdWRlLmZvbGRsID0gTGlzdC5mb2xkbDtcbnByZWx1ZGUuZm9sZDEgPSBMaXN0LmZvbGQxO1xucHJlbHVkZS5mb2xkbDEgPSBMaXN0LmZvbGRsMTtcbnByZWx1ZGUuZm9sZHIgPSBMaXN0LmZvbGRyO1xucHJlbHVkZS5mb2xkcjEgPSBMaXN0LmZvbGRyMTtcbnByZWx1ZGUudW5mb2xkciA9IExpc3QudW5mb2xkcjtcbnByZWx1ZGUuYW5kTGlzdCA9IExpc3QuYW5kTGlzdDtcbnByZWx1ZGUub3JMaXN0ID0gTGlzdC5vckxpc3Q7XG5wcmVsdWRlLmFueSA9IExpc3QuYW55O1xucHJlbHVkZS5hbGwgPSBMaXN0LmFsbDtcbnByZWx1ZGUudW5pcXVlID0gTGlzdC51bmlxdWU7XG5wcmVsdWRlLnVuaXF1ZUJ5ID0gTGlzdC51bmlxdWVCeTtcbnByZWx1ZGUuc29ydCA9IExpc3Quc29ydDtcbnByZWx1ZGUuc29ydFdpdGggPSBMaXN0LnNvcnRXaXRoO1xucHJlbHVkZS5zb3J0QnkgPSBMaXN0LnNvcnRCeTtcbnByZWx1ZGUuc3VtID0gTGlzdC5zdW07XG5wcmVsdWRlLnByb2R1Y3QgPSBMaXN0LnByb2R1Y3Q7XG5wcmVsdWRlLm1lYW4gPSBMaXN0Lm1lYW47XG5wcmVsdWRlLmF2ZXJhZ2UgPSBMaXN0LmF2ZXJhZ2U7XG5wcmVsdWRlLmNvbmNhdCA9IExpc3QuY29uY2F0O1xucHJlbHVkZS5jb25jYXRNYXAgPSBMaXN0LmNvbmNhdE1hcDtcbnByZWx1ZGUuZmxhdHRlbiA9IExpc3QuZmxhdHRlbjtcbnByZWx1ZGUubWF4aW11bSA9IExpc3QubWF4aW11bTtcbnByZWx1ZGUubWluaW11bSA9IExpc3QubWluaW11bTtcbnByZWx1ZGUubWF4aW11bUJ5ID0gTGlzdC5tYXhpbXVtQnk7XG5wcmVsdWRlLm1pbmltdW1CeSA9IExpc3QubWluaW11bUJ5O1xucHJlbHVkZS5zY2FuID0gTGlzdC5zY2FuO1xucHJlbHVkZS5zY2FubCA9IExpc3Quc2Nhbmw7XG5wcmVsdWRlLnNjYW4xID0gTGlzdC5zY2FuMTtcbnByZWx1ZGUuc2NhbmwxID0gTGlzdC5zY2FubDE7XG5wcmVsdWRlLnNjYW5yID0gTGlzdC5zY2FucjtcbnByZWx1ZGUuc2NhbnIxID0gTGlzdC5zY2FucjE7XG5wcmVsdWRlLnNsaWNlID0gTGlzdC5zbGljZTtcbnByZWx1ZGUudGFrZSA9IExpc3QudGFrZTtcbnByZWx1ZGUuZHJvcCA9IExpc3QuZHJvcDtcbnByZWx1ZGUuc3BsaXRBdCA9IExpc3Quc3BsaXRBdDtcbnByZWx1ZGUudGFrZVdoaWxlID0gTGlzdC50YWtlV2hpbGU7XG5wcmVsdWRlLmRyb3BXaGlsZSA9IExpc3QuZHJvcFdoaWxlO1xucHJlbHVkZS5zcGFuID0gTGlzdC5zcGFuO1xucHJlbHVkZS5icmVha0xpc3QgPSBMaXN0LmJyZWFrTGlzdDtcbnByZWx1ZGUuemlwID0gTGlzdC56aXA7XG5wcmVsdWRlLnppcFdpdGggPSBMaXN0LnppcFdpdGg7XG5wcmVsdWRlLnppcEFsbCA9IExpc3QuemlwQWxsO1xucHJlbHVkZS56aXBBbGxXaXRoID0gTGlzdC56aXBBbGxXaXRoO1xucHJlbHVkZS5hdCA9IExpc3QuYXQ7XG5wcmVsdWRlLmVsZW1JbmRleCA9IExpc3QuZWxlbUluZGV4O1xucHJlbHVkZS5lbGVtSW5kaWNlcyA9IExpc3QuZWxlbUluZGljZXM7XG5wcmVsdWRlLmZpbmRJbmRleCA9IExpc3QuZmluZEluZGV4O1xucHJlbHVkZS5maW5kSW5kaWNlcyA9IExpc3QuZmluZEluZGljZXM7XG5wcmVsdWRlLmFwcGx5ID0gRnVuYy5hcHBseTtcbnByZWx1ZGUuY3VycnkgPSBGdW5jLmN1cnJ5O1xucHJlbHVkZS5mbGlwID0gRnVuYy5mbGlwO1xucHJlbHVkZS5maXggPSBGdW5jLmZpeDtcbnByZWx1ZGUub3ZlciA9IEZ1bmMub3ZlcjtcbnByZWx1ZGUuc3BsaXQgPSBTdHIuc3BsaXQ7XG5wcmVsdWRlLmpvaW4gPSBTdHIuam9pbjtcbnByZWx1ZGUubGluZXMgPSBTdHIubGluZXM7XG5wcmVsdWRlLnVubGluZXMgPSBTdHIudW5saW5lcztcbnByZWx1ZGUud29yZHMgPSBTdHIud29yZHM7XG5wcmVsdWRlLnVud29yZHMgPSBTdHIudW53b3JkcztcbnByZWx1ZGUuY2hhcnMgPSBTdHIuY2hhcnM7XG5wcmVsdWRlLnVuY2hhcnMgPSBTdHIudW5jaGFycztcbnByZWx1ZGUucmVwZWF0ID0gU3RyLnJlcGVhdDtcbnByZWx1ZGUuY2FwaXRhbGl6ZSA9IFN0ci5jYXBpdGFsaXplO1xucHJlbHVkZS5jYW1lbGl6ZSA9IFN0ci5jYW1lbGl6ZTtcbnByZWx1ZGUuZGFzaGVyaXplID0gU3RyLmRhc2hlcml6ZTtcbnByZWx1ZGUudmFsdWVzID0gT2JqLnZhbHVlcztcbnByZWx1ZGUua2V5cyA9IE9iai5rZXlzO1xucHJlbHVkZS5wYWlyc1RvT2JqID0gT2JqLnBhaXJzVG9PYmo7XG5wcmVsdWRlLm9ialRvUGFpcnMgPSBPYmoub2JqVG9QYWlycztcbnByZWx1ZGUubGlzdHNUb09iaiA9IE9iai5saXN0c1RvT2JqO1xucHJlbHVkZS5vYmpUb0xpc3RzID0gT2JqLm9ialRvTGlzdHM7XG5wcmVsdWRlLm1heCA9IE51bS5tYXg7XG5wcmVsdWRlLm1pbiA9IE51bS5taW47XG5wcmVsdWRlLm5lZ2F0ZSA9IE51bS5uZWdhdGU7XG5wcmVsdWRlLmFicyA9IE51bS5hYnM7XG5wcmVsdWRlLnNpZ251bSA9IE51bS5zaWdudW07XG5wcmVsdWRlLnF1b3QgPSBOdW0ucXVvdDtcbnByZWx1ZGUucmVtID0gTnVtLnJlbTtcbnByZWx1ZGUuZGl2ID0gTnVtLmRpdjtcbnByZWx1ZGUubW9kID0gTnVtLm1vZDtcbnByZWx1ZGUucmVjaXAgPSBOdW0ucmVjaXA7XG5wcmVsdWRlLnBpID0gTnVtLnBpO1xucHJlbHVkZS50YXUgPSBOdW0udGF1O1xucHJlbHVkZS5leHAgPSBOdW0uZXhwO1xucHJlbHVkZS5zcXJ0ID0gTnVtLnNxcnQ7XG5wcmVsdWRlLmxuID0gTnVtLmxuO1xucHJlbHVkZS5wb3cgPSBOdW0ucG93O1xucHJlbHVkZS5zaW4gPSBOdW0uc2luO1xucHJlbHVkZS50YW4gPSBOdW0udGFuO1xucHJlbHVkZS5jb3MgPSBOdW0uY29zO1xucHJlbHVkZS5hY29zID0gTnVtLmFjb3M7XG5wcmVsdWRlLmFzaW4gPSBOdW0uYXNpbjtcbnByZWx1ZGUuYXRhbiA9IE51bS5hdGFuO1xucHJlbHVkZS5hdGFuMiA9IE51bS5hdGFuMjtcbnByZWx1ZGUudHJ1bmNhdGUgPSBOdW0udHJ1bmNhdGU7XG5wcmVsdWRlLnJvdW5kID0gTnVtLnJvdW5kO1xucHJlbHVkZS5jZWlsaW5nID0gTnVtLmNlaWxpbmc7XG5wcmVsdWRlLmZsb29yID0gTnVtLmZsb29yO1xucHJlbHVkZS5pc0l0TmFOID0gTnVtLmlzSXROYU47XG5wcmVsdWRlLmV2ZW4gPSBOdW0uZXZlbjtcbnByZWx1ZGUub2RkID0gTnVtLm9kZDtcbnByZWx1ZGUuZ2NkID0gTnVtLmdjZDtcbnByZWx1ZGUubGNtID0gTnVtLmxjbTtcbnByZWx1ZGUuVkVSU0lPTiA9ICcxLjEuMSc7XG5tb2R1bGUuZXhwb3J0cyA9IHByZWx1ZGU7XG5mdW5jdGlvbiBjdXJyeSQoZiwgYm91bmQpe1xuICB2YXIgY29udGV4dCxcbiAgX2N1cnJ5ID0gZnVuY3Rpb24oYXJncykge1xuICAgIHJldHVybiBmLmxlbmd0aCA+IDEgPyBmdW5jdGlvbigpe1xuICAgICAgdmFyIHBhcmFtcyA9IGFyZ3MgPyBhcmdzLmNvbmNhdCgpIDogW107XG4gICAgICBjb250ZXh0ID0gYm91bmQgPyBjb250ZXh0IHx8IHRoaXMgOiB0aGlzO1xuICAgICAgcmV0dXJuIHBhcmFtcy5wdXNoLmFwcGx5KHBhcmFtcywgYXJndW1lbnRzKSA8XG4gICAgICAgICAgZi5sZW5ndGggJiYgYXJndW1lbnRzLmxlbmd0aCA/XG4gICAgICAgIF9jdXJyeS5jYWxsKGNvbnRleHQsIHBhcmFtcykgOiBmLmFwcGx5KGNvbnRleHQsIHBhcmFtcyk7XG4gICAgfSA6IGY7XG4gIH07XG4gIHJldHVybiBfY3VycnkoKTtcbn0iLCJ2YXIgc3RkLCB1bml0cywgU3ByaXRlLCBBbmltYXRlZFNwcml0ZTtcbnN0ZCA9IHJlcXVpcmUoJ3N0ZCcpO1xudW5pdHMgPSByZXF1aXJlKCcuL3VuaXRzJyk7XG5TcHJpdGUgPSByZXF1aXJlKCcuL3Nwcml0ZScpO1xubW9kdWxlLmV4cG9ydHMgPSBBbmltYXRlZFNwcml0ZSA9IChmdW5jdGlvbihzdXBlcmNsYXNzKXtcbiAgdmFyIHByb3RvdHlwZSA9IGV4dGVuZCQoKGltcG9ydCQoQW5pbWF0ZWRTcHJpdGUsIHN1cGVyY2xhc3MpLmRpc3BsYXlOYW1lID0gJ0FuaW1hdGVkU3ByaXRlJywgQW5pbWF0ZWRTcHJpdGUpLCBzdXBlcmNsYXNzKS5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gQW5pbWF0ZWRTcHJpdGU7XG4gIGZ1bmN0aW9uIEFuaW1hdGVkU3ByaXRlKGdyYXBoaWNzLCBwYXRoLCBzb3VyY2VYLCBzb3VyY2VZLCB3aWR0aCwgaGVpZ2h0LCBmcHMsIG51bUZyYW1lcyl7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHRoaXMuZnBzID0gZnBzO1xuICAgIHRoaXMubnVtRnJhbWVzID0gbnVtRnJhbWVzO1xuICAgIEFuaW1hdGVkU3ByaXRlLnN1cGVyY2xhc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB0aGlzLmZyYW1lVGltZSA9IDEwMDAgLyB0aGlzLmZwcztcbiAgICB0aGlzLmN1cnJlbnRGcmFtZSA9IDA7XG4gICAgdGhpcy5lbGFwc2VkVGltZSA9IDA7XG4gIH1cbiAgcHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKGVsYXBzZWRUaW1lKXtcbiAgICB0aGlzLmVsYXBzZWRUaW1lICs9IGVsYXBzZWRUaW1lO1xuICAgIGlmICh0aGlzLmVsYXBzZWRUaW1lID4gdGhpcy5mcmFtZVRpbWUpIHtcbiAgICAgIHRoaXMuY3VycmVudEZyYW1lICs9IDE7XG4gICAgICB0aGlzLmVsYXBzZWRUaW1lID0gMDtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRGcmFtZSA8IHRoaXMubnVtRnJhbWVzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvdXJjZVJlY3QueCArPSB0aGlzLnNvdXJjZVJlY3QudztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc291cmNlUmVjdC54IC09IHRoaXMuc291cmNlUmVjdC53ICogKHRoaXMubnVtRnJhbWVzIC0gMSk7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRGcmFtZSA9IDA7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICByZXR1cm4gQW5pbWF0ZWRTcHJpdGU7XG59KFNwcml0ZSkpO1xuZnVuY3Rpb24gZXh0ZW5kJChzdWIsIHN1cCl7XG4gIGZ1bmN0aW9uIGZ1bigpe30gZnVuLnByb3RvdHlwZSA9IChzdWIuc3VwZXJjbGFzcyA9IHN1cCkucHJvdG90eXBlO1xuICAoc3ViLnByb3RvdHlwZSA9IG5ldyBmdW4pLmNvbnN0cnVjdG9yID0gc3ViO1xuICBpZiAodHlwZW9mIHN1cC5leHRlbmRlZCA9PSAnZnVuY3Rpb24nKSBzdXAuZXh0ZW5kZWQoc3ViKTtcbiAgcmV0dXJuIHN1Yjtcbn1cbmZ1bmN0aW9uIGltcG9ydCQob2JqLCBzcmMpe1xuICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gIGZvciAodmFyIGtleSBpbiBzcmMpIGlmIChvd24uY2FsbChzcmMsIGtleSkpIG9ialtrZXldID0gc3JjW2tleV07XG4gIHJldHVybiBvYmo7XG59IiwidmFyIHN0ZCwgU0RMLCB1bml0cywgY29uZmlnLCBrU2NyZWVuV2lkdGgsIGtTY3JlZW5IZWlnaHQsIGtCYWNrZ3JvdW5kU2l6ZSwgRml4ZWRCYWNrZHJvcCwgb3V0JCA9IHR5cGVvZiBleHBvcnRzICE9ICd1bmRlZmluZWQnICYmIGV4cG9ydHMgfHwgdGhpcztcbnN0ZCA9IHJlcXVpcmUoJ3N0ZCcpO1xuU0RMID0gcmVxdWlyZSgnU0RMJyk7XG51bml0cyA9IHJlcXVpcmUoJy4vdW5pdHMnKTtcbmNvbmZpZyA9IHJlcXVpcmUoJy4vY29uZmlnJyk7XG5rU2NyZWVuV2lkdGggPSBjb25maWcua1NjcmVlbldpZHRoLCBrU2NyZWVuSGVpZ2h0ID0gY29uZmlnLmtTY3JlZW5IZWlnaHQ7XG5rQmFja2dyb3VuZFNpemUgPSA0O1xub3V0JC5GaXhlZEJhY2tkcm9wID0gRml4ZWRCYWNrZHJvcCA9IChmdW5jdGlvbigpe1xuICBGaXhlZEJhY2tkcm9wLmRpc3BsYXlOYW1lID0gJ0ZpeGVkQmFja2Ryb3AnO1xuICB2YXIgcHJvdG90eXBlID0gRml4ZWRCYWNrZHJvcC5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gRml4ZWRCYWNrZHJvcDtcbiAgZnVuY3Rpb24gRml4ZWRCYWNrZHJvcChwYXRoLCBncmFwaGljcyl7XG4gICAgdGhpcy5zdXJmYWNlID0gZ3JhcGhpY3MubG9hZEltYWdlKHBhdGgpO1xuICB9XG4gIHByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24oZ3JhcGhpY3Mpe1xuICAgIHZhciBpJCwgc3RlcCQsIHRvJCwgeCwgbHJlc3VsdCQsIGokLCBzdGVwMSQsIHRvMSQsIHksIGRlc3RSZWN0LCByZXN1bHRzJCA9IFtdO1xuICAgIGZvciAoaSQgPSAwLCB0byQgPSB1bml0cy50aWxlVG9QeChrU2NyZWVuV2lkdGggKyBrQmFja2dyb3VuZFNpemUpLCBzdGVwJCA9IHVuaXRzLnRpbGVUb1B4KGtCYWNrZ3JvdW5kU2l6ZSk7IHN0ZXAkIDwgMCA/IGkkID49IHRvJCA6IGkkIDw9IHRvJDsgaSQgKz0gc3RlcCQpIHtcbiAgICAgIHggPSBpJDtcbiAgICAgIGxyZXN1bHQkID0gW107XG4gICAgICBmb3IgKGokID0gMCwgdG8xJCA9IHVuaXRzLnRpbGVUb1B4KGtTY3JlZW5IZWlnaHQgKyBrQmFja2dyb3VuZFNpemUpLCBzdGVwMSQgPSB1bml0cy50aWxlVG9QeChrQmFja2dyb3VuZFNpemUpOyBzdGVwMSQgPCAwID8gaiQgPj0gdG8xJCA6IGokIDw9IHRvMSQ7IGokICs9IHN0ZXAxJCkge1xuICAgICAgICB5ID0gaiQ7XG4gICAgICAgIGRlc3RSZWN0ID0gbmV3IFNETC5SZWN0KHgsIHksIHVuaXRzLnRpbGVUb1B4KGtCYWNrZ3JvdW5kU2l6ZSksIHVuaXRzLnRpbGVUb1B4KGtCYWNrZ3JvdW5kU2l6ZSkpO1xuICAgICAgICBscmVzdWx0JC5wdXNoKGdyYXBoaWNzLmJsaXRTdXJmYWNlKHRoaXMuc3VyZmFjZSwgbnVsbCwgZGVzdFJlY3QpKTtcbiAgICAgIH1cbiAgICAgIHJlc3VsdHMkLnB1c2gobHJlc3VsdCQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cyQ7XG4gIH07XG4gIHJldHVybiBGaXhlZEJhY2tkcm9wO1xufSgpKTsiLCJ2YXIga1NjcmVlbldpZHRoLCBrU2NyZWVuSGVpZ2h0LCBrRnBzLCBrRGVidWdNb2RlLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xub3V0JC5rU2NyZWVuV2lkdGggPSBrU2NyZWVuV2lkdGggPSAyMDtcbm91dCQua1NjcmVlbkhlaWdodCA9IGtTY3JlZW5IZWlnaHQgPSAxNTtcbm91dCQua0ZwcyA9IGtGcHMgPSA2MDtcbm91dCQua0RlYnVnTW9kZSA9IGtEZWJ1Z01vZGUgPSB0cnVlOyIsInZhciBzdGQsIFNETCwgaW5wdXQsIHVuaXRzLCBjb25maWcsIHJlYWRvdXQsIGdyYXBoaWNzLCBNYXAsIFBsYXllciwgRml4ZWRCYWNrZHJvcCwga1NjcmVlbldpZHRoLCBrU2NyZWVuSGVpZ2h0LCBrRnBzLCBrRGVidWdNb2RlLCBydW5uaW5nLCBwbGF5ZXIsIG1hcCwgbGFzdEZyYW1lVGltZSwgYW55S2V5c1ByZXNzZWQsIGV2ZW50TG9vcCwgdXBkYXRlLCBkcmF3LCBjcmVhdGVUZXN0V29ybGQsIHN0YXJ0LCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuc3RkID0gcmVxdWlyZSgnc3RkJyk7XG5TREwgPSByZXF1aXJlKCdTREwnKTtcbmlucHV0ID0gcmVxdWlyZSgnLi9pbnB1dCcpO1xudW5pdHMgPSByZXF1aXJlKCcuL3VuaXRzJyk7XG5jb25maWcgPSByZXF1aXJlKCcuL2NvbmZpZycpO1xucmVhZG91dCA9IHJlcXVpcmUoJy4vcmVhZG91dCcpO1xuZ3JhcGhpY3MgPSByZXF1aXJlKCcuL2dyYXBoaWNzJyk7XG5NYXAgPSByZXF1aXJlKCcuL21hcCcpO1xuUGxheWVyID0gcmVxdWlyZSgnLi9wbGF5ZXInKS5QbGF5ZXI7XG5GaXhlZEJhY2tkcm9wID0gcmVxdWlyZSgnLi9iYWNrZHJvcCcpLkZpeGVkQmFja2Ryb3A7XG5rU2NyZWVuV2lkdGggPSBjb25maWcua1NjcmVlbldpZHRoLCBrU2NyZWVuSGVpZ2h0ID0gY29uZmlnLmtTY3JlZW5IZWlnaHQsIGtGcHMgPSBjb25maWcua0Zwcywga0RlYnVnTW9kZSA9IGNvbmZpZy5rRGVidWdNb2RlO1xucnVubmluZyA9IHRydWU7XG5wbGF5ZXIgPSBudWxsO1xubWFwID0gbnVsbDtcbmxhc3RGcmFtZVRpbWUgPSAwO1xuYW55S2V5c1ByZXNzZWQgPSBmYWxzZTtcbmV2ZW50TG9vcCA9IGZ1bmN0aW9uKCl7XG4gIHZhciBzdGFydFRpbWUsIGV2ZW50LCDOlHQsIGVsYXBzZWRUaW1lO1xuICBzdGFydFRpbWUgPSBTREwuZ2V0VGlja3MoKTtcbiAgaW5wdXQuYmVnaW5OZXdGcmFtZSgpO1xuICB3aGlsZSAoZXZlbnQgPSBTREwucG9sbEV2ZW50KCkpIHtcbiAgICBhbnlLZXlzUHJlc3NlZCA9IHRydWU7XG4gICAgcmVhZG91dC51cGRhdGUoJ3dpbGxzdG9wJywgZmFsc2UpO1xuICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgIGNhc2UgU0RMLktFWURPV046XG4gICAgICBpbnB1dC5rZXlEb3duRXZlbnQoZXZlbnQpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBTREwuS0VZVVA6XG4gICAgICBpbnB1dC5rZXlVcEV2ZW50KGV2ZW50KTtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3Ioe1xuICAgICAgICBtZXNzYWdlOiBcIlVua25vd24gZXZlbnQgdHlwZTogXCIgKyBldmVudFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGlmIChpbnB1dC53YXNLZXlQcmVzc2VkKFNETC5LRVkuRVNDQVBFKSkge1xuICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgfVxuICBpZiAoaW5wdXQuaXNLZXlIZWxkKFNETC5LRVkuTEVGVCkgJiYgaW5wdXQuaXNLZXlIZWxkKFNETC5LRVkuUklHSFQpKSB7XG4gICAgcGxheWVyLnN0b3BNb3ZpbmcoKTtcbiAgfSBlbHNlIGlmIChpbnB1dC5pc0tleUhlbGQoU0RMLktFWS5MRUZUKSkge1xuICAgIHBsYXllci5zdGFydE1vdmluZ0xlZnQoKTtcbiAgfSBlbHNlIGlmIChpbnB1dC5pc0tleUhlbGQoU0RMLktFWS5SSUdIVCkpIHtcbiAgICBwbGF5ZXIuc3RhcnRNb3ZpbmdSaWdodCgpO1xuICB9IGVsc2Uge1xuICAgIHBsYXllci5zdG9wTW92aW5nKCk7XG4gIH1cbiAgaWYgKGlucHV0Lndhc0tleVByZXNzZWQoU0RMLktFWS5aKSkge1xuICAgIHBsYXllci5zdGFydEp1bXAoKTtcbiAgfSBlbHNlIGlmIChpbnB1dC53YXNLZXlSZWxlYXNlZChTREwuS0VZLlopKSB7XG4gICAgcGxheWVyLnN0b3BKdW1wKCk7XG4gIH1cbiAgaWYgKGlucHV0LmlzS2V5SGVsZChTREwuS0VZLlVQKSAmJiBpbnB1dC5pc0tleUhlbGQoU0RMLktFWS5ET1dOKSkge1xuICAgIHBsYXllci5sb29rSG9yaXpvbnRhbCgpO1xuICB9IGVsc2UgaWYgKGlucHV0LmlzS2V5SGVsZChTREwuS0VZLlVQKSkge1xuICAgIHBsYXllci5sb29rVXAoKTtcbiAgfSBlbHNlIGlmIChpbnB1dC5pc0tleUhlbGQoU0RMLktFWS5ET1dOKSkge1xuICAgIHBsYXllci5sb29rRG93bigpO1xuICB9IGVsc2Uge1xuICAgIHBsYXllci5sb29rSG9yaXpvbnRhbCgpO1xuICB9XG4gIM6UdCA9IFNETC5nZXRUaWNrcygpIC0gbGFzdEZyYW1lVGltZTtcbiAgdXBkYXRlKM6UdCk7XG4gIGRyYXcoKTtcbiAgaWYgKHJ1bm5pbmcpIHtcbiAgICBsYXN0RnJhbWVUaW1lID0gU0RMLmdldFRpY2tzKCk7XG4gICAgZWxhcHNlZFRpbWUgPSBsYXN0RnJhbWVUaW1lIC0gc3RhcnRUaW1lO1xuICAgIHJlYWRvdXQudXBkYXRlKCdmcmFtZXRpbWUnLCBzdGQuZmxvb3IoMTAwMCAvIM6UdCkpO1xuICAgIHJlYWRvdXQudXBkYXRlKCdkcmF3dGltZScsIGVsYXBzZWRUaW1lKTtcbiAgICByZXR1cm4gU0RMLmRlbGF5KDEwMDAgLyBrRnBzIC0gZWxhcHNlZFRpbWUsIGV2ZW50TG9vcCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHN0ZC5sb2coJ0dhbWUgc3RvcHBlZC4nKTtcbiAgfVxufTtcbnVwZGF0ZSA9IGZ1bmN0aW9uKGVsYXBzZWRUaW1lKXtcbiAgcGxheWVyLnVwZGF0ZShlbGFwc2VkVGltZSwgbWFwKTtcbiAgcmV0dXJuIG1hcC51cGRhdGUoZWxhcHNlZFRpbWUpO1xufTtcbmRyYXcgPSBmdW5jdGlvbigpe1xuICBncmFwaGljcy5jbGVhcigpO1xuICBtYXAuZHJhd0JhY2tncm91bmQoZ3JhcGhpY3MpO1xuICBwbGF5ZXIuZHJhdyhncmFwaGljcyk7XG4gIHJldHVybiBtYXAuZHJhdyhncmFwaGljcyk7XG59O1xuY3JlYXRlVGVzdFdvcmxkID0gZnVuY3Rpb24oKXtcbiAgcGxheWVyID0gbmV3IFBsYXllcih1bml0cy50aWxlVG9HYW1lKGtTY3JlZW5XaWR0aCAvIDIpLCB1bml0cy50aWxlVG9HYW1lKGtTY3JlZW5IZWlnaHQgLyAyKSk7XG4gIHJldHVybiBtYXAgPSBNYXAuY3JlYXRlVGVzdE1hcChncmFwaGljcyk7XG59O1xub3V0JC5zdGFydCA9IHN0YXJ0ID0gZnVuY3Rpb24oKXtcbiAgU0RMLmluaXQoU0RMLklOSVRfRVZFUllUSElORyk7XG4gIHJlYWRvdXQuYWRkUmVhZGVyKCdmcmFtZXRpbWUnLCAnRnJhbWUgdGltZScpO1xuICByZWFkb3V0LmFkZFJlYWRlcignZHJhd3RpbWUnLCAnRHJhdyB0aW1lJyk7XG4gIHJlYWRvdXQuYWRkUmVhZGVyKCd3aWxsc3RvcCcsICdXaWxsIHN0b3AnLCB0cnVlKTtcbiAgY3JlYXRlVGVzdFdvcmxkKCk7XG4gIGV2ZW50TG9vcCgpO1xuICByZXR1cm4gc3RkLmRlbGF5KDUwMDAsIGZ1bmN0aW9uKCl7XG4gICAgaWYgKCFhbnlLZXlzUHJlc3NlZCkge1xuICAgICAgcmV0dXJuIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHN0ZC5sb2coXCJHYW1lIGJlaW5nIGludGVyYWN0ZWQgd2l0aC4gRG9uJ3Qgc2h1dCBkb3duXCIpO1xuICAgIH1cbiAgfSk7XG59OyIsInZhciBzdGQsIFNETCwgY29uZmlnLCB1bml0cywga1NjcmVlbldpZHRoLCBrU2NyZWVuSGVpZ2h0LCBrVHJhbnNwYXJlbnRDb2xvciwgc2NyZWVuLCBzcHJpdGVzaGVldHMsIGxvYWRJbWFnZSwgYmxpdFN1cmZhY2UsIGNsZWFyLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuc3RkID0gcmVxdWlyZSgnc3RkJyk7XG5TREwgPSByZXF1aXJlKCdTREwnKTtcbmNvbmZpZyA9IHJlcXVpcmUoJy4vY29uZmlnJyk7XG51bml0cyA9IHJlcXVpcmUoJy4vdW5pdHMnKTtcbmtTY3JlZW5XaWR0aCA9IGNvbmZpZy5rU2NyZWVuV2lkdGgsIGtTY3JlZW5IZWlnaHQgPSBjb25maWcua1NjcmVlbkhlaWdodDtcbmtUcmFuc3BhcmVudENvbG9yID0gWzAsIDAsIDBdO1xuc2NyZWVuID0gU0RMLnNldFZpZGVvTW9kZSh1bml0cy50aWxlVG9QeChrU2NyZWVuV2lkdGgpLCB1bml0cy50aWxlVG9QeChrU2NyZWVuSGVpZ2h0KSwgMik7XG5zcHJpdGVzaGVldHMgPSB7fTtcbm91dCQubG9hZEltYWdlID0gbG9hZEltYWdlID0gZnVuY3Rpb24ocGF0aCwgdXNlVHJhbnNwYXJlbmN5KXtcbiAgdXNlVHJhbnNwYXJlbmN5ID09IG51bGwgJiYgKHVzZVRyYW5zcGFyZW5jeSA9IGZhbHNlKTtcbiAgaWYgKHNwcml0ZXNoZWV0c1twYXRoXSA9PSBudWxsKSB7XG4gICAgc3ByaXRlc2hlZXRzW3BhdGhdID0gU0RMLmxvYWRJbWFnZShwYXRoKTtcbiAgICBpZiAodXNlVHJhbnNwYXJlbmN5KSB7XG4gICAgICBTREwuc2V0Q29sb3JLZXkoc3ByaXRlc2hlZXRzW3BhdGhdLCBrVHJhbnNwYXJlbnRDb2xvcik7XG4gICAgfVxuICAgIGlmIChjb25maWcua0RlYnVnTW9kZSkge1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzcHJpdGVzaGVldHNbcGF0aF0uY2FudmFzKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHNwcml0ZXNoZWV0c1twYXRoXTtcbn07XG5vdXQkLmJsaXRTdXJmYWNlID0gYmxpdFN1cmZhY2UgPSBmdW5jdGlvbihzb3VyY2UsIHNyY1JlY3QsIGRlc3RSZWN0KXtcbiAgcmV0dXJuIFNETC5ibGl0U3VyZmFjZShzb3VyY2UsIHNyY1JlY3QsIHNjcmVlbiwgZGVzdFJlY3QpO1xufTtcbm91dCQuY2xlYXIgPSBjbGVhciA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiBzY3JlZW4uY2xlYXIoKTtcbn07IiwidmFyIHN0ZCwgSW5wdXQ7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcbklucHV0ID0gKGZ1bmN0aW9uKCl7XG4gIElucHV0LmRpc3BsYXlOYW1lID0gJ0lucHV0JztcbiAgdmFyIHByb3RvdHlwZSA9IElucHV0LnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBJbnB1dDtcbiAgZnVuY3Rpb24gSW5wdXQoKXtcbiAgICB0aGlzLmhlbGRLZXlzID0ge307XG4gICAgdGhpcy5wcmVzc2VkS2V5cyA9IHt9O1xuICAgIHRoaXMucmVsZWFzZWRLZXlzID0ge307XG4gIH1cbiAgcHJvdG90eXBlLmJlZ2luTmV3RnJhbWUgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMucHJlc3NlZEtleXMgPSB7fTtcbiAgICByZXR1cm4gdGhpcy5yZWxlYXNlZEtleXMgPSB7fTtcbiAgfTtcbiAgcHJvdG90eXBlLmtleURvd25FdmVudCA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgICB0aGlzLnByZXNzZWRLZXlzW2V2ZW50LmtleV0gPSB0cnVlO1xuICAgIHJldHVybiB0aGlzLmhlbGRLZXlzW2V2ZW50LmtleV0gPSB0cnVlO1xuICB9O1xuICBwcm90b3R5cGUua2V5VXBFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgICB0aGlzLnJlbGVhc2VkS2V5c1tldmVudC5rZXldID0gdHJ1ZTtcbiAgICByZXR1cm4gdGhpcy5oZWxkS2V5c1tldmVudC5rZXldID0gZmFsc2U7XG4gIH07XG4gIHByb3RvdHlwZS53YXNLZXlQcmVzc2VkID0gZnVuY3Rpb24oa2V5KXtcbiAgICByZXR1cm4gdGhpcy5wcmVzc2VkS2V5c1trZXldO1xuICB9O1xuICBwcm90b3R5cGUud2FzS2V5UmVsZWFzZWQgPSBmdW5jdGlvbihrZXkpe1xuICAgIHJldHVybiB0aGlzLnJlbGVhc2VkS2V5c1trZXldO1xuICB9O1xuICBwcm90b3R5cGUuaXNLZXlIZWxkID0gZnVuY3Rpb24oa2V5KXtcbiAgICByZXR1cm4gdGhpcy5oZWxkS2V5c1trZXldO1xuICB9O1xuICByZXR1cm4gSW5wdXQ7XG59KCkpO1xubW9kdWxlLmV4cG9ydHMgPSBuZXcgSW5wdXQ7IiwidmFyIHN0ZCwgdW5pdHMsIGRpdiwgU3ByaXRlLCBSZWN0LCBGaXhlZEJhY2tkcm9wLCByZWYkLCBBSVJfVElMRSwgV0FMTF9USUxFLCBUaWxlLCBDb2xsaXNpb25UaWxlLCBNYXA7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcbnVuaXRzID0gcmVxdWlyZSgnLi91bml0cycpO1xuZGl2ID0gc3RkLmRpdjtcblNwcml0ZSA9IHJlcXVpcmUoJy4vc3ByaXRlJyk7XG5SZWN0ID0gcmVxdWlyZSgnLi9yZWN0YW5nbGUnKS5SZWN0YW5nbGU7XG5GaXhlZEJhY2tkcm9wID0gcmVxdWlyZSgnLi9iYWNrZHJvcCcpLkZpeGVkQmFja2Ryb3A7XG5yZWYkID0gc3RkWydlbnVtJ10sIEFJUl9USUxFID0gcmVmJFswXSwgV0FMTF9USUxFID0gcmVmJFsxXTtcblRpbGUgPSAoZnVuY3Rpb24oKXtcbiAgVGlsZS5kaXNwbGF5TmFtZSA9ICdUaWxlJztcbiAgdmFyIHByb3RvdHlwZSA9IFRpbGUucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IFRpbGU7XG4gIGZ1bmN0aW9uIFRpbGUodHlwZSwgc3ByaXRlKXtcbiAgICB0aGlzLnR5cGUgPSB0eXBlICE9IG51bGwgPyB0eXBlIDogQUlSX1RJTEU7XG4gICAgdGhpcy5zcHJpdGUgPSBzcHJpdGU7XG4gIH1cbiAgcmV0dXJuIFRpbGU7XG59KCkpO1xuQ29sbGlzaW9uVGlsZSA9IChmdW5jdGlvbigpe1xuICBDb2xsaXNpb25UaWxlLmRpc3BsYXlOYW1lID0gJ0NvbGxpc2lvblRpbGUnO1xuICB2YXIgcHJvdG90eXBlID0gQ29sbGlzaW9uVGlsZS5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gQ29sbGlzaW9uVGlsZTtcbiAgZnVuY3Rpb24gQ29sbGlzaW9uVGlsZShyb3csIGNvbCwgdHlwZSl7XG4gICAgdGhpcy5yb3cgPSByb3c7XG4gICAgdGhpcy5jb2wgPSBjb2w7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgfVxuICByZXR1cm4gQ29sbGlzaW9uVGlsZTtcbn0oKSk7XG5tb2R1bGUuZXhwb3J0cyA9IE1hcCA9IChmdW5jdGlvbigpe1xuICBNYXAuZGlzcGxheU5hbWUgPSAnTWFwJztcbiAgdmFyIHByb3RvdHlwZSA9IE1hcC5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gTWFwO1xuICBmdW5jdGlvbiBNYXAoKXtcbiAgICB0aGlzLmJhY2tkcm9wID0gbnVsbDtcbiAgICB0aGlzLnRpbGVzID0gTWFwLmNyZWF0ZU1hdHJpeChuZXcgVGlsZSwgMjAsIDE1KTtcbiAgICB0aGlzLmJnVGlsZXMgPSBNYXAuY3JlYXRlTWF0cml4KG51bGwsIDIwLCAxNSk7XG4gIH1cbiAgcHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKGVsYXBzZWRUaW1lKXtcbiAgICB2YXIgaSQsIHJlZiQsIGxlbiQsIHJvdywgbHJlc3VsdCQsIGokLCBsZW4xJCwgdGlsZSwgcmVmMSQsIHJlc3VsdHMkID0gW107XG4gICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHRoaXMudGlsZXMpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICByb3cgPSByZWYkW2kkXTtcbiAgICAgIGxyZXN1bHQkID0gW107XG4gICAgICBmb3IgKGokID0gMCwgbGVuMSQgPSByb3cubGVuZ3RoOyBqJCA8IGxlbjEkOyArK2okKSB7XG4gICAgICAgIHRpbGUgPSByb3dbaiRdO1xuICAgICAgICBscmVzdWx0JC5wdXNoKChyZWYxJCA9IHRpbGUuc3ByaXRlKSAhPSBudWxsID8gcmVmMSQudXBkYXRlKGVsYXBzZWRUaW1lKSA6IHZvaWQgOCk7XG4gICAgICB9XG4gICAgICByZXN1bHRzJC5wdXNoKGxyZXN1bHQkKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHMkO1xuICB9O1xuICBwcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKGdyYXBoaWNzKXtcbiAgICB2YXIgaSQsIHJlZiQsIGxlbiQsIHksIHJvdywgbHJlc3VsdCQsIGokLCBsZW4xJCwgeCwgdGlsZSwgcmVmMSQsIHJlc3VsdHMkID0gW107XG4gICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHRoaXMudGlsZXMpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICB5ID0gaSQ7XG4gICAgICByb3cgPSByZWYkW2kkXTtcbiAgICAgIGxyZXN1bHQkID0gW107XG4gICAgICBmb3IgKGokID0gMCwgbGVuMSQgPSByb3cubGVuZ3RoOyBqJCA8IGxlbjEkOyArK2okKSB7XG4gICAgICAgIHggPSBqJDtcbiAgICAgICAgdGlsZSA9IHJvd1tqJF07XG4gICAgICAgIGxyZXN1bHQkLnB1c2goKHJlZjEkID0gdGlsZS5zcHJpdGUpICE9IG51bGwgPyByZWYxJC5kcmF3KGdyYXBoaWNzLCB1bml0cy50aWxlVG9HYW1lKHgpLCB1bml0cy50aWxlVG9HYW1lKHkpKSA6IHZvaWQgOCk7XG4gICAgICB9XG4gICAgICByZXN1bHRzJC5wdXNoKGxyZXN1bHQkKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHMkO1xuICB9O1xuICBwcm90b3R5cGUuZHJhd0JhY2tncm91bmQgPSBmdW5jdGlvbihncmFwaGljcyl7XG4gICAgdmFyIGkkLCByZWYkLCBsZW4kLCB5LCByb3csIGxyZXN1bHQkLCBqJCwgbGVuMSQsIHgsIHNwcml0ZSwgcmVzdWx0cyQgPSBbXTtcbiAgICB0aGlzLmJhY2tkcm9wLmRyYXcoZ3JhcGhpY3MpO1xuICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB0aGlzLmJnVGlsZXMpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICB5ID0gaSQ7XG4gICAgICByb3cgPSByZWYkW2kkXTtcbiAgICAgIGxyZXN1bHQkID0gW107XG4gICAgICBmb3IgKGokID0gMCwgbGVuMSQgPSByb3cubGVuZ3RoOyBqJCA8IGxlbjEkOyArK2okKSB7XG4gICAgICAgIHggPSBqJDtcbiAgICAgICAgc3ByaXRlID0gcm93W2okXTtcbiAgICAgICAgbHJlc3VsdCQucHVzaChzcHJpdGUgIT0gbnVsbCA/IHNwcml0ZS5kcmF3KGdyYXBoaWNzLCB1bml0cy50aWxlVG9HYW1lKHgpLCB1bml0cy50aWxlVG9HYW1lKHkpKSA6IHZvaWQgOCk7XG4gICAgICB9XG4gICAgICByZXN1bHRzJC5wdXNoKGxyZXN1bHQkKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHMkO1xuICB9O1xuICBwcm90b3R5cGUuZ2V0Q29sbGlkaW5nVGlsZXMgPSBmdW5jdGlvbihyZWN0KXtcbiAgICB2YXIgZmlyc3RSb3csIGxhc3RSb3csIGZpcnN0Q29sLCBsYXN0Q29sLCBjb2xsaXNpb25UaWxlcywgaSQsIHJvdywgaiQsIGNvbDtcbiAgICBmaXJzdFJvdyA9IGRpdih1bml0cy5nYW1lVG9QeChyZWN0LnRvcCksIHVuaXRzLnRpbGVUb1B4KDEpKTtcbiAgICBsYXN0Um93ID0gZGl2KHVuaXRzLmdhbWVUb1B4KHJlY3QuYm90dG9tKSwgdW5pdHMudGlsZVRvUHgoMSkpO1xuICAgIGZpcnN0Q29sID0gZGl2KHVuaXRzLmdhbWVUb1B4KHJlY3QubGVmdCksIHVuaXRzLnRpbGVUb1B4KDEpKTtcbiAgICBsYXN0Q29sID0gZGl2KHVuaXRzLmdhbWVUb1B4KHJlY3QucmlnaHQpLCB1bml0cy50aWxlVG9QeCgxKSk7XG4gICAgY29sbGlzaW9uVGlsZXMgPSBbXTtcbiAgICBmb3IgKGkkID0gZmlyc3RSb3c7IGkkIDw9IGxhc3RSb3c7ICsraSQpIHtcbiAgICAgIHJvdyA9IGkkO1xuICAgICAgZm9yIChqJCA9IGZpcnN0Q29sOyBqJCA8PSBsYXN0Q29sOyArK2okKSB7XG4gICAgICAgIGNvbCA9IGokO1xuICAgICAgICBjb2xsaXNpb25UaWxlcy5wdXNoKG5ldyBDb2xsaXNpb25UaWxlKHJvdywgY29sLCB0aGlzLnRpbGVzW3Jvd11bY29sXS50eXBlKSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb2xsaXNpb25UaWxlcztcbiAgfTtcbiAgTWFwLmNyZWF0ZVRlc3RNYXAgPSBmdW5jdGlvbihncmFwaGljcyl7XG4gICAgdmFyIG1hcCwgbnVtUm93cywgbnVtQ29scywgcm93LCB0aWxlLCBpJCwgY29sLCBjaGFpblRvcCwgY2hhaW5NaWQsIGNoYWluQnRtO1xuICAgIG1hcCA9IG5ldyBNYXA7XG4gICAgbWFwLmJhY2tkcm9wID0gbmV3IEZpeGVkQmFja2Ryb3AoJ2RhdGEvMTZ4MTYvYmtCbHVlLmJtcCcsIGdyYXBoaWNzKTtcbiAgICBudW1Sb3dzID0gMTU7XG4gICAgbnVtQ29scyA9IDIwO1xuICAgIHJvdyA9IDExO1xuICAgIHRpbGUgPSBuZXcgVGlsZShXQUxMX1RJTEUsIG5ldyBTcHJpdGUoZ3JhcGhpY3MsICdkYXRhLzE2eDE2L1N0YWdlL1BydENhdmUuYm1wJywgdW5pdHMudGlsZVRvUHgoMSksIDAsIHVuaXRzLnRpbGVUb1B4KDEpLCB1bml0cy50aWxlVG9QeCgxKSkpO1xuICAgIGZvciAoaSQgPSAwOyBpJCA8PSBudW1Db2xzOyArK2kkKSB7XG4gICAgICBjb2wgPSBpJDtcbiAgICAgIG1hcC50aWxlc1tyb3ddW2NvbF0gPSB0aWxlO1xuICAgIH1cbiAgICBtYXAudGlsZXNbMTBdWzVdID0gdGlsZTtcbiAgICBtYXAudGlsZXNbOV1bNF0gPSB0aWxlO1xuICAgIG1hcC50aWxlc1s4XVszXSA9IHRpbGU7XG4gICAgbWFwLnRpbGVzWzddWzJdID0gdGlsZTtcbiAgICBtYXAudGlsZXNbMTBdWzNdID0gdGlsZTtcbiAgICBjaGFpblRvcCA9IG5ldyBTcHJpdGUoZ3JhcGhpY3MsICdkYXRhLzE2eDE2L1N0YWdlL1BydENhdmUuYm1wJywgdW5pdHMudGlsZVRvUHgoMTEpLCB1bml0cy50aWxlVG9QeCgyKSwgdW5pdHMudGlsZVRvUHgoMSksIHVuaXRzLnRpbGVUb1B4KDEpKTtcbiAgICBjaGFpbk1pZCA9IG5ldyBTcHJpdGUoZ3JhcGhpY3MsICdkYXRhLzE2eDE2L1N0YWdlL1BydENhdmUuYm1wJywgdW5pdHMudGlsZVRvUHgoMTIpLCB1bml0cy50aWxlVG9QeCgyKSwgdW5pdHMudGlsZVRvUHgoMSksIHVuaXRzLnRpbGVUb1B4KDEpKTtcbiAgICBjaGFpbkJ0bSA9IG5ldyBTcHJpdGUoZ3JhcGhpY3MsICdkYXRhLzE2eDE2L1N0YWdlL1BydENhdmUuYm1wJywgdW5pdHMudGlsZVRvUHgoMTMpLCB1bml0cy50aWxlVG9QeCgyKSwgdW5pdHMudGlsZVRvUHgoMSksIHVuaXRzLnRpbGVUb1B4KDEpKTtcbiAgICBtYXAuYmdUaWxlc1s4XVsyXSA9IGNoYWluVG9wO1xuICAgIG1hcC5iZ1RpbGVzWzldWzJdID0gY2hhaW5NaWQ7XG4gICAgbWFwLmJnVGlsZXNbMTBdWzJdID0gY2hhaW5CdG07XG4gICAgcmV0dXJuIG1hcDtcbiAgfTtcbiAgTWFwLmNyZWF0ZU1hdHJpeCA9IGZ1bmN0aW9uKHZhbHVlLCBjb2xzLCByb3dzKXtcbiAgICB2YXIgaSQsIHksIGxyZXN1bHQkLCBqJCwgeiwgcmVzdWx0cyQgPSBbXTtcbiAgICBmb3IgKGkkID0gMDsgaSQgPD0gcm93czsgKytpJCkge1xuICAgICAgeSA9IGkkO1xuICAgICAgbHJlc3VsdCQgPSBbXTtcbiAgICAgIGZvciAoaiQgPSAwOyBqJCA8PSBjb2xzOyArK2okKSB7XG4gICAgICAgIHogPSBqJDtcbiAgICAgICAgbHJlc3VsdCQucHVzaCh2YWx1ZSk7XG4gICAgICB9XG4gICAgICByZXN1bHRzJC5wdXNoKGxyZXN1bHQkKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHMkO1xuICB9O1xuICBNYXAuV0FMTF9USUxFID0gV0FMTF9USUxFO1xuICBNYXAuQUlSX1RJTEUgPSBBSVJfVElMRTtcbiAgcmV0dXJuIE1hcDtcbn0oKSk7IiwidmFyIHN0ZCwgdW5pdHMsIGNvbmZpZywgcmVhZG91dCwgZ3JhcGhpY3MsIFNwcml0ZSwgQW5pbWF0ZWRTcHJpdGUsIFdBTExfVElMRSwgUmVjdCwga0NoYXJhY3RlckZyYW1lLCBrV2Fsa0ZyYW1lLCBrU3RhbmRGcmFtZSwga0p1bXBGcmFtZSwga0ZhbGxGcmFtZSwga1VwRnJhbWVPZmZzZXQsIGtEb3duRnJhbWUsIGtCYWNrRnJhbWUsIGtXYWxrRnBzLCBrRnJpY3Rpb24sIGtHcmF2aXR5LCBrV2Fsa2luZ0FjY2VsZXJhdGlvbiwga0FpckFjY2VsZXJhdGlvbiwga01heFNwZWVkWCwga01heFNwZWVkWSwga0p1bXBTcGVlZCwga0p1bXBHcmF2aXR5LCBrQ29sbGlzaW9uWCwga0NvbGxpc2lvblksIHJlZiQsIFNUQU5ESU5HLCBXQUxLSU5HLCBKVU1QSU5HLCBGQUxMSU5HLCBJTlRFUkFDVElORywgTEVGVCwgUklHSFQsIFVQLCBET1dOLCBIT1JJWk9OVEFMLCBTcHJpdGVTdGF0ZSwgUGxheWVyLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzLCBzbGljZSQgPSBbXS5zbGljZTtcbnN0ZCA9IHJlcXVpcmUoJ3N0ZCcpO1xudW5pdHMgPSByZXF1aXJlKCcuL3VuaXRzJyk7XG5jb25maWcgPSByZXF1aXJlKCcuL2NvbmZpZycpO1xucmVhZG91dCA9IHJlcXVpcmUoJy4vcmVhZG91dCcpO1xuZ3JhcGhpY3MgPSByZXF1aXJlKCcuL2dyYXBoaWNzJyk7XG5TcHJpdGUgPSByZXF1aXJlKCcuL3Nwcml0ZScpO1xuQW5pbWF0ZWRTcHJpdGUgPSByZXF1aXJlKCcuL2FuaW1hdGVkLXNwcml0ZScpO1xuV0FMTF9USUxFID0gcmVxdWlyZSgnLi9tYXAnKS5XQUxMX1RJTEU7XG5SZWN0ID0gcmVxdWlyZSgnLi9yZWN0YW5nbGUnKS5SZWN0YW5nbGU7XG5rQ2hhcmFjdGVyRnJhbWUgPSAwO1xua1dhbGtGcmFtZSA9IDA7XG5rU3RhbmRGcmFtZSA9IDA7XG5rSnVtcEZyYW1lID0gMTtcbmtGYWxsRnJhbWUgPSAyO1xua1VwRnJhbWVPZmZzZXQgPSAzO1xua0Rvd25GcmFtZSA9IDY7XG5rQmFja0ZyYW1lID0gNztcbmtXYWxrRnBzID0gMTU7XG5rRnJpY3Rpb24gPSAwLjAwMDQ5ODA0Njg3O1xua0dyYXZpdHkgPSAwLjAwMDc4MTI1O1xua1dhbGtpbmdBY2NlbGVyYXRpb24gPSAwLjAwMDgzMDA3ODEyO1xua0FpckFjY2VsZXJhdGlvbiA9IDAuMDAwMzEyNTtcbmtNYXhTcGVlZFggPSAwLjE1ODU5Mzc1O1xua01heFNwZWVkWSA9IDAuMjk5ODA0Njg3NTtcbmtKdW1wU3BlZWQgPSAwLjI1O1xua0p1bXBHcmF2aXR5ID0gMC4wMDAzMTI1O1xua0NvbGxpc2lvblggPSBuZXcgUmVjdCg2LCAxMCwgMjAsIDEyKTtcbmtDb2xsaXNpb25ZID0gbmV3IFJlY3QoMTAsIDIsIDEyLCAzMCk7XG5yZWYkID0gWydTJywgJ1cnLCAnSicsICdGJywgJ0knXSwgU1RBTkRJTkcgPSByZWYkWzBdLCBXQUxLSU5HID0gcmVmJFsxXSwgSlVNUElORyA9IHJlZiRbMl0sIEZBTExJTkcgPSByZWYkWzNdLCBJTlRFUkFDVElORyA9IHJlZiRbNF07XG5yZWYkID0gWydMJywgJ1InXSwgTEVGVCA9IHJlZiRbMF0sIFJJR0hUID0gcmVmJFsxXTtcbnJlZiQgPSBbJ1UnLCAnRCcsICdIJ10sIFVQID0gcmVmJFswXSwgRE9XTiA9IHJlZiRbMV0sIEhPUklaT05UQUwgPSByZWYkWzJdO1xub3V0JC5TcHJpdGVTdGF0ZSA9IFNwcml0ZVN0YXRlID0gKGZ1bmN0aW9uKCl7XG4gIFNwcml0ZVN0YXRlLmRpc3BsYXlOYW1lID0gJ1Nwcml0ZVN0YXRlJztcbiAgdmFyIHByb3RvdHlwZSA9IFNwcml0ZVN0YXRlLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBTcHJpdGVTdGF0ZTtcbiAgZnVuY3Rpb24gU3ByaXRlU3RhdGUobW90aW9uVHlwZSwgaG9yaXpvbnRhbEZhY2luZywgdmVydGljYWxGYWNpbmcpe1xuICAgIHRoaXMubW90aW9uVHlwZSA9IG1vdGlvblR5cGUgIT0gbnVsbCA/IG1vdGlvblR5cGUgOiBTVEFORElORztcbiAgICB0aGlzLmhvcml6b250YWxGYWNpbmcgPSBob3Jpem9udGFsRmFjaW5nICE9IG51bGwgPyBob3Jpem9udGFsRmFjaW5nIDogTEVGVDtcbiAgICB0aGlzLnZlcnRpY2FsRmFjaW5nID0gdmVydGljYWxGYWNpbmcgIT0gbnVsbCA/IHZlcnRpY2FsRmFjaW5nIDogSE9SSVpPTlRBTDtcbiAgfVxuICBwcm90b3R5cGUua2V5ID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gdGhpcy5tb3Rpb25UeXBlICsgXCItXCIgKyB0aGlzLmhvcml6b250YWxGYWNpbmcgKyBcIi1cIiArIHRoaXMudmVydGljYWxGYWNpbmc7XG4gIH07XG4gIFNwcml0ZVN0YXRlLmtleSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3M7XG4gICAgYXJncyA9IHNsaWNlJC5jYWxsKGFyZ3VtZW50cyk7XG4gICAgcmV0dXJuIGFyZ3Muam9pbignLScpO1xuICB9O1xuICByZXR1cm4gU3ByaXRlU3RhdGU7XG59KCkpO1xub3V0JC5QbGF5ZXIgPSBQbGF5ZXIgPSAoZnVuY3Rpb24oKXtcbiAgUGxheWVyLmRpc3BsYXlOYW1lID0gJ1BsYXllcic7XG4gIHZhciBwcm90b3R5cGUgPSBQbGF5ZXIucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IFBsYXllcjtcbiAgZnVuY3Rpb24gUGxheWVyKHgsIHkpe1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICB0aGlzLnZlbG9jaXR5WSA9IDA7XG4gICAgdGhpcy52ZWxvY2l0eVggPSAwO1xuICAgIHRoaXMuYWNjZWxlcmF0aW9uWCA9IDA7XG4gICAgdGhpcy5ob3Jpem9udGFsRmFjaW5nID0gTEVGVDtcbiAgICB0aGlzLnZlcnRpY2FsRmFjaW5nID0gSE9SSVpPTlRBTDtcbiAgICB0aGlzLm9uR3JvdW5kID0gZmFsc2U7XG4gICAgdGhpcy5qdW1wQWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5pbnRlcmFjdGluZyA9IGZhbHNlO1xuICAgIHRoaXMuc3ByaXRlcyA9IHRoaXMuaW5pdGlhbGlzZVNwcml0ZXMoKTtcbiAgICBpZiAoY29uZmlnLmtEZWJ1Z01vZGUpIHtcbiAgICAgIHJlYWRvdXQuYWRkUmVhZGVyKCdzcHJpdGVzdGF0ZScsICdTcHJpdGVTdGF0ZScpO1xuICAgIH1cbiAgfVxuICBwcm90b3R5cGUuaW5pdGlhbGlzZVNwcml0ZSA9IGZ1bmN0aW9uKG1vdGlvbiwgaGZhY2luZywgdmZhY2luZyl7XG4gICAgdmFyIHRpbGVYLCB0aWxlWSwgc291cmNlWDtcbiAgICB0aWxlWCA9IChmdW5jdGlvbigpe1xuICAgICAgc3dpdGNoIChtb3Rpb24pIHtcbiAgICAgIGNhc2UgV0FMS0lORzpcbiAgICAgICAgcmV0dXJuIGtXYWxrRnJhbWU7XG4gICAgICBjYXNlIFNUQU5ESU5HOlxuICAgICAgICByZXR1cm4ga1N0YW5kRnJhbWU7XG4gICAgICBjYXNlIEpVTVBJTkc6XG4gICAgICAgIHJldHVybiBrSnVtcEZyYW1lO1xuICAgICAgY2FzZSBGQUxMSU5HOlxuICAgICAgICByZXR1cm4ga0ZhbGxGcmFtZTtcbiAgICAgIGNhc2UgSU5URVJBQ1RJTkc6XG4gICAgICAgIHJldHVybiBrQmFja0ZyYW1lO1xuICAgICAgfVxuICAgIH0oKSk7XG4gICAgdGlsZVggKz0gdmZhY2luZyA9PT0gVVAgPyBrVXBGcmFtZU9mZnNldCA6IDA7XG4gICAgdGlsZVkgPSBrQ2hhcmFjdGVyRnJhbWUgKyAoaGZhY2luZyA9PT0gTEVGVCA/IDAgOiAxKTtcbiAgICBpZiAobW90aW9uID09PSBXQUxLSU5HKSB7XG4gICAgICByZXR1cm4gbmV3IEFuaW1hdGVkU3ByaXRlKGdyYXBoaWNzLCAnZGF0YS8xNngxNi9NeUNoYXIuYm1wJywgdW5pdHMudGlsZVRvUHgodGlsZVgpLCB1bml0cy50aWxlVG9QeCh0aWxlWSksIHVuaXRzLnRpbGVUb1B4KDEpLCB1bml0cy50aWxlVG9QeCgxKSwga1dhbGtGcHMsIDMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodmZhY2luZyA9PT0gRE9XTiAmJiAobW90aW9uID09PSBKVU1QSU5HIHx8IG1vdGlvbiA9PT0gRkFMTElORykpIHtcbiAgICAgICAgc291cmNlWCA9IGtEb3duRnJhbWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3IFNwcml0ZShncmFwaGljcywgJ2RhdGEvMTZ4MTYvTXlDaGFyLmJtcCcsIHVuaXRzLnRpbGVUb1B4KHRpbGVYKSwgdW5pdHMudGlsZVRvUHgodGlsZVkpLCB1bml0cy50aWxlVG9QeCgxKSwgdW5pdHMudGlsZVRvUHgoMSkpO1xuICAgIH1cbiAgfTtcbiAgcHJvdG90eXBlLmluaXRpYWxpc2VTcHJpdGVzID0gZnVuY3Rpb24oc3ByaXRlTWFwKXtcbiAgICB2YXIgaSQsIHJlZiQsIGxlbiQsIG1vdGlvbiwgaiQsIHJlZjEkLCBsZW4xJCwgaGZhY2luZywgayQsIHJlZjIkLCBsZW4yJCwgdmZhY2luZztcbiAgICBzcHJpdGVNYXAgPT0gbnVsbCAmJiAoc3ByaXRlTWFwID0ge30pO1xuICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSBbU1RBTkRJTkcsIFdBTEtJTkcsIEpVTVBJTkcsIEZBTExJTkcsIElOVEVSQUNUSU5HXSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgIG1vdGlvbiA9IHJlZiRbaSRdO1xuICAgICAgZm9yIChqJCA9IDAsIGxlbjEkID0gKHJlZjEkID0gW0xFRlQsIFJJR0hUXSkubGVuZ3RoOyBqJCA8IGxlbjEkOyArK2okKSB7XG4gICAgICAgIGhmYWNpbmcgPSByZWYxJFtqJF07XG4gICAgICAgIGZvciAoayQgPSAwLCBsZW4yJCA9IChyZWYyJCA9IFtVUCwgRE9XTiwgSE9SSVpPTlRBTF0pLmxlbmd0aDsgayQgPCBsZW4yJDsgKytrJCkge1xuICAgICAgICAgIHZmYWNpbmcgPSByZWYyJFtrJF07XG4gICAgICAgICAgc3ByaXRlTWFwW1Nwcml0ZVN0YXRlLmtleShtb3Rpb24sIGhmYWNpbmcsIHZmYWNpbmcpXSA9IHRoaXMuaW5pdGlhbGlzZVNwcml0ZShtb3Rpb24sIGhmYWNpbmcsIHZmYWNpbmcpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzcHJpdGVNYXA7XG4gIH07XG4gIHByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbihlbGFwc2VkVGltZSwgbWFwKXtcbiAgICB0aGlzLnNwcml0ZXNbdGhpcy5nZXRTcHJpdGVTdGF0ZSgpXS51cGRhdGUoZWxhcHNlZFRpbWUpO1xuICAgIHRoaXMudXBkYXRlWChlbGFwc2VkVGltZSwgbWFwKTtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVZKGVsYXBzZWRUaW1lLCBtYXApO1xuICB9O1xuICBwcm90b3R5cGUudXBkYXRlWCA9IGZ1bmN0aW9uKGVsYXBzZWRUaW1lLCBtYXApe1xuICAgIHZhciBhY2NYLCDOlHg7XG4gICAgYWNjWCA9IHRoaXMub25Hcm91bmQgPyBrV2Fsa2luZ0FjY2VsZXJhdGlvbiA6IGtBaXJBY2NlbGVyYXRpb247XG4gICAgdGhpcy52ZWxvY2l0eVggKz0gdGhpcy5hY2NlbGVyYXRpb25YICogYWNjWCAqIGVsYXBzZWRUaW1lO1xuICAgIGlmICh0aGlzLmFjY2VsZXJhdGlvblggPCAwKSB7XG4gICAgICB0aGlzLnZlbG9jaXR5WCA9IHN0ZC5tYXgodGhpcy52ZWxvY2l0eVgsIC1rTWF4U3BlZWRYKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuYWNjZWxlcmF0aW9uWCA+IDApIHtcbiAgICAgIHRoaXMudmVsb2NpdHlYID0gc3RkLm1pbih0aGlzLnZlbG9jaXR5WCwga01heFNwZWVkWCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLm9uR3JvdW5kKSB7XG4gICAgICB0aGlzLnZlbG9jaXR5WCA9IHRoaXMudmVsb2NpdHlYID4gMFxuICAgICAgICA/IHN0ZC5tYXgoMCwgdGhpcy52ZWxvY2l0eVggLSBrRnJpY3Rpb24gKiBlbGFwc2VkVGltZSlcbiAgICAgICAgOiBzdGQubWluKDAsIHRoaXMudmVsb2NpdHlYICsga0ZyaWN0aW9uICogZWxhcHNlZFRpbWUpO1xuICAgIH1cbiAgICDOlHggPSB0aGlzLnZlbG9jaXR5WCAqIGVsYXBzZWRUaW1lO1xuICAgIGlmICjOlHggPiAwKSB7XG4gICAgICB0aGlzLm9uV2FsbENvbGxpc2lvbihtYXAsIHRoaXMucmlnaHRDb2xsaXNpb24ozpR4KSwgZnVuY3Rpb24odGlsZSl7XG4gICAgICAgIGlmICh0aWxlKSB7XG4gICAgICAgICAgdGhpcy54ID0gdW5pdHMudGlsZVRvR2FtZSh0aWxlLmNvbCkgLSBrQ29sbGlzaW9uWC5yaWdodDtcbiAgICAgICAgICByZXR1cm4gdGhpcy52ZWxvY2l0eVggPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLnggKz0gzpR4O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzLm9uV2FsbENvbGxpc2lvbihtYXAsIHRoaXMubGVmdENvbGxpc2lvbigwKSwgZnVuY3Rpb24odGlsZSl7XG4gICAgICAgIGlmICh0aWxlKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMueCA9IHVuaXRzLnRpbGVUb0dhbWUodGlsZS5jb2wpICsga0NvbGxpc2lvblgucmlnaHQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9uV2FsbENvbGxpc2lvbihtYXAsIHRoaXMubGVmdENvbGxpc2lvbijOlHgpLCBmdW5jdGlvbih0aWxlKXtcbiAgICAgICAgaWYgKHRpbGUpIHtcbiAgICAgICAgICB0aGlzLnggPSB1bml0cy50aWxlVG9HYW1lKHRpbGUuY29sKSArIGtDb2xsaXNpb25YLnJpZ2h0O1xuICAgICAgICAgIHJldHVybiB0aGlzLnZlbG9jaXR5WCA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMueCArPSDOlHg7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXMub25XYWxsQ29sbGlzaW9uKG1hcCwgdGhpcy5yaWdodENvbGxpc2lvbigwKSwgZnVuY3Rpb24odGlsZSl7XG4gICAgICAgIGlmICh0aWxlKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMueCA9IHVuaXRzLnRpbGVUb0dhbWUodGlsZS5jb2wpIC0ga0NvbGxpc2lvblgucmlnaHQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgcHJvdG90eXBlLnVwZGF0ZVkgPSBmdW5jdGlvbihlbGFwc2VkVGltZSwgbWFwKXtcbiAgICB2YXIgZ3Jhdml0eSwgzpR5O1xuICAgIGdyYXZpdHkgPSB0aGlzLmp1bXBBY3RpdmUgJiYgdGhpcy52ZWxvY2l0eVkgPCAwID8ga0p1bXBHcmF2aXR5IDoga0dyYXZpdHk7XG4gICAgdGhpcy52ZWxvY2l0eVkgPSBzdGQubWluKHRoaXMudmVsb2NpdHlZICsgZ3Jhdml0eSAqIGVsYXBzZWRUaW1lLCBrTWF4U3BlZWRZKTtcbiAgICDOlHkgPSB0aGlzLnZlbG9jaXR5WSAqIGVsYXBzZWRUaW1lO1xuICAgIGlmICjOlHkgPiAwKSB7XG4gICAgICB0aGlzLm9uV2FsbENvbGxpc2lvbihtYXAsIHRoaXMuYm90dG9tQ29sbGlzaW9uKM6UeSksIGZ1bmN0aW9uKHRpbGUpe1xuICAgICAgICBpZiAodGlsZSkge1xuICAgICAgICAgIHRoaXMueSA9IHVuaXRzLnRpbGVUb0dhbWUodGlsZS5yb3cpIC0ga0NvbGxpc2lvblkuYm90dG9tO1xuICAgICAgICAgIHRoaXMudmVsb2NpdHlZID0gMDtcbiAgICAgICAgICByZXR1cm4gdGhpcy5vbkdyb3VuZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy55ICs9IM6UeTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5vbkdyb3VuZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzLm9uV2FsbENvbGxpc2lvbihtYXAsIHRoaXMudG9wQ29sbGlzaW9uKDApLCBmdW5jdGlvbih0aWxlKXtcbiAgICAgICAgaWYgKHRpbGUpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy55ID0gdW5pdHMudGlsZVRvR2FtZSh0aWxlLnJvdykgKyBrQ29sbGlzaW9uWS5oO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vbldhbGxDb2xsaXNpb24obWFwLCB0aGlzLnRvcENvbGxpc2lvbijOlHkpLCBmdW5jdGlvbih0aWxlKXtcbiAgICAgICAgaWYgKHRpbGUpIHtcbiAgICAgICAgICB0aGlzLnkgPSB1bml0cy50aWxlVG9HYW1lKHRpbGUucm93KSArIGtDb2xsaXNpb25ZLmg7XG4gICAgICAgICAgcmV0dXJuIHRoaXMudmVsb2NpdHlZID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnkgKz0gzpR5O1xuICAgICAgICAgIHJldHVybiB0aGlzLm9uR3JvdW5kID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXMub25XYWxsQ29sbGlzaW9uKG1hcCwgdGhpcy5ib3R0b21Db2xsaXNpb24oMCksIGZ1bmN0aW9uKHRpbGUpe1xuICAgICAgICBpZiAodGlsZSkge1xuICAgICAgICAgIHRoaXMueSA9IHVuaXRzLnRpbGVUb0dhbWUodGlsZS5yb3cpIC0ga0NvbGxpc2lvblkuYm90dG9tO1xuICAgICAgICAgIHJldHVybiB0aGlzLm9uR3JvdW5kID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuICBwcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKGdyYXBoaWNzKXtcbiAgICByZXR1cm4gdGhpcy5zcHJpdGVzW3RoaXMuZ2V0U3ByaXRlU3RhdGUoKV0uZHJhdyhncmFwaGljcywgdGhpcy54LCB0aGlzLnkpO1xuICB9O1xuICBwcm90b3R5cGUuZ2V0U3ByaXRlU3RhdGUgPSBmdW5jdGlvbigpe1xuICAgIHZhciBtb3Rpb25UeXBlLCBrZXk7XG4gICAgbW90aW9uVHlwZSA9IHRoaXMuaW50ZXJhY3RpbmdcbiAgICAgID8gSU5URVJBQ1RJTkdcbiAgICAgIDogdGhpcy5vbkdyb3VuZFxuICAgICAgICA/IHRoaXMuYWNjZWxlcmF0aW9uWCA9PT0gMCA/IFNUQU5ESU5HIDogV0FMS0lOR1xuICAgICAgICA6IHRoaXMudmVsb2NpdHlZIDwgMCA/IEpVTVBJTkcgOiBGQUxMSU5HO1xuICAgIGtleSA9IFNwcml0ZVN0YXRlLmtleShtb3Rpb25UeXBlLCB0aGlzLmhvcml6b250YWxGYWNpbmcsIHRoaXMudmVydGljYWxGYWNpbmcpO1xuICAgIHJlYWRvdXQudXBkYXRlKCdzcHJpdGVzdGF0ZScsIGtleSk7XG4gICAgcmV0dXJuIGtleTtcbiAgfTtcbiAgcHJvdG90eXBlLmxlZnRDb2xsaXNpb24gPSBmdW5jdGlvbijOlCl7XG4gICAgcmV0dXJuIG5ldyBSZWN0KHRoaXMueCArIGtDb2xsaXNpb25YLmxlZnQgKyDOlCwgdGhpcy55ICsga0NvbGxpc2lvblgudG9wLCBrQ29sbGlzaW9uWC53IC8gMiAtIM6ULCBrQ29sbGlzaW9uWC5oKTtcbiAgfTtcbiAgcHJvdG90eXBlLnJpZ2h0Q29sbGlzaW9uID0gZnVuY3Rpb24ozpQpe1xuICAgIHJldHVybiBuZXcgUmVjdCh0aGlzLnggKyBrQ29sbGlzaW9uWC5sZWZ0ICsga0NvbGxpc2lvblgudyAvIDIsIHRoaXMueSArIGtDb2xsaXNpb25YLnRvcCwga0NvbGxpc2lvblgudyAvIDIgKyDOlCwga0NvbGxpc2lvblguaCk7XG4gIH07XG4gIHByb3RvdHlwZS50b3BDb2xsaXNpb24gPSBmdW5jdGlvbijOlCl7XG4gICAgcmV0dXJuIG5ldyBSZWN0KHRoaXMueCArIGtDb2xsaXNpb25ZLmxlZnQsIHRoaXMueSArIGtDb2xsaXNpb25ZLnRvcCArIM6ULCBrQ29sbGlzaW9uWS53LCBrQ29sbGlzaW9uWS5oIC8gMiAtIM6UKTtcbiAgfTtcbiAgcHJvdG90eXBlLmJvdHRvbUNvbGxpc2lvbiA9IGZ1bmN0aW9uKM6UKXtcbiAgICByZXR1cm4gbmV3IFJlY3QodGhpcy54ICsga0NvbGxpc2lvblkubGVmdCwgdGhpcy55ICsga0NvbGxpc2lvblkudG9wICsga0NvbGxpc2lvblkuaCAvIDIgKyDOlCwga0NvbGxpc2lvblkudywga0NvbGxpc2lvblkuaCAvIDIgKyDOlCk7XG4gIH07XG4gIHByb3RvdHlwZS5vbldhbGxDb2xsaXNpb24gPSBmdW5jdGlvbihtYXAsIHJlY3QsIM67KXtcbiAgICB2YXIgaSQsIHJlZiQsIGxlbiQsIHRpbGU7XG4gICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IG1hcC5nZXRDb2xsaWRpbmdUaWxlcyhyZWN0KSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgIHRpbGUgPSByZWYkW2kkXTtcbiAgICAgIGlmICh0aWxlLnR5cGUgPT09IFdBTExfVElMRSkge1xuICAgICAgICByZXR1cm4gzrsuY2FsbCh0aGlzLCB0aWxlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIM67LmNhbGwodGhpcyk7XG4gIH07XG4gIHByb3RvdHlwZS5zdGFydE1vdmluZ0xlZnQgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuaG9yaXpvbnRhbEZhY2luZyA9IExFRlQ7XG4gICAgdGhpcy5hY2NlbGVyYXRpb25YID0gLTE7XG4gICAgcmV0dXJuIHRoaXMuaW50ZXJhY3RpbmcgPSBmYWxzZTtcbiAgfTtcbiAgcHJvdG90eXBlLnN0YXJ0TW92aW5nUmlnaHQgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuaG9yaXpvbnRhbEZhY2luZyA9IFJJR0hUO1xuICAgIHRoaXMuYWNjZWxlcmF0aW9uWCA9IDE7XG4gICAgcmV0dXJuIHRoaXMuaW50ZXJhY3RpbmcgPSBmYWxzZTtcbiAgfTtcbiAgcHJvdG90eXBlLnN0b3BNb3ZpbmcgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiB0aGlzLmFjY2VsZXJhdGlvblggPSAwO1xuICB9O1xuICBwcm90b3R5cGUuc3RhcnRKdW1wID0gZnVuY3Rpb24oKXtcbiAgICB0aGlzLmp1bXBBY3RpdmUgPSB0cnVlO1xuICAgIHRoaXMuaW50ZXJhY3RpbmcgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5vbkdyb3VuZCkge1xuICAgICAgcmV0dXJuIHRoaXMudmVsb2NpdHlZID0gLWtKdW1wU3BlZWQ7XG4gICAgfVxuICB9O1xuICBwcm90b3R5cGUuc3RvcEp1bXAgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiB0aGlzLmp1bXBBY3RpdmUgPSBmYWxzZTtcbiAgfTtcbiAgcHJvdG90eXBlLmxvb2tVcCA9IGZ1bmN0aW9uKCl7XG4gICAgdGhpcy52ZXJ0aWNhbEZhY2luZyA9IFVQO1xuICAgIHJldHVybiB0aGlzLmludGVyYWN0aW5nID0gZmFsc2U7XG4gIH07XG4gIHByb3RvdHlwZS5sb29rRG93biA9IGZ1bmN0aW9uKCl7XG4gICAgaWYgKHRoaXMudmVydGljYWxGYWNpbmcgPT09IERPV04pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy52ZXJ0aWNhbEZhY2luZyA9IERPV047XG4gICAgcmV0dXJuIHRoaXMuaW50ZXJhY3RpbmcgPSB0aGlzLm9uR3JvdW5kO1xuICB9O1xuICBwcm90b3R5cGUubG9va0hvcml6b250YWwgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiB0aGlzLnZlcnRpY2FsRmFjaW5nID0gSE9SSVpPTlRBTDtcbiAgfTtcbiAgcmV0dXJuIFBsYXllcjtcbn0oKSk7IiwidmFyIGVsbSwgYXBwbHlTdHlsZXMsIFJlYWRlciwgaG9zdCwgcmVhZGVycywgaW5zdGFsbCwgYWRkUmVhZGVyLCB1cGRhdGUsIHJlbW92ZVJlYWRlciwgb3V0JCA9IHR5cGVvZiBleHBvcnRzICE9ICd1bmRlZmluZWQnICYmIGV4cG9ydHMgfHwgdGhpcztcbmVsbSA9IGJpbmQkKGRvY3VtZW50LCAnY3JlYXRlRWxlbWVudCcpO1xuYXBwbHlTdHlsZXMgPSBmdW5jdGlvbihlbCwgc3R5bGVzKXtcbiAgdmFyIGssIHYsIHJlc3VsdHMkID0gW107XG4gIGZvciAoayBpbiBzdHlsZXMpIHtcbiAgICB2ID0gc3R5bGVzW2tdO1xuICAgIHJlc3VsdHMkLnB1c2goZWwuc3R5bGVba10gPSB2KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59O1xuUmVhZGVyID0gKGZ1bmN0aW9uKCl7XG4gIFJlYWRlci5kaXNwbGF5TmFtZSA9ICdSZWFkZXInO1xuICB2YXIgcHJvdG90eXBlID0gUmVhZGVyLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBSZWFkZXI7XG4gIGZ1bmN0aW9uIFJlYWRlcihuYW1lLCBsYWJlbFRleHQsIHZhbHVlKXtcbiAgICB2YXIgdGhhdDtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMubGFiZWxUZXh0ID0gbGFiZWxUZXh0O1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLmRvbSA9IGVsbSgndHInKTtcbiAgICB0aGlzLmxhYmVsID0gZWxtKCd0ZCcpO1xuICAgIHRoaXMub3V0cHV0ID0gZWxtKCd0ZCcpO1xuICAgIHRoaXMuZG9tLmFwcGVuZENoaWxkKHRoaXMubGFiZWwpO1xuICAgIHRoaXMuZG9tLmFwcGVuZENoaWxkKHRoaXMub3V0cHV0KTtcbiAgICB0aGlzLmxhYmVsLmlubmVySFRNTCA9IHRoaXMubGFiZWxUZXh0O1xuICAgIGlmICh0aGF0ID0gdGhpcy52YWx1ZSkge1xuICAgICAgdGhpcy5vdXRwdXQuaW5uZXJIVE1MID0gdGhhdDtcbiAgICB9XG4gIH1cbiAgcHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgcmV0dXJuIHRoaXMub3V0cHV0LmlubmVySFRNTCA9IHRoaXMudmFsdWU7XG4gIH07XG4gIHByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gdGhpcy5kb20uc3R5bGVzLmRpc3BsYXkgPSAnbm9uZSc7XG4gIH07XG4gIHByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gdGhpcy5kb20uc3R5bGVzLmRpc3BsYXkgPSAnYmxvY2snO1xuICB9O1xuICBwcm90b3R5cGUuaW5zdGFsbCA9IGZ1bmN0aW9uKGhvc3Qpe1xuICAgIHJldHVybiBob3N0LmFwcGVuZENoaWxkKHRoaXMuZG9tKTtcbiAgfTtcbiAgcHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuZG9tLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5kb20pO1xuICB9O1xuICByZXR1cm4gUmVhZGVyO1xufSgpKTtcbmhvc3QgPSBlbG0oJ3RhYmxlJyk7XG5yZWFkZXJzID0ge307XG5hcHBseVN0eWxlcyhob3N0LCB7XG4gIGZvbnRGYW1pbHk6ICdtb25vc3BhY2UnLFxuICB3aWR0aDogJzEwMCUnLFxuICBwYWRkaW5nTGVmdDogJzEwcHgnLFxuICBjb2xvcjogJ2xpZ2h0Z3JleScsXG4gIGJvcmRlcldpZHRoOiBcIjNweCAxcHhcIlxufSk7XG5vdXQkLmluc3RhbGwgPSBpbnN0YWxsID0gZnVuY3Rpb24oKXtcbiAgcmV0dXJuIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaG9zdCk7XG59O1xub3V0JC5hZGRSZWFkZXIgPSBhZGRSZWFkZXIgPSBmdW5jdGlvbihuYW1lLCBsYWJlbCwgdmFsdWUpe1xuICByZWFkZXJzW25hbWVdID0gbmV3IFJlYWRlcihuYW1lLCBsYWJlbCwgdmFsdWUpO1xuICByZXR1cm4gcmVhZGVyc1tuYW1lXS5pbnN0YWxsKGhvc3QpO1xufTtcbm91dCQudXBkYXRlID0gdXBkYXRlID0gZnVuY3Rpb24ocmVhZGVyTmFtZSwgdmFsdWUpe1xuICB2YXIgcmVmJDtcbiAgcmV0dXJuIChyZWYkID0gcmVhZGVyc1tyZWFkZXJOYW1lXSkgIT0gbnVsbCA/IHJlZiQudXBkYXRlKHZhbHVlKSA6IHZvaWQgODtcbn07XG5vdXQkLnJlbW92ZVJlYWRlciA9IHJlbW92ZVJlYWRlciA9IGZ1bmN0aW9uKG5hbWUpe1xuICB2YXIgcmVmJDtcbiAgcmVhZGVyc1tuYW1lXVsnZGVsZXRlJ10oKTtcbiAgcmV0dXJuIHJlZiQgPSByZWFkZXJzW25hbWVdLCBkZWxldGUgcmVhZGVyc1tuYW1lXSwgcmVmJDtcbn07XG5mdW5jdGlvbiBiaW5kJChvYmosIGtleSwgdGFyZ2V0KXtcbiAgcmV0dXJuIGZ1bmN0aW9uKCl7IHJldHVybiAodGFyZ2V0IHx8IG9iailba2V5XS5hcHBseShvYmosIGFyZ3VtZW50cykgfTtcbn0iLCJ2YXIgUmVjdGFuZ2xlLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xub3V0JC5SZWN0YW5nbGUgPSBSZWN0YW5nbGUgPSAoZnVuY3Rpb24oKXtcbiAgUmVjdGFuZ2xlLmRpc3BsYXlOYW1lID0gJ1JlY3RhbmdsZSc7XG4gIHZhciBwcm90b3R5cGUgPSBSZWN0YW5nbGUucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IFJlY3RhbmdsZTtcbiAgZnVuY3Rpb24gUmVjdGFuZ2xlKHgsIHksIHcsIGgsIG0pe1xuICAgIG0gPT0gbnVsbCAmJiAobSA9IDEpO1xuICAgIHRoaXMueCA9IHggKiBtO1xuICAgIHRoaXMueSA9IHkgKiBtO1xuICAgIHRoaXMudyA9IHcgKiBtO1xuICAgIHRoaXMuaCA9IGggKiBtO1xuICAgIHRoaXMudG9wID0gdGhpcy55O1xuICAgIHRoaXMubGVmdCA9IHRoaXMueDtcbiAgICB0aGlzLnJpZ2h0ID0gdGhpcy54ICsgdGhpcy53O1xuICAgIHRoaXMuYm90dG9tID0gdGhpcy55ICsgdGhpcy5oO1xuICB9XG4gIHJldHVybiBSZWN0YW5nbGU7XG59KCkpOyIsInZhciByYWYsIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXM7XG5yYWYgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG5pbXBvcnQkKG91dCQsIHtcbiAgZGVsYXk6IGZ1bmN0aW9uKHRpbWUsIM67KXtcbiAgICByZXR1cm4gcmFmKM67KTtcbiAgfVxufSk7XG5mdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgdmFyIG93biA9IHt9Lmhhc093blByb3BlcnR5O1xuICBmb3IgKHZhciBrZXkgaW4gc3JjKSBpZiAob3duLmNhbGwoc3JjLCBrZXkpKSBvYmpba2V5XSA9IHNyY1trZXldO1xuICByZXR1cm4gb2JqO1xufSIsInZhciBzdGQsIHF1ZXVlLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuc3RkID0gcmVxdWlyZSgnc3RkJyk7XG5xdWV1ZSA9IFtdO1xuaW1wb3J0JChvdXQkLCB7XG4gIHB1c2hFdmVudDogZnVuY3Rpb24oZXZlbnQpe1xuICAgIHJldHVybiBxdWV1ZS5wdXNoKGV2ZW50KTtcbiAgfSxcbiAgcG9sbEV2ZW50OiBmdW5jdGlvbigpe1xuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBxdWV1ZS5zaGlmdCgpO1xuICAgIH1cbiAgfVxufSk7XG5mdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgdmFyIG93biA9IHt9Lmhhc093blByb3BlcnR5O1xuICBmb3IgKHZhciBrZXkgaW4gc3JjKSBpZiAob3duLmNhbGwoc3JjLCBrZXkpKSBvYmpba2V5XSA9IHNyY1trZXldO1xuICByZXR1cm4gb2JqO1xufSIsInZhciBzdGQsIGRlbGF5LCB0aW1lciwgc2NyZWVuLCBrZXlib2FyZCwgZXZlbnRRdWV1ZSwgUmVjdCwgU3VyZmFjZSwgcmVmJCwgSU5JVF9FVkVSWVRISU5HLCBGVUxMU0NSRUVOLCBpbml0LCBLRVksIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXM7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcbmRlbGF5ID0gcmVxdWlyZSgnLi9kZWxheScpO1xudGltZXIgPSByZXF1aXJlKCcuL3RpbWVyJyk7XG5zY3JlZW4gPSByZXF1aXJlKCcuL3NjcmVlbicpO1xua2V5Ym9hcmQgPSByZXF1aXJlKCcuL2tleWJvYXJkJyk7XG5ldmVudFF1ZXVlID0gcmVxdWlyZSgnLi9ldmVudC1xdWV1ZScpO1xub3V0JC5SZWN0ID0gUmVjdCA9IHJlcXVpcmUoJy4vcmVjdCcpO1xub3V0JC5TdXJmYWNlID0gU3VyZmFjZSA9IHJlcXVpcmUoJy4vc3VyZmFjZScpO1xucmVmJCA9IHN0ZFsnZW51bSddLCBJTklUX0VWRVJZVEhJTkcgPSByZWYkWzBdLCBGVUxMU0NSRUVOID0gcmVmJFsxXTtcbm91dCQuaW5pdCA9IGluaXQgPSBmdW5jdGlvbihtb2RlKXtcbiAgc3RkLmxvZyhcIlNETDo6SW5pdCAtIHdpdGggbW9kZTpcIiwgbW9kZSk7XG4gIHRpbWVyLmluaXQoKTtcbiAgcmV0dXJuIGtleWJvYXJkLmluaXQoKTtcbn07XG5vdXQkLklOSVRfRVZFUllUSElORyA9IElOSVRfRVZFUllUSElORztcbm91dCQuRlVMTFNDUkVFTiA9IEZVTExTQ1JFRU47XG5vdXQkLktFWURPV04gPSBrZXlib2FyZC5LRVlET1dOO1xub3V0JC5LRVlVUCA9IGtleWJvYXJkLktFWVVQO1xub3V0JC5LRVkgPSBLRVkgPSBrZXlib2FyZC5LRVlDT0RFUztcbm91dCQuZGVsYXkgPSBkZWxheS5kZWxheTtcbm91dCQuZ2V0VGlja3MgPSB0aW1lci5nZXRUaWNrcztcbm91dCQucG9sbEV2ZW50ID0gZXZlbnRRdWV1ZS5wb2xsRXZlbnQ7XG5vdXQkLnNldFZpZGVvTW9kZSA9IHNjcmVlbi5zZXRWaWRlb01vZGU7XG5vdXQkLmJsaXRTdXJmYWNlID0gU3VyZmFjZS5ibGl0U3VyZmFjZTtcbm91dCQuc2V0Q29sb3JLZXkgPSBTdXJmYWNlLnNldENvbG9yS2V5O1xub3V0JC5sb2FkSW1hZ2UgPSBTdXJmYWNlLmxvYWRJbWFnZTsiLCJ2YXIgc3RkLCBxdWV1ZSwgcmVmJCwgS0VZRE9XTiwgS0VZVVAsIEtFWUNPREVTLCBtb25pdG9yS2V5cywgaW5pdCwgb3V0JCA9IHR5cGVvZiBleHBvcnRzICE9ICd1bmRlZmluZWQnICYmIGV4cG9ydHMgfHwgdGhpcztcbnN0ZCA9IHJlcXVpcmUoJ3N0ZCcpO1xucXVldWUgPSByZXF1aXJlKCcuL2V2ZW50LXF1ZXVlJyk7XG5yZWYkID0gc3RkWydlbnVtJ10sIEtFWURPV04gPSByZWYkWzBdLCBLRVlVUCA9IHJlZiRbMV07XG5vdXQkLktFWUNPREVTID0gS0VZQ09ERVMgPSB7XG4gIEVTQ0FQRTogMjcsXG4gIExFRlQ6IDM3LFxuICBVUDogMzgsXG4gIFJJR0hUOiAzOSxcbiAgRE9XTjogNDAsXG4gIEE6IDY1LFxuICBROiA4MSxcbiAgUzogODMsXG4gIFc6IDg3LFxuICBYOiA4OCxcbiAgWjogOTBcbn07XG5tb25pdG9yS2V5cyA9IGZ1bmN0aW9uKCl7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihhcmckKXtcbiAgICB2YXIgd2hpY2g7XG4gICAgd2hpY2ggPSBhcmckLndoaWNoO1xuICAgIHF1ZXVlLnB1c2hFdmVudCh7XG4gICAgICB0eXBlOiBLRVlET1dOLFxuICAgICAga2V5OiB3aGljaFxuICAgIH0pO1xuICAgIHJldHVybiBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9KTtcbiAgcmV0dXJuIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oYXJnJCl7XG4gICAgdmFyIHdoaWNoO1xuICAgIHdoaWNoID0gYXJnJC53aGljaDtcbiAgICBxdWV1ZS5wdXNoRXZlbnQoe1xuICAgICAgdHlwZTogS0VZVVAsXG4gICAgICBrZXk6IHdoaWNoXG4gICAgfSk7XG4gICAgcmV0dXJuIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH0pO1xufTtcbm91dCQuaW5pdCA9IGluaXQgPSBmdW5jdGlvbigpe1xuICBzdGQubG9nKFwiU0RMOjpLZXlib2FyZCAtIE1vbml0b3Jpbmcga2V5IGlucHV0XCIpO1xuICByZXR1cm4gbW9uaXRvcktleXMoKTtcbn07XG5vdXQkLktFWURPV04gPSBLRVlET1dOO1xub3V0JC5LRVlVUCA9IEtFWVVQOyIsInZhciBSZWN0O1xubW9kdWxlLmV4cG9ydHMgPSBSZWN0ID0gKGZ1bmN0aW9uKCl7XG4gIFJlY3QuZGlzcGxheU5hbWUgPSAnUmVjdCc7XG4gIHZhciBwcm90b3R5cGUgPSBSZWN0LnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBSZWN0O1xuICBmdW5jdGlvbiBSZWN0KHgsIHksIHcsIGgpe1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICB0aGlzLncgPSB3O1xuICAgIHRoaXMuaCA9IGg7XG4gIH1cbiAgcmV0dXJuIFJlY3Q7XG59KCkpOyIsInZhciBzdGQsIFN1cmZhY2UsIGFwcGx5U2NhbGVTdHlsZXMsIGNyZWF0ZU5ld1NjcmVlbiwgc2V0VmlkZW9Nb2RlLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuc3RkID0gcmVxdWlyZSgnc3RkJyk7XG5TdXJmYWNlID0gcmVxdWlyZSgnLi9zdXJmYWNlJyk7XG5hcHBseVNjYWxlU3R5bGVzID0gZnVuY3Rpb24oY2FudmFzLCBzY2FsZUZhY3Rvcil7XG4gIGlmIChzY2FsZUZhY3RvciAhPT0gMCkge1xuICAgIHJldHVybiBjYW52YXMuc3R5bGUud2lkdGggPSBjYW52YXMud2lkdGggKiBzY2FsZUZhY3RvciArICdweCc7XG4gIH1cbn07XG5jcmVhdGVOZXdTY3JlZW4gPSBmdW5jdGlvbih3LCBoLCBzY2FsZUZhY3Rvcil7XG4gIHZhciBzY3JlZW47XG4gIHNjcmVlbiA9IG5ldyBTdXJmYWNlKG51bGwsIHcsIGgpO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmVlbi5jYW52YXMpO1xuICBhcHBseVNjYWxlU3R5bGVzKHNjcmVlbi5jYW52YXMsIHNjYWxlRmFjdG9yKTtcbiAgcmV0dXJuIHNjcmVlbjtcbn07XG5vdXQkLnNldFZpZGVvTW9kZSA9IHNldFZpZGVvTW9kZSA9IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQsIHNjYWxlRmFjdG9yKXtcbiAgc2NhbGVGYWN0b3IgPT0gbnVsbCAmJiAoc2NhbGVGYWN0b3IgPSAxKTtcbiAgcmV0dXJuIGNyZWF0ZU5ld1NjcmVlbih3aWR0aCwgaGVpZ2h0LCBzY2FsZUZhY3Rvcik7XG59OyIsInZhciBzdGQsIFJlY3QsIG1ha2VUcmFuc3BhcmVudCwgU3VyZmFjZTtcbnN0ZCA9IHJlcXVpcmUoJ3N0ZCcpO1xuUmVjdCA9IHJlcXVpcmUoJy4vcmVjdCcpO1xubWFrZVRyYW5zcGFyZW50ID0gZnVuY3Rpb24oZGF0YSwgY29sb3Ipe1xuICB2YXIgY2FudmFzLCBjb250ZXh0LCBwaXhlbHMsIGkkLCB0byQsIGk7XG4gIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICBjYW52YXMud2lkdGggPSBkYXRhLndpZHRoO1xuICBjYW52YXMuaGVpZ2h0ID0gZGF0YS5oZWlnaHQ7XG4gIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgY29udGV4dC5kcmF3SW1hZ2UoZGF0YSwgMCwgMCk7XG4gIHBpeGVscyA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG4gIGZvciAoaSQgPSAwLCB0byQgPSBwaXhlbHMuZGF0YS5sZW5ndGg7IGkkIDw9IHRvJDsgaSQgKz0gNCkge1xuICAgIGkgPSBpJDtcbiAgICBpZiAocGl4ZWxzLmRhdGFbaSArIDBdID09PSBjb2xvclswXSAmJiBwaXhlbHMuZGF0YVtpICsgMV0gPT09IGNvbG9yWzFdICYmIHBpeGVscy5kYXRhW2kgKyAyXSA9PT0gY29sb3JbMl0pIHtcbiAgICAgIHBpeGVscy5kYXRhW2kgKyAzXSA9IDA7XG4gICAgfVxuICB9XG4gIGNvbnRleHQucHV0SW1hZ2VEYXRhKHBpeGVscywgMCwgMCk7XG4gIHJldHVybiBjYW52YXM7XG59O1xubW9kdWxlLmV4cG9ydHMgPSBTdXJmYWNlID0gKGZ1bmN0aW9uKCl7XG4gIFN1cmZhY2UuZGlzcGxheU5hbWUgPSAnU3VyZmFjZSc7XG4gIHZhciBwcm90b3R5cGUgPSBTdXJmYWNlLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBTdXJmYWNlO1xuICBmdW5jdGlvbiBTdXJmYWNlKHNyYywgd2lkdGgsIGhlaWdodCl7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB0aGlzLmNvbG9yS2V5ID0gbnVsbDtcbiAgICB0aGlzLnJlc2V0Q2FudmFzU2l6ZSgpO1xuICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9ICdyZWQnO1xuICAgIHRoaXMuY3R4LmZpbGxSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcbiAgICBpZiAodHlwZW9mIHNyYyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMubG9hZEltYWdlRGF0YShzcmMpO1xuICAgIH0gZWxzZSBpZiAoc3JjICE9IG51bGwpIHtcbiAgICAgIHRoaXMuc2F2ZUltYWdlRGF0YShzcmMpO1xuICAgIH0gZWxzZSB7fVxuICB9XG4gIHByb3RvdHlwZS5yZXNldENhbnZhc1NpemUgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy53aWR0aDtcbiAgICByZXR1cm4gdGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG4gIH07XG4gIHByb3RvdHlwZS5pbmhlcml0U2l6ZUZyb21JbWFnZSA9IGZ1bmN0aW9uKGRhdGEpe1xuICAgIGlmICh0aGlzLndpZHRoID09IG51bGwgJiYgdGhpcy5oZWlnaHQgPT0gbnVsbCkge1xuICAgICAgdGhpcy53aWR0aCA9IGRhdGEubmF0dXJhbFdpZHRoO1xuICAgICAgdGhpcy5oZWlnaHQgPSBkYXRhLm5hdHVyYWxIZWlnaHQ7XG4gICAgICByZXR1cm4gdGhpcy5yZXNldENhbnZhc1NpemUoKTtcbiAgICB9XG4gIH07XG4gIHByb3RvdHlwZS5sb2FkSW1hZ2VEYXRhID0gZnVuY3Rpb24ocGF0aCl7XG4gICAgdmFyIGRhdGEsIHRoaXMkID0gdGhpcztcbiAgICBkYXRhID0gbmV3IEltYWdlO1xuICAgIGRhdGEub25sb2FkID0gZnVuY3Rpb24oKXtcbiAgICAgIHRoaXMkLmluaGVyaXRTaXplRnJvbUltYWdlKGRhdGEpO1xuICAgICAgcmV0dXJuIHRoaXMkLnNhdmVJbWFnZURhdGEoZGF0YSk7XG4gICAgfTtcbiAgICBkYXRhLm9uZXJyb3IgPSBmdW5jdGlvbigpe1xuICAgICAgc3RkLmxvZyhcIkNhbnQgbG9hZDpcIiwgcGF0aCk7XG4gICAgICByZXR1cm4gdGhpcyQuY3R4LmZpbGxSZWN0KDAsIDAsIHRoaXMkLndpZHRoLCB0aGlzJC5oZWlnaHQpO1xuICAgIH07XG4gICAgcmV0dXJuIGRhdGEuc3JjID0gcGF0aDtcbiAgfTtcbiAgcHJvdG90eXBlLnNhdmVJbWFnZURhdGEgPSBmdW5jdGlvbihkYXRhKXtcbiAgICB0aGlzLmRhdGEgPSB0aGlzLmNvbG9yS2V5ID8gbWFrZVRyYW5zcGFyZW50KGRhdGEsIHRoaXMuY29sb3JLZXkpIDogZGF0YTtcbiAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcbiAgICB0aGlzLmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuICAgIHJldHVybiB0aGlzLmN0eC5kcmF3SW1hZ2UodGhpcy5kYXRhLCAwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gIH07XG4gIHByb3RvdHlwZS5zZXRDb2xvcktleSA9IGZ1bmN0aW9uKGNvbG9yKXtcbiAgICB0aGlzLmNvbG9yS2V5ID0gY29sb3I7XG4gICAgaWYgKHRoaXMucmVhZHkpIHtcbiAgICAgIHJldHVybiB0aGlzLnNhdmVJbWFnZURhdGEodGhpcy5kYXRhKTtcbiAgICB9XG4gIH07XG4gIHByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gIH07XG4gIFN1cmZhY2Uuc2V0Q29sb3JLZXkgPSBmdW5jdGlvbihzdXJmYWNlLCBjb2xvcil7XG4gICAgcmV0dXJuIHN1cmZhY2Uuc2V0Q29sb3JLZXkoY29sb3IpO1xuICB9O1xuICBTdXJmYWNlLmJsaXRTdXJmYWNlID0gZnVuY3Rpb24oc291cmNlLCBzcmNSZWN0LCBkZXN0LCBkZXN0UmVjdCl7XG4gICAgaWYgKHNyY1JlY3QpIHtcbiAgICAgIHJldHVybiBkZXN0LmN0eC5kcmF3SW1hZ2Uoc291cmNlLmNhbnZhcywgc3JjUmVjdC54LCBzcmNSZWN0LnksIHNyY1JlY3Qudywgc3JjUmVjdC5oLCBkZXN0UmVjdC54LCBkZXN0UmVjdC55LCBkZXN0UmVjdC53LCBkZXN0UmVjdC5oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGRlc3QuY3R4LmRyYXdJbWFnZShzb3VyY2UuY2FudmFzLCBkZXN0UmVjdC54LCBkZXN0UmVjdC55LCBkZXN0UmVjdC53LCBkZXN0UmVjdC5oKTtcbiAgICB9XG4gIH07XG4gIFN1cmZhY2UubG9hZEltYWdlID0gZnVuY3Rpb24ocGF0aCl7XG4gICAgcmV0dXJuIG5ldyBTdXJmYWNlKHBhdGgpO1xuICB9O1xuICByZXR1cm4gU3VyZmFjZTtcbn0oKSk7IiwidmFyIHN0YXJ0VGltZSwgb3V0JCA9IHR5cGVvZiBleHBvcnRzICE9ICd1bmRlZmluZWQnICYmIGV4cG9ydHMgfHwgdGhpcztcbnN0YXJ0VGltZSA9IDA7XG5pbXBvcnQkKG91dCQsIHtcbiAgaW5pdDogZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgfSxcbiAgZ2V0VGlja3M6IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gIH1cbn0pO1xuZnVuY3Rpb24gaW1wb3J0JChvYmosIHNyYyl7XG4gIHZhciBvd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgcmV0dXJuIG9iajtcbn0iLCJ2YXIgU0RMLCBzdGQsIHVuaXRzLCBTcHJpdGU7XG5TREwgPSByZXF1aXJlKCdTREwnKTtcbnN0ZCA9IHJlcXVpcmUoJ3N0ZCcpO1xudW5pdHMgPSByZXF1aXJlKCcuL3VuaXRzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IFNwcml0ZSA9IChmdW5jdGlvbigpe1xuICBTcHJpdGUuZGlzcGxheU5hbWUgPSAnU3ByaXRlJztcbiAgdmFyIHByb3RvdHlwZSA9IFNwcml0ZS5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gU3ByaXRlO1xuICBmdW5jdGlvbiBTcHJpdGUoZ3JhcGhpY3MsIHBhdGgsIHNvdXJjZVgsIHNvdXJjZVksIHdpZHRoLCBoZWlnaHQpe1xuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICB0aGlzLnNvdXJjZVJlY3QgPSBuZXcgU0RMLlJlY3Qoc291cmNlWCwgc291cmNlWSwgd2lkdGgsIGhlaWdodCk7XG4gICAgdGhpcy5zcHJpdGVTaGVldCA9IGdyYXBoaWNzLmxvYWRJbWFnZShwYXRoLCB0cnVlKTtcbiAgfVxuICBwcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKXt9O1xuICBwcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKGdyYXBoaWNzLCB4LCB5KXtcbiAgICB2YXIgZGVzdFJlY3Q7XG4gICAgZGVzdFJlY3QgPSBuZXcgU0RMLlJlY3QodW5pdHMuZ2FtZVRvUHgoeCksIHVuaXRzLmdhbWVUb1B4KHkpLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gICAgcmV0dXJuIGdyYXBoaWNzLmJsaXRTdXJmYWNlKHRoaXMuc3ByaXRlU2hlZXQsIHRoaXMuc291cmNlUmVjdCwgZGVzdFJlY3QpO1xuICB9O1xuICByZXR1cm4gU3ByaXRlO1xufSgpKTsiLCJ2YXIgcmVmJCwgaWQsIG1hcCwgZmlsdGVyLCBhbnksIGRpdiwgbG9nLCBpbmZvLCBvYmpNYXAsIGZsaXAsIGRlbGF5LCByb3VuZCwgZmxvb3IsIGFicywgbWF4LCBtaW4sIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXM7XG5yZWYkID0gcmVxdWlyZSgncHJlbHVkZS1scycpLCBpZCA9IHJlZiQuaWQsIG1hcCA9IHJlZiQubWFwLCBmaWx0ZXIgPSByZWYkLmZpbHRlciwgYW55ID0gcmVmJC5hbnksIGRpdiA9IHJlZiQuZGl2O1xub3V0JC5sb2cgPSBsb2cgPSBmdW5jdGlvbigpe1xuICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpO1xuICByZXR1cm4gYXJndW1lbnRzWzBdO1xufTtcbm91dCQuaW5mbyA9IGluZm8gPSBmdW5jdGlvbigpe1xuICBjb25zb2xlLmluZm8uYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcbiAgcmV0dXJuIGFyZ3VtZW50c1swXTtcbn07XG5vdXQkLm9iak1hcCA9IG9iak1hcCA9IGN1cnJ5JChmdW5jdGlvbijOuywgbyl7XG4gIHZhciBrLCB2LCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGsgaW4gbykge1xuICAgIHYgPSBvW2tdO1xuICAgIHJlc3VsdHMkLnB1c2gozrsoaywgdikpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xub3V0JC5mbGlwID0gZmxpcCA9IGZ1bmN0aW9uKM67KXtcbiAgcmV0dXJuIGN1cnJ5JChmdW5jdGlvbihhLCBiKXtcbiAgICByZXR1cm4gzrsoYiwgYSk7XG4gIH0pO1xufTtcbm91dCQuZGVsYXkgPSBkZWxheSA9IGZsaXAoc2V0VGltZW91dCk7XG5vdXQkLnJvdW5kID0gcm91bmQgPSBNYXRoLnJvdW5kO1xub3V0JC5mbG9vciA9IGZsb29yID0gTWF0aC5mbG9vcjtcbm91dCQuYWJzID0gYWJzID0gTWF0aC5hYnM7XG5vdXQkLm1heCA9IG1heCA9IE1hdGgubWF4O1xub3V0JC5taW4gPSBtaW4gPSBNYXRoLm1pbjtcbnJlZiQgPSBvdXQkO1xucmVmJC5pZCA9IGlkO1xucmVmJC5hbnkgPSBhbnk7XG5yZWYkLm1hcCA9IG1hcDtcbnJlZiQuZmlsdGVyID0gZmlsdGVyO1xucmVmJC5kaXYgPSBkaXY7XG5yZWYkWydlbnVtJ10gPSBbMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTksIDIwXTtcbmZ1bmN0aW9uIGN1cnJ5JChmLCBib3VuZCl7XG4gIHZhciBjb250ZXh0LFxuICBfY3VycnkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIGYubGVuZ3RoID4gMSA/IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGFyYW1zID0gYXJncyA/IGFyZ3MuY29uY2F0KCkgOiBbXTtcbiAgICAgIGNvbnRleHQgPSBib3VuZCA/IGNvbnRleHQgfHwgdGhpcyA6IHRoaXM7XG4gICAgICByZXR1cm4gcGFyYW1zLnB1c2guYXBwbHkocGFyYW1zLCBhcmd1bWVudHMpIDxcbiAgICAgICAgICBmLmxlbmd0aCAmJiBhcmd1bWVudHMubGVuZ3RoID9cbiAgICAgICAgX2N1cnJ5LmNhbGwoY29udGV4dCwgcGFyYW1zKSA6IGYuYXBwbHkoY29udGV4dCwgcGFyYW1zKTtcbiAgICB9IDogZjtcbiAgfTtcbiAgcmV0dXJuIF9jdXJyeSgpO1xufSIsInZhciBzdGQsIGNvbmZpZywga1RpbGVTaXplLCBHYW1lLCBQaXhlbCwgVGlsZSwgRlBTLCBNUywgVmVsb2NpdHksIEFjY2VsZXJhdGlvbiwgZ2FtZVRvUHgsIGdhbWVUb1RpbGUsIHRpbGVUb0dhbWUsIHRpbGVUb1B4LCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuc3RkID0gcmVxdWlyZSgnc3RkJyk7XG5jb25maWcgPSByZXF1aXJlKCcuL2NvbmZpZycpO1xua1RpbGVTaXplID0gMzI7XG5vdXQkLkdhbWUgPSBHYW1lID0gc3RkLmlkO1xub3V0JC5QaXhlbCA9IFBpeGVsID0gc3RkLmZsb29yO1xub3V0JC5UaWxlID0gVGlsZSA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiBzdGQuYWJzKHN0ZC5mbG9vci5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbn07XG5vdXQkLkZQUyA9IEZQUyA9IHN0ZC5pZDtcbm91dCQuTVMgPSBNUyA9IHN0ZC5pZDtcbm91dCQuVmVsb2NpdHkgPSBWZWxvY2l0eSA9IHN0ZC5pZDtcbm91dCQuQWNjZWxlcmF0aW9uID0gQWNjZWxlcmF0aW9uID0gc3RkLmlkO1xub3V0JC5nYW1lVG9QeCA9IGdhbWVUb1B4ID0gZnVuY3Rpb24oKXtcbiAgcmV0dXJuIFBpeGVsKChmdW5jdGlvbihpdCl7XG4gICAgcmV0dXJuIGl0IC8gMjtcbiAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG59O1xub3V0JC5nYW1lVG9UaWxlID0gZ2FtZVRvVGlsZSA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiBUaWxlKChmdW5jdGlvbihpdCl7XG4gICAgcmV0dXJuIGl0IC8ga1RpbGVTaXplO1xuICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbn07XG5vdXQkLnRpbGVUb0dhbWUgPSB0aWxlVG9HYW1lID0gKGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGl0ICoga1RpbGVTaXplO1xufSk7XG5vdXQkLnRpbGVUb1B4ID0gdGlsZVRvUHggPSBmdW5jdGlvbigpe1xuICByZXR1cm4gZ2FtZVRvUHgodGlsZVRvR2FtZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbn07Il19
