(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/index.ls":[function(require,module,exports){
var Game;
Game = require('./game');
Game.start();
},{"./game":"/Users/timdawson/Documents/reconstructing-cave-story/src/game.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/Func.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var apply, curry, flip, fix, over;
apply = curry$(function(f, list){
  return f.apply(null, list);
});
curry = function(f){
  return curry$(f);
};
flip = curry$(function(f, x, y){
  return f(y, x);
});
fix = function(f){
  return function(g){
    return function(){
      return f(g(g)).apply(null, arguments);
    };
  }(function(g){
    return function(){
      return f(g(g)).apply(null, arguments);
    };
  });
};
over = curry$(function(f, g, x, y){
  return f(g(x), g(y));
});
module.exports = {
  curry: curry,
  flip: flip,
  fix: fix,
  apply: apply,
  over: over
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/List.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var each, map, compact, filter, reject, partition, find, head, first, tail, last, initial, empty, reverse, unique, uniqueBy, fold, foldl, fold1, foldl1, foldr, foldr1, unfoldr, concat, concatMap, flatten, difference, intersection, union, countBy, groupBy, andList, orList, any, all, sort, sortWith, sortBy, sum, product, mean, average, maximum, minimum, maximumBy, minimumBy, scan, scanl, scan1, scanl1, scanr, scanr1, slice, take, drop, splitAt, takeWhile, dropWhile, span, breakList, zip, zipWith, zipAll, zipAllWith, at, elemIndex, elemIndices, findIndex, findIndices, toString$ = {}.toString, slice$ = [].slice;
each = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    f(x);
  }
  return xs;
});
map = curry$(function(f, xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    results$.push(f(x));
  }
  return results$;
});
compact = function(xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (x) {
      results$.push(x);
    }
  }
  return results$;
};
filter = curry$(function(f, xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (f(x)) {
      results$.push(x);
    }
  }
  return results$;
});
reject = curry$(function(f, xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!f(x)) {
      results$.push(x);
    }
  }
  return results$;
});
partition = curry$(function(f, xs){
  var passed, failed, i$, len$, x;
  passed = [];
  failed = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    (f(x) ? passed : failed).push(x);
  }
  return [passed, failed];
});
find = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (f(x)) {
      return x;
    }
  }
});
head = first = function(xs){
  return xs[0];
};
tail = function(xs){
  if (!xs.length) {
    return;
  }
  return xs.slice(1);
};
last = function(xs){
  return xs[xs.length - 1];
};
initial = function(xs){
  if (!xs.length) {
    return;
  }
  return xs.slice(0, -1);
};
empty = function(xs){
  return !xs.length;
};
reverse = function(xs){
  return xs.concat().reverse();
};
unique = function(xs){
  var result, i$, len$, x;
  result = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!in$(x, result)) {
      result.push(x);
    }
  }
  return result;
};
uniqueBy = curry$(function(f, xs){
  var seen, i$, len$, x, val, results$ = [];
  seen = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    val = f(x);
    if (in$(val, seen)) {
      continue;
    }
    seen.push(val);
    results$.push(x);
  }
  return results$;
});
fold = foldl = curry$(function(f, memo, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    memo = f(memo, x);
  }
  return memo;
});
fold1 = foldl1 = curry$(function(f, xs){
  return fold(f, xs[0], xs.slice(1));
});
foldr = curry$(function(f, memo, xs){
  var i$, x;
  for (i$ = xs.length - 1; i$ >= 0; --i$) {
    x = xs[i$];
    memo = f(x, memo);
  }
  return memo;
});
foldr1 = curry$(function(f, xs){
  return foldr(f, xs[xs.length - 1], xs.slice(0, -1));
});
unfoldr = curry$(function(f, b){
  var result, x, that;
  result = [];
  x = b;
  while ((that = f(x)) != null) {
    result.push(that[0]);
    x = that[1];
  }
  return result;
});
concat = function(xss){
  return [].concat.apply([], xss);
};
concatMap = curry$(function(f, xs){
  var x;
  return [].concat.apply([], (function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xs).length; i$ < len$; ++i$) {
      x = ref$[i$];
      results$.push(f(x));
    }
    return results$;
  }()));
});
flatten = function(xs){
  var x;
  return [].concat.apply([], (function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xs).length; i$ < len$; ++i$) {
      x = ref$[i$];
      if (toString$.call(x).slice(8, -1) === 'Array') {
        results$.push(flatten(x));
      } else {
        results$.push(x);
      }
    }
    return results$;
  }()));
};
difference = function(xs){
  var yss, results, i$, len$, x, j$, len1$, ys;
  yss = slice$.call(arguments, 1);
  results = [];
  outer: for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    for (j$ = 0, len1$ = yss.length; j$ < len1$; ++j$) {
      ys = yss[j$];
      if (in$(x, ys)) {
        continue outer;
      }
    }
    results.push(x);
  }
  return results;
};
intersection = function(xs){
  var yss, results, i$, len$, x, j$, len1$, ys;
  yss = slice$.call(arguments, 1);
  results = [];
  outer: for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    for (j$ = 0, len1$ = yss.length; j$ < len1$; ++j$) {
      ys = yss[j$];
      if (!in$(x, ys)) {
        continue outer;
      }
    }
    results.push(x);
  }
  return results;
};
union = function(){
  var xss, results, i$, len$, xs, j$, len1$, x;
  xss = slice$.call(arguments);
  results = [];
  for (i$ = 0, len$ = xss.length; i$ < len$; ++i$) {
    xs = xss[i$];
    for (j$ = 0, len1$ = xs.length; j$ < len1$; ++j$) {
      x = xs[j$];
      if (!in$(x, results)) {
        results.push(x);
      }
    }
  }
  return results;
};
countBy = curry$(function(f, xs){
  var results, i$, len$, x, key;
  results = {};
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    key = f(x);
    if (key in results) {
      results[key] += 1;
    } else {
      results[key] = 1;
    }
  }
  return results;
});
groupBy = curry$(function(f, xs){
  var results, i$, len$, x, key;
  results = {};
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    key = f(x);
    if (key in results) {
      results[key].push(x);
    } else {
      results[key] = [x];
    }
  }
  return results;
});
andList = function(xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!x) {
      return false;
    }
  }
  return true;
};
orList = function(xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (x) {
      return true;
    }
  }
  return false;
};
any = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (f(x)) {
      return true;
    }
  }
  return false;
});
all = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!f(x)) {
      return false;
    }
  }
  return true;
});
sort = function(xs){
  return xs.concat().sort(function(x, y){
    if (x > y) {
      return 1;
    } else if (x < y) {
      return -1;
    } else {
      return 0;
    }
  });
};
sortWith = curry$(function(f, xs){
  return xs.concat().sort(f);
});
sortBy = curry$(function(f, xs){
  return xs.concat().sort(function(x, y){
    if (f(x) > f(y)) {
      return 1;
    } else if (f(x) < f(y)) {
      return -1;
    } else {
      return 0;
    }
  });
});
sum = function(xs){
  var result, i$, len$, x;
  result = 0;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    result += x;
  }
  return result;
};
product = function(xs){
  var result, i$, len$, x;
  result = 1;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    result *= x;
  }
  return result;
};
mean = average = function(xs){
  var sum, i$, len$, x;
  sum = 0;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    sum += x;
  }
  return sum / xs.length;
};
maximum = function(xs){
  var max, i$, ref$, len$, x;
  max = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (x > max) {
      max = x;
    }
  }
  return max;
};
minimum = function(xs){
  var min, i$, ref$, len$, x;
  min = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (x < min) {
      min = x;
    }
  }
  return min;
};
maximumBy = curry$(function(f, xs){
  var max, i$, ref$, len$, x;
  max = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (f(x) > f(max)) {
      max = x;
    }
  }
  return max;
});
minimumBy = curry$(function(f, xs){
  var min, i$, ref$, len$, x;
  min = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (f(x) < f(min)) {
      min = x;
    }
  }
  return min;
});
scan = scanl = curry$(function(f, memo, xs){
  var last, x;
  last = memo;
  return [memo].concat((function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xs).length; i$ < len$; ++i$) {
      x = ref$[i$];
      results$.push(last = f(last, x));
    }
    return results$;
  }()));
});
scan1 = scanl1 = curry$(function(f, xs){
  if (!xs.length) {
    return;
  }
  return scan(f, xs[0], xs.slice(1));
});
scanr = curry$(function(f, memo, xs){
  xs = xs.concat().reverse();
  return scan(f, memo, xs).reverse();
});
scanr1 = curry$(function(f, xs){
  if (!xs.length) {
    return;
  }
  xs = xs.concat().reverse();
  return scan(f, xs[0], xs.slice(1)).reverse();
});
slice = curry$(function(x, y, xs){
  return xs.slice(x, y);
});
take = curry$(function(n, xs){
  if (n <= 0) {
    return xs.slice(0, 0);
  } else {
    return xs.slice(0, n);
  }
});
drop = curry$(function(n, xs){
  if (n <= 0) {
    return xs;
  } else {
    return xs.slice(n);
  }
});
splitAt = curry$(function(n, xs){
  return [take(n, xs), drop(n, xs)];
});
takeWhile = curry$(function(p, xs){
  var len, i;
  len = xs.length;
  if (!len) {
    return xs;
  }
  i = 0;
  while (i < len && p(xs[i])) {
    i += 1;
  }
  return xs.slice(0, i);
});
dropWhile = curry$(function(p, xs){
  var len, i;
  len = xs.length;
  if (!len) {
    return xs;
  }
  i = 0;
  while (i < len && p(xs[i])) {
    i += 1;
  }
  return xs.slice(i);
});
span = curry$(function(p, xs){
  return [takeWhile(p, xs), dropWhile(p, xs)];
});
breakList = curry$(function(p, xs){
  return span(function(){
    return not$(p.apply(this, arguments));
  }, xs);
});
zip = curry$(function(xs, ys){
  var result, len, i$, len$, i, x;
  result = [];
  len = ys.length;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (i === len) {
      break;
    }
    result.push([x, ys[i]]);
  }
  return result;
});
zipWith = curry$(function(f, xs, ys){
  var result, len, i$, len$, i, x;
  result = [];
  len = ys.length;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (i === len) {
      break;
    }
    result.push(f(x, ys[i]));
  }
  return result;
});
zipAll = function(){
  var xss, minLength, i$, len$, xs, ref$, i, lresult$, j$, results$ = [];
  xss = slice$.call(arguments);
  minLength = 9e9;
  for (i$ = 0, len$ = xss.length; i$ < len$; ++i$) {
    xs = xss[i$];
    minLength <= (ref$ = xs.length) || (minLength = ref$);
  }
  for (i$ = 0; i$ < minLength; ++i$) {
    i = i$;
    lresult$ = [];
    for (j$ = 0, len$ = xss.length; j$ < len$; ++j$) {
      xs = xss[j$];
      lresult$.push(xs[i]);
    }
    results$.push(lresult$);
  }
  return results$;
};
zipAllWith = function(f){
  var xss, minLength, i$, len$, xs, ref$, i, results$ = [];
  xss = slice$.call(arguments, 1);
  minLength = 9e9;
  for (i$ = 0, len$ = xss.length; i$ < len$; ++i$) {
    xs = xss[i$];
    minLength <= (ref$ = xs.length) || (minLength = ref$);
  }
  for (i$ = 0; i$ < minLength; ++i$) {
    i = i$;
    results$.push(f.apply(null, (fn$())));
  }
  return results$;
  function fn$(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xss).length; i$ < len$; ++i$) {
      xs = ref$[i$];
      results$.push(xs[i]);
    }
    return results$;
  }
};
at = curry$(function(n, xs){
  if (n < 0) {
    return xs[xs.length + n];
  } else {
    return xs[n];
  }
});
elemIndex = curry$(function(el, xs){
  var i$, len$, i, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (x === el) {
      return i;
    }
  }
});
elemIndices = curry$(function(el, xs){
  var i$, len$, i, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (x === el) {
      results$.push(i);
    }
  }
  return results$;
});
findIndex = curry$(function(f, xs){
  var i$, len$, i, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (f(x)) {
      return i;
    }
  }
});
findIndices = curry$(function(f, xs){
  var i$, len$, i, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (f(x)) {
      results$.push(i);
    }
  }
  return results$;
});
module.exports = {
  each: each,
  map: map,
  filter: filter,
  compact: compact,
  reject: reject,
  partition: partition,
  find: find,
  head: head,
  first: first,
  tail: tail,
  last: last,
  initial: initial,
  empty: empty,
  reverse: reverse,
  difference: difference,
  intersection: intersection,
  union: union,
  countBy: countBy,
  groupBy: groupBy,
  fold: fold,
  fold1: fold1,
  foldl: foldl,
  foldl1: foldl1,
  foldr: foldr,
  foldr1: foldr1,
  unfoldr: unfoldr,
  andList: andList,
  orList: orList,
  any: any,
  all: all,
  unique: unique,
  uniqueBy: uniqueBy,
  sort: sort,
  sortWith: sortWith,
  sortBy: sortBy,
  sum: sum,
  product: product,
  mean: mean,
  average: average,
  concat: concat,
  concatMap: concatMap,
  flatten: flatten,
  maximum: maximum,
  minimum: minimum,
  maximumBy: maximumBy,
  minimumBy: minimumBy,
  scan: scan,
  scan1: scan1,
  scanl: scanl,
  scanl1: scanl1,
  scanr: scanr,
  scanr1: scanr1,
  slice: slice,
  take: take,
  drop: drop,
  splitAt: splitAt,
  takeWhile: takeWhile,
  dropWhile: dropWhile,
  span: span,
  breakList: breakList,
  zip: zip,
  zipWith: zipWith,
  zipAll: zipAll,
  zipAllWith: zipAllWith,
  at: at,
  elemIndex: elemIndex,
  elemIndices: elemIndices,
  findIndex: findIndex,
  findIndices: findIndices
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
function in$(x, xs){
  var i = -1, l = xs.length >>> 0;
  while (++i < l) if (x === xs[i]) return true;
  return false;
}
function not$(x){ return !x; }
},{}],"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/Num.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var max, min, negate, abs, signum, quot, rem, div, mod, recip, pi, tau, exp, sqrt, ln, pow, sin, tan, cos, asin, acos, atan, atan2, truncate, round, ceiling, floor, isItNaN, even, odd, gcd, lcm;
max = curry$(function(x$, y$){
  return x$ > y$ ? x$ : y$;
});
min = curry$(function(x$, y$){
  return x$ < y$ ? x$ : y$;
});
negate = function(x){
  return -x;
};
abs = Math.abs;
signum = function(x){
  if (x < 0) {
    return -1;
  } else if (x > 0) {
    return 1;
  } else {
    return 0;
  }
};
quot = curry$(function(x, y){
  return ~~(x / y);
});
rem = curry$(function(x$, y$){
  return x$ % y$;
});
div = curry$(function(x, y){
  return Math.floor(x / y);
});
mod = curry$(function(x$, y$){
  var ref$;
  return ((x$) % (ref$ = y$) + ref$) % ref$;
});
recip = (function(it){
  return 1 / it;
});
pi = Math.PI;
tau = pi * 2;
exp = Math.exp;
sqrt = Math.sqrt;
ln = Math.log;
pow = curry$(function(x$, y$){
  return Math.pow(x$, y$);
});
sin = Math.sin;
tan = Math.tan;
cos = Math.cos;
asin = Math.asin;
acos = Math.acos;
atan = Math.atan;
atan2 = curry$(function(x, y){
  return Math.atan2(x, y);
});
truncate = function(x){
  return ~~x;
};
round = Math.round;
ceiling = Math.ceil;
floor = Math.floor;
isItNaN = function(x){
  return x !== x;
};
even = function(x){
  return x % 2 === 0;
};
odd = function(x){
  return x % 2 !== 0;
};
gcd = curry$(function(x, y){
  var z;
  x = Math.abs(x);
  y = Math.abs(y);
  while (y !== 0) {
    z = x % y;
    x = y;
    y = z;
  }
  return x;
});
lcm = curry$(function(x, y){
  return Math.abs(Math.floor(x / gcd(x, y) * y));
});
module.exports = {
  max: max,
  min: min,
  negate: negate,
  abs: abs,
  signum: signum,
  quot: quot,
  rem: rem,
  div: div,
  mod: mod,
  recip: recip,
  pi: pi,
  tau: tau,
  exp: exp,
  sqrt: sqrt,
  ln: ln,
  pow: pow,
  sin: sin,
  tan: tan,
  cos: cos,
  acos: acos,
  asin: asin,
  atan: atan,
  atan2: atan2,
  truncate: truncate,
  round: round,
  ceiling: ceiling,
  floor: floor,
  isItNaN: isItNaN,
  even: even,
  odd: odd,
  gcd: gcd,
  lcm: lcm
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/Obj.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var values, keys, pairsToObj, objToPairs, listsToObj, objToLists, empty, each, map, compact, filter, reject, partition, find;
values = function(object){
  var i$, x, results$ = [];
  for (i$ in object) {
    x = object[i$];
    results$.push(x);
  }
  return results$;
};
keys = function(object){
  var x, results$ = [];
  for (x in object) {
    results$.push(x);
  }
  return results$;
};
pairsToObj = function(object){
  var i$, len$, x, results$ = {};
  for (i$ = 0, len$ = object.length; i$ < len$; ++i$) {
    x = object[i$];
    results$[x[0]] = x[1];
  }
  return results$;
};
objToPairs = function(object){
  var key, value, results$ = [];
  for (key in object) {
    value = object[key];
    results$.push([key, value]);
  }
  return results$;
};
listsToObj = curry$(function(keys, values){
  var i$, len$, i, key, results$ = {};
  for (i$ = 0, len$ = keys.length; i$ < len$; ++i$) {
    i = i$;
    key = keys[i$];
    results$[key] = values[i];
  }
  return results$;
});
objToLists = function(object){
  var keys, values, key, value;
  keys = [];
  values = [];
  for (key in object) {
    value = object[key];
    keys.push(key);
    values.push(value);
  }
  return [keys, values];
};
empty = function(object){
  var x;
  for (x in object) {
    return false;
  }
  return true;
};
each = curry$(function(f, object){
  var i$, x;
  for (i$ in object) {
    x = object[i$];
    f(x);
  }
  return object;
});
map = curry$(function(f, object){
  var k, x, results$ = {};
  for (k in object) {
    x = object[k];
    results$[k] = f(x);
  }
  return results$;
});
compact = function(object){
  var k, x, results$ = {};
  for (k in object) {
    x = object[k];
if (x) {
      results$[k] = x;
    }
  }
  return results$;
};
filter = curry$(function(f, object){
  var k, x, results$ = {};
  for (k in object) {
    x = object[k];
if (f(x)) {
      results$[k] = x;
    }
  }
  return results$;
});
reject = curry$(function(f, object){
  var k, x, results$ = {};
  for (k in object) {
    x = object[k];
if (!f(x)) {
      results$[k] = x;
    }
  }
  return results$;
});
partition = curry$(function(f, object){
  var passed, failed, k, x;
  passed = {};
  failed = {};
  for (k in object) {
    x = object[k];
    (f(x) ? passed : failed)[k] = x;
  }
  return [passed, failed];
});
find = curry$(function(f, object){
  var i$, x;
  for (i$ in object) {
    x = object[i$];
    if (f(x)) {
      return x;
    }
  }
});
module.exports = {
  values: values,
  keys: keys,
  pairsToObj: pairsToObj,
  objToPairs: objToPairs,
  listsToObj: listsToObj,
  objToLists: objToLists,
  empty: empty,
  each: each,
  map: map,
  filter: filter,
  compact: compact,
  reject: reject,
  partition: partition,
  find: find
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/Str.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var split, join, lines, unlines, words, unwords, chars, unchars, reverse, repeat, capitalize, camelize, dasherize;
split = curry$(function(sep, str){
  return str.split(sep);
});
join = curry$(function(sep, xs){
  return xs.join(sep);
});
lines = function(str){
  if (!str.length) {
    return [];
  }
  return str.split('\n');
};
unlines = function(it){
  return it.join('\n');
};
words = function(str){
  if (!str.length) {
    return [];
  }
  return str.split(/[ ]+/);
};
unwords = function(it){
  return it.join(' ');
};
chars = function(it){
  return it.split('');
};
unchars = function(it){
  return it.join('');
};
reverse = function(str){
  return str.split('').reverse().join('');
};
repeat = curry$(function(n, str){
  var result, i$;
  result = '';
  for (i$ = 0; i$ < n; ++i$) {
    result += str;
  }
  return result;
});
capitalize = function(str){
  return str.charAt(0).toUpperCase() + str.slice(1);
};
camelize = function(it){
  return it.replace(/[-_]+(.)?/g, function(arg$, c){
    return (c != null ? c : '').toUpperCase();
  });
};
dasherize = function(str){
  return str.replace(/([^-A-Z])([A-Z]+)/g, function(arg$, lower, upper){
    return lower + "-" + (upper.length > 1
      ? upper
      : upper.toLowerCase());
  }).replace(/^([A-Z]+)/, function(arg$, upper){
    if (upper.length > 1) {
      return upper + "-";
    } else {
      return upper.toLowerCase();
    }
  });
};
module.exports = {
  split: split,
  join: join,
  lines: lines,
  unlines: unlines,
  words: words,
  unwords: unwords,
  chars: chars,
  unchars: unchars,
  reverse: reverse,
  repeat: repeat,
  capitalize: capitalize,
  camelize: camelize,
  dasherize: dasherize
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/index.js":[function(require,module,exports){
// Generated by LiveScript 1.2.0
var Func, List, Obj, Str, Num, id, isType, replicate, prelude, toString$ = {}.toString;
Func = require('./Func.js');
List = require('./List.js');
Obj = require('./Obj.js');
Str = require('./Str.js');
Num = require('./Num.js');
id = function(x){
  return x;
};
isType = curry$(function(type, x){
  return toString$.call(x).slice(8, -1) === type;
});
replicate = curry$(function(n, x){
  var i$, results$ = [];
  for (i$ = 0; i$ < n; ++i$) {
    results$.push(x);
  }
  return results$;
});
Str.empty = List.empty;
Str.slice = List.slice;
Str.take = List.take;
Str.drop = List.drop;
Str.splitAt = List.splitAt;
Str.takeWhile = List.takeWhile;
Str.dropWhile = List.dropWhile;
Str.span = List.span;
Str.breakStr = List.breakList;
prelude = {
  Func: Func,
  List: List,
  Obj: Obj,
  Str: Str,
  Num: Num,
  id: id,
  isType: isType,
  replicate: replicate
};
prelude.each = List.each;
prelude.map = List.map;
prelude.filter = List.filter;
prelude.compact = List.compact;
prelude.reject = List.reject;
prelude.partition = List.partition;
prelude.find = List.find;
prelude.head = List.head;
prelude.first = List.first;
prelude.tail = List.tail;
prelude.last = List.last;
prelude.initial = List.initial;
prelude.empty = List.empty;
prelude.reverse = List.reverse;
prelude.difference = List.difference;
prelude.intersection = List.intersection;
prelude.union = List.union;
prelude.countBy = List.countBy;
prelude.groupBy = List.groupBy;
prelude.fold = List.fold;
prelude.foldl = List.foldl;
prelude.fold1 = List.fold1;
prelude.foldl1 = List.foldl1;
prelude.foldr = List.foldr;
prelude.foldr1 = List.foldr1;
prelude.unfoldr = List.unfoldr;
prelude.andList = List.andList;
prelude.orList = List.orList;
prelude.any = List.any;
prelude.all = List.all;
prelude.unique = List.unique;
prelude.uniqueBy = List.uniqueBy;
prelude.sort = List.sort;
prelude.sortWith = List.sortWith;
prelude.sortBy = List.sortBy;
prelude.sum = List.sum;
prelude.product = List.product;
prelude.mean = List.mean;
prelude.average = List.average;
prelude.concat = List.concat;
prelude.concatMap = List.concatMap;
prelude.flatten = List.flatten;
prelude.maximum = List.maximum;
prelude.minimum = List.minimum;
prelude.maximumBy = List.maximumBy;
prelude.minimumBy = List.minimumBy;
prelude.scan = List.scan;
prelude.scanl = List.scanl;
prelude.scan1 = List.scan1;
prelude.scanl1 = List.scanl1;
prelude.scanr = List.scanr;
prelude.scanr1 = List.scanr1;
prelude.slice = List.slice;
prelude.take = List.take;
prelude.drop = List.drop;
prelude.splitAt = List.splitAt;
prelude.takeWhile = List.takeWhile;
prelude.dropWhile = List.dropWhile;
prelude.span = List.span;
prelude.breakList = List.breakList;
prelude.zip = List.zip;
prelude.zipWith = List.zipWith;
prelude.zipAll = List.zipAll;
prelude.zipAllWith = List.zipAllWith;
prelude.at = List.at;
prelude.elemIndex = List.elemIndex;
prelude.elemIndices = List.elemIndices;
prelude.findIndex = List.findIndex;
prelude.findIndices = List.findIndices;
prelude.apply = Func.apply;
prelude.curry = Func.curry;
prelude.flip = Func.flip;
prelude.fix = Func.fix;
prelude.over = Func.over;
prelude.split = Str.split;
prelude.join = Str.join;
prelude.lines = Str.lines;
prelude.unlines = Str.unlines;
prelude.words = Str.words;
prelude.unwords = Str.unwords;
prelude.chars = Str.chars;
prelude.unchars = Str.unchars;
prelude.repeat = Str.repeat;
prelude.capitalize = Str.capitalize;
prelude.camelize = Str.camelize;
prelude.dasherize = Str.dasherize;
prelude.values = Obj.values;
prelude.keys = Obj.keys;
prelude.pairsToObj = Obj.pairsToObj;
prelude.objToPairs = Obj.objToPairs;
prelude.listsToObj = Obj.listsToObj;
prelude.objToLists = Obj.objToLists;
prelude.max = Num.max;
prelude.min = Num.min;
prelude.negate = Num.negate;
prelude.abs = Num.abs;
prelude.signum = Num.signum;
prelude.quot = Num.quot;
prelude.rem = Num.rem;
prelude.div = Num.div;
prelude.mod = Num.mod;
prelude.recip = Num.recip;
prelude.pi = Num.pi;
prelude.tau = Num.tau;
prelude.exp = Num.exp;
prelude.sqrt = Num.sqrt;
prelude.ln = Num.ln;
prelude.pow = Num.pow;
prelude.sin = Num.sin;
prelude.tan = Num.tan;
prelude.cos = Num.cos;
prelude.acos = Num.acos;
prelude.asin = Num.asin;
prelude.atan = Num.atan;
prelude.atan2 = Num.atan2;
prelude.truncate = Num.truncate;
prelude.round = Num.round;
prelude.ceiling = Num.ceiling;
prelude.floor = Num.floor;
prelude.isItNaN = Num.isItNaN;
prelude.even = Num.even;
prelude.odd = Num.odd;
prelude.gcd = Num.gcd;
prelude.lcm = Num.lcm;
prelude.VERSION = '1.1.1';
module.exports = prelude;
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{"./Func.js":"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/Func.js","./List.js":"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/List.js","./Num.js":"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/Num.js","./Obj.js":"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/Obj.js","./Str.js":"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/Str.js"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/animated-sprite.ls":[function(require,module,exports){
var std, Game, Sprite, AnimatedSprite;
std = require('std');
Game = require('./game');
Sprite = require('./sprite');
module.exports = AnimatedSprite = (function(superclass){
  var prototype = extend$((import$(AnimatedSprite, superclass).displayName = 'AnimatedSprite', AnimatedSprite), superclass).prototype, constructor = AnimatedSprite;
  function AnimatedSprite(graphics, path, sourceX, sourceY, width, height, fps, numFrames){
    this.width = width;
    this.height = height;
    this.fps = fps;
    this.numFrames = numFrames;
    std.log('AnimatedSprite::New -', sourceX, sourceY, this.width, this.height);
    AnimatedSprite.superclass.apply(this, arguments);
    this.frameTime = 1000 / this.fps;
    this.currentFrame = 0;
    this.elapsedTime = 0;
  }
  prototype.update = function(elapsedTime){
    this.elapsedTime += elapsedTime;
    if (this.elapsedTime > this.frameTime) {
      this.currentFrame += 1;
      this.elapsedTime = 0;
      if (this.currentFrame < this.numFrames) {
        return this.sourceRect.x += Game.kTileSize;
      } else {
        this.sourceRect.x -= Game.kTileSize * (this.numFrames - 1);
        return this.currentFrame = 0;
      }
    }
  };
  return AnimatedSprite;
}(Sprite));
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"./game":"/Users/timdawson/Documents/reconstructing-cave-story/src/game.ls","./sprite":"/Users/timdawson/Documents/reconstructing-cave-story/src/sprite.ls","std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/game.ls":[function(require,module,exports){
var std, SDL, input, graphics, Player, kDebugMode, kFps, kTileSize, running, player, lastFrameTime, eventLoop, update, draw, createTestWorld, start, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
SDL = require('SDL');
input = require('./input');
graphics = require('./graphics');
Player = require('./player');
out$.kDebugMode = kDebugMode = true;
out$.kFps = kFps = 60;
out$.kTileSize = kTileSize = 32;
std.log("Game - new Game");
running = true;
player = null;
lastFrameTime = 0;
eventLoop = function(){
  var startTime, event, elapsedTime;
  startTime = SDL.getTicks();
  input.beginNewFrame();
  while (event = SDL.pollEvent()) {
    switch (event.type) {
    case SDL.KEYDOWN:
      input.keyDownEvent(event);
      break;
    case SDL.KEYUP:
      input.keyUpEvent(event);
      break;
    default:
      throw new Error({
        message: "Unknown event type: " + event
      });
    }
  }
  if (input.wasKeyPressed(SDL.KEY.ESCAPE)) {
    running = false;
  }
  if (input.isKeyHeld(SDL.KEY.LEFT) && input.isKeyHeld(SDL.KEY.RIGHT)) {
    player.stopMoving();
  } else if (input.isKeyHeld(SDL.KEY.LEFT)) {
    player.startMovingLeft();
  } else if (input.isKeyHeld(SDL.KEY.RIGHT)) {
    player.startMovingRight();
  } else {
    player.stopMoving();
  }
  update(SDL.getTicks() - lastFrameTime);
  draw();
  if (running) {
    lastFrameTime = SDL.getTicks();
    elapsedTime = lastFrameTime - startTime;
    return SDL.delay(1000 / kFps - elapsedTime, eventLoop);
  } else {
    return std.log('Game stopped.');
  }
};
update = function(elapsedTime){
  return player.update(elapsedTime);
};
draw = function(){
  graphics.clear();
  return player.draw(graphics, 320, 240);
};
createTestWorld = function(){
  return player = new Player(320, 240);
};
out$.start = start = function(){
  SDL.init(SDL.INIT_EVERYTHING);
  createTestWorld();
  eventLoop();
  return std.delay(10000, function(){
    return running = false;
  });
};
},{"./graphics":"/Users/timdawson/Documents/reconstructing-cave-story/src/graphics.ls","./input":"/Users/timdawson/Documents/reconstructing-cave-story/src/input.ls","./player":"/Users/timdawson/Documents/reconstructing-cave-story/src/player.ls","SDL":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/index.ls","std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/graphics.ls":[function(require,module,exports){
var std, SDL, kScreenWidth, kScreenHeight, screen, spritesheets, loadImage, blitSurface, clear, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
SDL = require('SDL');
kScreenWidth = 640;
kScreenHeight = 480;
screen = SDL.setVideoMode(kScreenWidth, kScreenHeight, SDL.FULLSCREEN);
spritesheets = {};
out$.loadImage = loadImage = function(path){
  if (spritesheets[path] == null) {
    std.log('Graphics::loadImage - no surface for', path, '- creating new surface');
    spritesheets[path] = new SDL.Surface(path);
  } else {
    std.log('Graphics::loadImage - reusing available surface for', path);
  }
  return spritesheets[path];
};
out$.blitSurface = blitSurface = function(source, srcRect, destRect){
  return SDL.blitSurface(source, srcRect, screen, destRect);
};
out$.clear = clear = function(){
  return screen.clear();
};
},{"SDL":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/index.ls","std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/input.ls":[function(require,module,exports){
var std, Input;
std = require('std');
Input = (function(){
  Input.displayName = 'Input';
  var prototype = Input.prototype, constructor = Input;
  function Input(){
    this.heldKeys = {};
    this.pressedKeys = {};
    this.releasedKeys = {};
  }
  prototype.beginNewFrame = function(){
    this.pressedKeys = {};
    return this.releasedKeys = {};
  };
  prototype.keyDownEvent = function(event){
    this.pressedKeys[event.key] = true;
    return this.heldKeys[event.key] = true;
  };
  prototype.keyUpEvent = function(event){
    this.releasedKeys[event.key] = true;
    return this.heldKeys[event.key] = false;
  };
  prototype.wasKeyPressed = function(key){
    return this.pressedKeys[key];
  };
  prototype.wasKeyReleased = function(key){
    return this.releasedKeys[key];
  };
  prototype.isKeyHeld = function(key){
    return this.heldKeys[key];
  };
  return Input;
}());
module.exports = new Input;
},{"std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/player.ls":[function(require,module,exports){
var std, graphics, Game, AnimatedSprite, kSpriteFrameTime, kSlowdownFactor, kWalkingAcceleration, kMaxSpeedX, Player;
std = require('std');
graphics = require('./graphics');
Game = require('./game');
AnimatedSprite = require('./animated-sprite');
kSpriteFrameTime = 15;
kSlowdownFactor = 0.8;
kWalkingAcceleration = 0.0012;
kMaxSpeedX = 0.325;
module.exports = Player = (function(){
  Player.displayName = 'Player';
  var prototype = Player.prototype, constructor = Player;
  function Player(x, y){
    this.x = x;
    this.y = y;
    this.velocityX = 0;
    this.accelerationX = 0;
    this.sprite = new AnimatedSprite(graphics, 'content/MyChar.bmp', 0, 0, Game.kTileSize, Game.kTileSize, kSpriteFrameTime, 3);
  }
  prototype.update = function(elapsedTime){
    this.sprite.update(elapsedTime);
    this.x += std.round(this.velocityX * elapsedTime);
    this.velocityX += this.accelerationX * elapsedTime;
    if (this.accelerationX < 0) {
      return this.velocityX = std.max(this.velocityX, -kMaxSpeedX);
    } else if (this.accelerationX > 0) {
      return this.velocityX = std.min(this.velocityX, kMaxSpeedX);
    } else {
      return this.velocityX *= kSlowdownFactor;
    }
  };
  prototype.draw = function(graphics){
    return this.sprite.draw(graphics, this.x, this.y);
  };
  prototype.startMovingLeft = function(){
    return this.accelerationX = -kWalkingAcceleration;
  };
  prototype.startMovingRight = function(){
    return this.accelerationX = kWalkingAcceleration;
  };
  prototype.stopMoving = function(){
    return this.accelerationX = 0;
  };
  return Player;
}());
},{"./animated-sprite":"/Users/timdawson/Documents/reconstructing-cave-story/src/animated-sprite.ls","./game":"/Users/timdawson/Documents/reconstructing-cave-story/src/game.ls","./graphics":"/Users/timdawson/Documents/reconstructing-cave-story/src/graphics.ls","std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/delay.ls":[function(require,module,exports){
var raf, out$ = typeof exports != 'undefined' && exports || this;
raf = requestAnimationFrame;
import$(out$, {
  delay: function(time, λ){
    return raf(λ);
  }
});
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{}],"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/event-queue.ls":[function(require,module,exports){
var std, queue, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
queue = [];
import$(out$, {
  pushEvent: function(event){
    return queue.push(event);
  },
  pollEvent: function(){
    if (queue.length) {
      return queue.shift();
    }
  }
});
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/index.ls":[function(require,module,exports){
var std, delay, timer, screen, keyboard, eventQueue, Rect, Surface, ref$, INIT_EVERYTHING, FULLSCREEN, init, KEY, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
delay = require('./delay');
timer = require('./timer');
screen = require('./screen');
keyboard = require('./keyboard');
eventQueue = require('./event-queue');
out$.Rect = Rect = require('./rect');
out$.Surface = Surface = require('./surface');
ref$ = std['enum'], INIT_EVERYTHING = ref$[0], FULLSCREEN = ref$[1];
out$.init = init = function(mode){
  std.log("SDL::Init - with mode:", mode);
  timer.init();
  return keyboard.init();
};
out$.INIT_EVERYTHING = INIT_EVERYTHING;
out$.FULLSCREEN = FULLSCREEN;
out$.KEYDOWN = keyboard.KEYDOWN;
out$.KEYUP = keyboard.KEYUP;
out$.KEY = KEY = keyboard.KEYCODES;
out$.delay = delay.delay;
out$.getTicks = timer.getTicks;
out$.pollEvent = eventQueue.pollEvent;
out$.setVideoMode = screen.setVideoMode;
out$.blitSurface = Surface.blitSurface;
out$.loadImage = Surface.loadImage;
},{"./delay":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/delay.ls","./event-queue":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/event-queue.ls","./keyboard":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/keyboard.ls","./rect":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/rect.ls","./screen":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/screen.ls","./surface":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/surface.ls","./timer":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/timer.ls","std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/keyboard.ls":[function(require,module,exports){
var std, queue, ref$, KEYDOWN, KEYUP, KEYCODES, monitorKeys, init, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
queue = require('./event-queue');
ref$ = std['enum'], KEYDOWN = ref$[0], KEYUP = ref$[1];
out$.KEYCODES = KEYCODES = {
  ESCAPE: 27,
  LEFT: 37,
  UP: 38,
  RIGHT: 39,
  DOWN: 40
};
monitorKeys = function(){
  document.addEventListener('keydown', function(arg$){
    var which;
    which = arg$.which;
    std.info(which);
    queue.pushEvent({
      type: KEYDOWN,
      key: which
    });
    return event.preventDefault();
  });
  return document.addEventListener('keyup', function(arg$){
    var which;
    which = arg$.which;
    queue.pushEvent({
      type: KEYUP,
      key: which
    });
    return event.preventDefault();
  });
};
out$.init = init = function(){
  std.log("SDL::Keyboard - Monitoring key input");
  return monitorKeys();
};
out$.KEYDOWN = KEYDOWN;
out$.KEYUP = KEYUP;
},{"./event-queue":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/event-queue.ls","std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/rect.ls":[function(require,module,exports){
var Rect;
module.exports = Rect = (function(){
  Rect.displayName = 'Rect';
  var prototype = Rect.prototype, constructor = Rect;
  function Rect(x, y, w, h){
    this.x = x;
    this.y = y;
    this.w = w;
    this.h = h;
  }
  return Rect;
}());
},{}],"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/screen.ls":[function(require,module,exports){
var std, Surface, FULLSCREEN, createNewScreen, setVideoMode, out$ = typeof exports != 'undefined' && exports || this;
std = require('std');
Surface = require('./surface');
FULLSCREEN = std['enum'][0];
createNewScreen = function(w, h, isFullscreen){
  var screen;
  screen = new Surface(null, w, h);
  document.body.appendChild(screen.canvas);
  return screen;
};
out$.setVideoMode = setVideoMode = function(width, height, flags){
  return createNewScreen(width, height, flags === FULLSCREEN);
};
},{"./surface":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/surface.ls","std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/surface.ls":[function(require,module,exports){
var std, Rect, Surface;
std = require('std');
Rect = require('./rect');
module.exports = Surface = (function(){
  Surface.displayName = 'Surface';
  var prototype = Surface.prototype, constructor = Surface;
  function Surface(src, width, height){
    this.width = width;
    this.height = height;
    this.canvas = document.createElement('canvas');
    this.ctx = this.canvas.getContext('2d');
    this.ready = false;
    this.resetCanvasSize();
    if (typeof src === 'string') {
      std.log('SDL::Surface - src unloaded. Loading...', src);
      this.loadImageData(src);
    } else if (src != null) {
      std.log('SDL::Surface - src already prepared:', src);
      this.saveImageData(src);
    } else {
      std.log('SDL::Surface - Blank surface created');
    }
  }
  prototype.resetCanvasSize = function(){
    this.canvas.width = this.width;
    return this.canvas.height = this.height;
  };
  prototype.inheritSizeFromImage = function(data){
    if (this.width == null && this.height == null) {
      this.width = data.naturalWidth;
      this.height = data.naturalHeight;
      return this.resetCanvasSize();
    }
  };
  prototype.loadImageData = function(path){
    var data, this$ = this;
    data = new Image;
    data.onload = function(){
      std.log('SDL::Surface::loadImageData - asset ready:', path);
      this$.inheritSizeFromImage(data);
      return this$.saveImageData(data);
    };
    return data.src = path;
  };
  prototype.saveImageData = function(data){
    std.log('SDL::Surface::saveImageData -', data);
    this.data = data;
    this.ready = true;
    return this.ctx.drawImage(this.data, 0, 0, this.width, this.height);
  };
  prototype.clear = function(){
    return this.ctx.clearRect(0, 0, this.width, this.height);
  };
  Surface.blitSurface = function(source, srcRect, dest, destRect){
    return dest.ctx.drawImage(source.canvas, srcRect.x, srcRect.y, srcRect.w, srcRect.h, destRect.x, destRect.y, destRect.w, destRect.h);
  };
  return Surface;
}());
},{"./rect":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/rect.ls","std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/timer.ls":[function(require,module,exports){
var startTime, out$ = typeof exports != 'undefined' && exports || this;
startTime = 0;
import$(out$, {
  init: function(){
    return startTime = Date.now();
  },
  getTicks: function(){
    return Date.now() - startTime;
  }
});
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{}],"/Users/timdawson/Documents/reconstructing-cave-story/src/sprite.ls":[function(require,module,exports){
var SDL, std, Game, Sprite;
SDL = require('SDL');
std = require('std');
Game = require('./game');
module.exports = Sprite = (function(){
  Sprite.displayName = 'Sprite';
  var prototype = Sprite.prototype, constructor = Sprite;
  function Sprite(graphics, path, sourceX, sourceY, width, height){
    this.width = width;
    this.height = height;
    this.sourceRect = new SDL.Rect(sourceX, sourceY, width, height);
    this.spriteSheet = graphics.loadImage(path);
    if (Game.kDebugMode) {
      document.body.appendChild(this.spriteSheet.canvas);
    }
  }
  prototype.draw = function(graphics, x, y){
    var destRect;
    destRect = new SDL.Rect(x, y, this.width, this.height);
    return graphics.blitSurface(this.spriteSheet, this.sourceRect, destRect);
  };
  return Sprite;
}());
},{"./game":"/Users/timdawson/Documents/reconstructing-cave-story/src/game.ls","SDL":"/Users/timdawson/Documents/reconstructing-cave-story/src/sdl/index.ls","std":"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls"}],"/Users/timdawson/Documents/reconstructing-cave-story/src/std/index.ls":[function(require,module,exports){
var ref$, id, map, filter, any, log, info, objMap, flip, delay, round, max, min, out$ = typeof exports != 'undefined' && exports || this;
ref$ = require('prelude-ls'), id = ref$.id, map = ref$.map, filter = ref$.filter, any = ref$.any;
out$.log = log = function(){
  console.log.apply(console, arguments);
  return arguments[0];
};
out$.info = info = function(){
  console.info.apply(console, arguments);
  return arguments[0];
};
out$.objMap = objMap = curry$(function(λ, o){
  var k, v, results$ = [];
  for (k in o) {
    v = o[k];
    results$.push(λ(k, v));
  }
  return results$;
});
out$.flip = flip = function(λ){
  return curry$(function(a, b){
    return λ(b, a);
  });
};
out$.delay = delay = flip(setTimeout);
out$.round = round = Math.round;
out$.max = max = Math.max;
out$.min = min = Math.min;
ref$ = out$;
ref$.id = id;
ref$.any = any;
ref$.map = map;
ref$.filter = filter;
ref$['enum'] = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{"prelude-ls":"/Users/timdawson/Documents/reconstructing-cave-story/node_modules/prelude-ls/lib/index.js"}]},{},["./src/index.ls"])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy90aW1kYXdzb24vRG9jdW1lbnRzL3JlY29uc3RydWN0aW5nLWNhdmUtc3Rvcnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi4vc3JjL2luZGV4LmxzIiwiL1VzZXJzL3RpbWRhd3Nvbi9Eb2N1bWVudHMvcmVjb25zdHJ1Y3RpbmctY2F2ZS1zdG9yeS9ub2RlX21vZHVsZXMvcHJlbHVkZS1scy9saWIvRnVuYy5qcyIsIi9Vc2Vycy90aW1kYXdzb24vRG9jdW1lbnRzL3JlY29uc3RydWN0aW5nLWNhdmUtc3Rvcnkvbm9kZV9tb2R1bGVzL3ByZWx1ZGUtbHMvbGliL0xpc3QuanMiLCIvVXNlcnMvdGltZGF3c29uL0RvY3VtZW50cy9yZWNvbnN0cnVjdGluZy1jYXZlLXN0b3J5L25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9OdW0uanMiLCIvVXNlcnMvdGltZGF3c29uL0RvY3VtZW50cy9yZWNvbnN0cnVjdGluZy1jYXZlLXN0b3J5L25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9PYmouanMiLCIvVXNlcnMvdGltZGF3c29uL0RvY3VtZW50cy9yZWNvbnN0cnVjdGluZy1jYXZlLXN0b3J5L25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9TdHIuanMiLCIvVXNlcnMvdGltZGF3c29uL0RvY3VtZW50cy9yZWNvbnN0cnVjdGluZy1jYXZlLXN0b3J5L25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9pbmRleC5qcyIsIi9Vc2Vycy90aW1kYXdzb24vRG9jdW1lbnRzL3JlY29uc3RydWN0aW5nLWNhdmUtc3Rvcnkvc3JjL2FuaW1hdGVkLXNwcml0ZS5scyIsIi9Vc2Vycy90aW1kYXdzb24vRG9jdW1lbnRzL3JlY29uc3RydWN0aW5nLWNhdmUtc3Rvcnkvc3JjL2dhbWUubHMiLCIvVXNlcnMvdGltZGF3c29uL0RvY3VtZW50cy9yZWNvbnN0cnVjdGluZy1jYXZlLXN0b3J5L3NyYy9ncmFwaGljcy5scyIsIi9Vc2Vycy90aW1kYXdzb24vRG9jdW1lbnRzL3JlY29uc3RydWN0aW5nLWNhdmUtc3Rvcnkvc3JjL2lucHV0LmxzIiwiL1VzZXJzL3RpbWRhd3Nvbi9Eb2N1bWVudHMvcmVjb25zdHJ1Y3RpbmctY2F2ZS1zdG9yeS9zcmMvcGxheWVyLmxzIiwiL1VzZXJzL3RpbWRhd3Nvbi9Eb2N1bWVudHMvcmVjb25zdHJ1Y3RpbmctY2F2ZS1zdG9yeS9zcmMvc2RsL2RlbGF5LmxzIiwiL1VzZXJzL3RpbWRhd3Nvbi9Eb2N1bWVudHMvcmVjb25zdHJ1Y3RpbmctY2F2ZS1zdG9yeS9zcmMvc2RsL2V2ZW50LXF1ZXVlLmxzIiwiL1VzZXJzL3RpbWRhd3Nvbi9Eb2N1bWVudHMvcmVjb25zdHJ1Y3RpbmctY2F2ZS1zdG9yeS9zcmMvc2RsL2luZGV4LmxzIiwiL1VzZXJzL3RpbWRhd3Nvbi9Eb2N1bWVudHMvcmVjb25zdHJ1Y3RpbmctY2F2ZS1zdG9yeS9zcmMvc2RsL2tleWJvYXJkLmxzIiwiL1VzZXJzL3RpbWRhd3Nvbi9Eb2N1bWVudHMvcmVjb25zdHJ1Y3RpbmctY2F2ZS1zdG9yeS9zcmMvc2RsL3JlY3QubHMiLCIvVXNlcnMvdGltZGF3c29uL0RvY3VtZW50cy9yZWNvbnN0cnVjdGluZy1jYXZlLXN0b3J5L3NyYy9zZGwvc2NyZWVuLmxzIiwiL1VzZXJzL3RpbWRhd3Nvbi9Eb2N1bWVudHMvcmVjb25zdHJ1Y3RpbmctY2F2ZS1zdG9yeS9zcmMvc2RsL3N1cmZhY2UubHMiLCIvVXNlcnMvdGltZGF3c29uL0RvY3VtZW50cy9yZWNvbnN0cnVjdGluZy1jYXZlLXN0b3J5L3NyYy9zZGwvdGltZXIubHMiLCIvVXNlcnMvdGltZGF3c29uL0RvY3VtZW50cy9yZWNvbnN0cnVjdGluZy1jYXZlLXN0b3J5L3NyYy9zcHJpdGUubHMiLCIvVXNlcnMvdGltZGF3c29uL0RvY3VtZW50cy9yZWNvbnN0cnVjdGluZy1jYXZlLXN0b3J5L3NyYy9zdGQvaW5kZXgubHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgR2FtZTtcbkdhbWUgPSByZXF1aXJlKCcuL2dhbWUnKTtcbkdhbWUuc3RhcnQoKTsiLCIvLyBHZW5lcmF0ZWQgYnkgTGl2ZVNjcmlwdCAxLjIuMFxudmFyIGFwcGx5LCBjdXJyeSwgZmxpcCwgZml4LCBvdmVyO1xuYXBwbHkgPSBjdXJyeSQoZnVuY3Rpb24oZiwgbGlzdCl7XG4gIHJldHVybiBmLmFwcGx5KG51bGwsIGxpc3QpO1xufSk7XG5jdXJyeSA9IGZ1bmN0aW9uKGYpe1xuICByZXR1cm4gY3VycnkkKGYpO1xufTtcbmZsaXAgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeCwgeSl7XG4gIHJldHVybiBmKHksIHgpO1xufSk7XG5maXggPSBmdW5jdGlvbihmKXtcbiAgcmV0dXJuIGZ1bmN0aW9uKGcpe1xuICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIGYoZyhnKSkuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9KGZ1bmN0aW9uKGcpe1xuICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIGYoZyhnKSkuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9KTtcbn07XG5vdmVyID0gY3VycnkkKGZ1bmN0aW9uKGYsIGcsIHgsIHkpe1xuICByZXR1cm4gZihnKHgpLCBnKHkpKTtcbn0pO1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGN1cnJ5OiBjdXJyeSxcbiAgZmxpcDogZmxpcCxcbiAgZml4OiBmaXgsXG4gIGFwcGx5OiBhcHBseSxcbiAgb3Zlcjogb3ZlclxufTtcbmZ1bmN0aW9uIGN1cnJ5JChmLCBib3VuZCl7XG4gIHZhciBjb250ZXh0LFxuICBfY3VycnkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIGYubGVuZ3RoID4gMSA/IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGFyYW1zID0gYXJncyA/IGFyZ3MuY29uY2F0KCkgOiBbXTtcbiAgICAgIGNvbnRleHQgPSBib3VuZCA/IGNvbnRleHQgfHwgdGhpcyA6IHRoaXM7XG4gICAgICByZXR1cm4gcGFyYW1zLnB1c2guYXBwbHkocGFyYW1zLCBhcmd1bWVudHMpIDxcbiAgICAgICAgICBmLmxlbmd0aCAmJiBhcmd1bWVudHMubGVuZ3RoID9cbiAgICAgICAgX2N1cnJ5LmNhbGwoY29udGV4dCwgcGFyYW1zKSA6IGYuYXBwbHkoY29udGV4dCwgcGFyYW1zKTtcbiAgICB9IDogZjtcbiAgfTtcbiAgcmV0dXJuIF9jdXJyeSgpO1xufSIsIi8vIEdlbmVyYXRlZCBieSBMaXZlU2NyaXB0IDEuMi4wXG52YXIgZWFjaCwgbWFwLCBjb21wYWN0LCBmaWx0ZXIsIHJlamVjdCwgcGFydGl0aW9uLCBmaW5kLCBoZWFkLCBmaXJzdCwgdGFpbCwgbGFzdCwgaW5pdGlhbCwgZW1wdHksIHJldmVyc2UsIHVuaXF1ZSwgdW5pcXVlQnksIGZvbGQsIGZvbGRsLCBmb2xkMSwgZm9sZGwxLCBmb2xkciwgZm9sZHIxLCB1bmZvbGRyLCBjb25jYXQsIGNvbmNhdE1hcCwgZmxhdHRlbiwgZGlmZmVyZW5jZSwgaW50ZXJzZWN0aW9uLCB1bmlvbiwgY291bnRCeSwgZ3JvdXBCeSwgYW5kTGlzdCwgb3JMaXN0LCBhbnksIGFsbCwgc29ydCwgc29ydFdpdGgsIHNvcnRCeSwgc3VtLCBwcm9kdWN0LCBtZWFuLCBhdmVyYWdlLCBtYXhpbXVtLCBtaW5pbXVtLCBtYXhpbXVtQnksIG1pbmltdW1CeSwgc2Nhbiwgc2NhbmwsIHNjYW4xLCBzY2FubDEsIHNjYW5yLCBzY2FucjEsIHNsaWNlLCB0YWtlLCBkcm9wLCBzcGxpdEF0LCB0YWtlV2hpbGUsIGRyb3BXaGlsZSwgc3BhbiwgYnJlYWtMaXN0LCB6aXAsIHppcFdpdGgsIHppcEFsbCwgemlwQWxsV2l0aCwgYXQsIGVsZW1JbmRleCwgZWxlbUluZGljZXMsIGZpbmRJbmRleCwgZmluZEluZGljZXMsIHRvU3RyaW5nJCA9IHt9LnRvU3RyaW5nLCBzbGljZSQgPSBbXS5zbGljZTtcbmVhY2ggPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIHg7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGYoeCk7XG4gIH1cbiAgcmV0dXJuIHhzO1xufSk7XG5tYXAgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIHJlc3VsdHMkLnB1c2goZih4KSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufSk7XG5jb21wYWN0ID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgaSQsIGxlbiQsIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmICh4KSB7XG4gICAgICByZXN1bHRzJC5wdXNoKHgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59O1xuZmlsdGVyID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4LCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoZih4KSkge1xuICAgICAgcmVzdWx0cyQucHVzaCh4KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufSk7XG5yZWplY3QgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmICghZih4KSkge1xuICAgICAgcmVzdWx0cyQucHVzaCh4KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufSk7XG5wYXJ0aXRpb24gPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgcGFzc2VkLCBmYWlsZWQsIGkkLCBsZW4kLCB4O1xuICBwYXNzZWQgPSBbXTtcbiAgZmFpbGVkID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIChmKHgpID8gcGFzc2VkIDogZmFpbGVkKS5wdXNoKHgpO1xuICB9XG4gIHJldHVybiBbcGFzc2VkLCBmYWlsZWRdO1xufSk7XG5maW5kID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoZih4KSkge1xuICAgICAgcmV0dXJuIHg7XG4gICAgfVxuICB9XG59KTtcbmhlYWQgPSBmaXJzdCA9IGZ1bmN0aW9uKHhzKXtcbiAgcmV0dXJuIHhzWzBdO1xufTtcbnRhaWwgPSBmdW5jdGlvbih4cyl7XG4gIGlmICgheHMubGVuZ3RoKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHJldHVybiB4cy5zbGljZSgxKTtcbn07XG5sYXN0ID0gZnVuY3Rpb24oeHMpe1xuICByZXR1cm4geHNbeHMubGVuZ3RoIC0gMV07XG59O1xuaW5pdGlhbCA9IGZ1bmN0aW9uKHhzKXtcbiAgaWYgKCF4cy5sZW5ndGgpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgcmV0dXJuIHhzLnNsaWNlKDAsIC0xKTtcbn07XG5lbXB0eSA9IGZ1bmN0aW9uKHhzKXtcbiAgcmV0dXJuICF4cy5sZW5ndGg7XG59O1xucmV2ZXJzZSA9IGZ1bmN0aW9uKHhzKXtcbiAgcmV0dXJuIHhzLmNvbmNhdCgpLnJldmVyc2UoKTtcbn07XG51bmlxdWUgPSBmdW5jdGlvbih4cyl7XG4gIHZhciByZXN1bHQsIGkkLCBsZW4kLCB4O1xuICByZXN1bHQgPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKCFpbiQoeCwgcmVzdWx0KSkge1xuICAgICAgcmVzdWx0LnB1c2goeCk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xudW5pcXVlQnkgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgc2VlbiwgaSQsIGxlbiQsIHgsIHZhbCwgcmVzdWx0cyQgPSBbXTtcbiAgc2VlbiA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICB2YWwgPSBmKHgpO1xuICAgIGlmIChpbiQodmFsLCBzZWVuKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHNlZW4ucHVzaCh2YWwpO1xuICAgIHJlc3VsdHMkLnB1c2goeCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufSk7XG5mb2xkID0gZm9sZGwgPSBjdXJyeSQoZnVuY3Rpb24oZiwgbWVtbywgeHMpe1xuICB2YXIgaSQsIGxlbiQsIHg7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIG1lbW8gPSBmKG1lbW8sIHgpO1xuICB9XG4gIHJldHVybiBtZW1vO1xufSk7XG5mb2xkMSA9IGZvbGRsMSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHJldHVybiBmb2xkKGYsIHhzWzBdLCB4cy5zbGljZSgxKSk7XG59KTtcbmZvbGRyID0gY3VycnkkKGZ1bmN0aW9uKGYsIG1lbW8sIHhzKXtcbiAgdmFyIGkkLCB4O1xuICBmb3IgKGkkID0geHMubGVuZ3RoIC0gMTsgaSQgPj0gMDsgLS1pJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgbWVtbyA9IGYoeCwgbWVtbyk7XG4gIH1cbiAgcmV0dXJuIG1lbW87XG59KTtcbmZvbGRyMSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHJldHVybiBmb2xkcihmLCB4c1t4cy5sZW5ndGggLSAxXSwgeHMuc2xpY2UoMCwgLTEpKTtcbn0pO1xudW5mb2xkciA9IGN1cnJ5JChmdW5jdGlvbihmLCBiKXtcbiAgdmFyIHJlc3VsdCwgeCwgdGhhdDtcbiAgcmVzdWx0ID0gW107XG4gIHggPSBiO1xuICB3aGlsZSAoKHRoYXQgPSBmKHgpKSAhPSBudWxsKSB7XG4gICAgcmVzdWx0LnB1c2godGhhdFswXSk7XG4gICAgeCA9IHRoYXRbMV07XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn0pO1xuY29uY2F0ID0gZnVuY3Rpb24oeHNzKXtcbiAgcmV0dXJuIFtdLmNvbmNhdC5hcHBseShbXSwgeHNzKTtcbn07XG5jb25jYXRNYXAgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgeDtcbiAgcmV0dXJuIFtdLmNvbmNhdC5hcHBseShbXSwgKGZ1bmN0aW9uKCl7XG4gICAgdmFyIGkkLCByZWYkLCBsZW4kLCByZXN1bHRzJCA9IFtdO1xuICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB4cykubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgIHggPSByZWYkW2kkXTtcbiAgICAgIHJlc3VsdHMkLnB1c2goZih4KSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzJDtcbiAgfSgpKSk7XG59KTtcbmZsYXR0ZW4gPSBmdW5jdGlvbih4cyl7XG4gIHZhciB4O1xuICByZXR1cm4gW10uY29uY2F0LmFwcGx5KFtdLCAoZnVuY3Rpb24oKXtcbiAgICB2YXIgaSQsIHJlZiQsIGxlbiQsIHJlc3VsdHMkID0gW107XG4gICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHhzKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgeCA9IHJlZiRbaSRdO1xuICAgICAgaWYgKHRvU3RyaW5nJC5jYWxsKHgpLnNsaWNlKDgsIC0xKSA9PT0gJ0FycmF5Jykge1xuICAgICAgICByZXN1bHRzJC5wdXNoKGZsYXR0ZW4oeCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0cyQucHVzaCh4KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHMkO1xuICB9KCkpKTtcbn07XG5kaWZmZXJlbmNlID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgeXNzLCByZXN1bHRzLCBpJCwgbGVuJCwgeCwgaiQsIGxlbjEkLCB5cztcbiAgeXNzID0gc2xpY2UkLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgcmVzdWx0cyA9IFtdO1xuICBvdXRlcjogZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgZm9yIChqJCA9IDAsIGxlbjEkID0geXNzLmxlbmd0aDsgaiQgPCBsZW4xJDsgKytqJCkge1xuICAgICAgeXMgPSB5c3NbaiRdO1xuICAgICAgaWYgKGluJCh4LCB5cykpIHtcbiAgICAgICAgY29udGludWUgb3V0ZXI7XG4gICAgICB9XG4gICAgfVxuICAgIHJlc3VsdHMucHVzaCh4KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cztcbn07XG5pbnRlcnNlY3Rpb24gPSBmdW5jdGlvbih4cyl7XG4gIHZhciB5c3MsIHJlc3VsdHMsIGkkLCBsZW4kLCB4LCBqJCwgbGVuMSQsIHlzO1xuICB5c3MgPSBzbGljZSQuY2FsbChhcmd1bWVudHMsIDEpO1xuICByZXN1bHRzID0gW107XG4gIG91dGVyOiBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBmb3IgKGokID0gMCwgbGVuMSQgPSB5c3MubGVuZ3RoOyBqJCA8IGxlbjEkOyArK2okKSB7XG4gICAgICB5cyA9IHlzc1tqJF07XG4gICAgICBpZiAoIWluJCh4LCB5cykpIHtcbiAgICAgICAgY29udGludWUgb3V0ZXI7XG4gICAgICB9XG4gICAgfVxuICAgIHJlc3VsdHMucHVzaCh4KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cztcbn07XG51bmlvbiA9IGZ1bmN0aW9uKCl7XG4gIHZhciB4c3MsIHJlc3VsdHMsIGkkLCBsZW4kLCB4cywgaiQsIGxlbjEkLCB4O1xuICB4c3MgPSBzbGljZSQuY2FsbChhcmd1bWVudHMpO1xuICByZXN1bHRzID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHNzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeHMgPSB4c3NbaSRdO1xuICAgIGZvciAoaiQgPSAwLCBsZW4xJCA9IHhzLmxlbmd0aDsgaiQgPCBsZW4xJDsgKytqJCkge1xuICAgICAgeCA9IHhzW2okXTtcbiAgICAgIGlmICghaW4kKHgsIHJlc3VsdHMpKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaCh4KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7XG59O1xuY291bnRCeSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciByZXN1bHRzLCBpJCwgbGVuJCwgeCwga2V5O1xuICByZXN1bHRzID0ge307XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGtleSA9IGYoeCk7XG4gICAgaWYgKGtleSBpbiByZXN1bHRzKSB7XG4gICAgICByZXN1bHRzW2tleV0gKz0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0c1trZXldID0gMTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7XG59KTtcbmdyb3VwQnkgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgcmVzdWx0cywgaSQsIGxlbiQsIHgsIGtleTtcbiAgcmVzdWx0cyA9IHt9O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBrZXkgPSBmKHgpO1xuICAgIGlmIChrZXkgaW4gcmVzdWx0cykge1xuICAgICAgcmVzdWx0c1trZXldLnB1c2goeCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdHNba2V5XSA9IFt4XTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7XG59KTtcbmFuZExpc3QgPSBmdW5jdGlvbih4cyl7XG4gIHZhciBpJCwgbGVuJCwgeDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKCF4KSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufTtcbm9yTGlzdCA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoeCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5hbnkgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIHg7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmIChmKHgpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufSk7XG5hbGwgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIHg7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmICghZih4KSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn0pO1xuc29ydCA9IGZ1bmN0aW9uKHhzKXtcbiAgcmV0dXJuIHhzLmNvbmNhdCgpLnNvcnQoZnVuY3Rpb24oeCwgeSl7XG4gICAgaWYgKHggPiB5KSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9IGVsc2UgaWYgKHggPCB5KSB7XG4gICAgICByZXR1cm4gLTE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfSk7XG59O1xuc29ydFdpdGggPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICByZXR1cm4geHMuY29uY2F0KCkuc29ydChmKTtcbn0pO1xuc29ydEJ5ID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgcmV0dXJuIHhzLmNvbmNhdCgpLnNvcnQoZnVuY3Rpb24oeCwgeSl7XG4gICAgaWYgKGYoeCkgPiBmKHkpKSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9IGVsc2UgaWYgKGYoeCkgPCBmKHkpKSB7XG4gICAgICByZXR1cm4gLTE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfSk7XG59KTtcbnN1bSA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIHJlc3VsdCwgaSQsIGxlbiQsIHg7XG4gIHJlc3VsdCA9IDA7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIHJlc3VsdCArPSB4O1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xucHJvZHVjdCA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIHJlc3VsdCwgaSQsIGxlbiQsIHg7XG4gIHJlc3VsdCA9IDE7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIHJlc3VsdCAqPSB4O1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xubWVhbiA9IGF2ZXJhZ2UgPSBmdW5jdGlvbih4cyl7XG4gIHZhciBzdW0sIGkkLCBsZW4kLCB4O1xuICBzdW0gPSAwO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBzdW0gKz0geDtcbiAgfVxuICByZXR1cm4gc3VtIC8geHMubGVuZ3RoO1xufTtcbm1heGltdW0gPSBmdW5jdGlvbih4cyl7XG4gIHZhciBtYXgsIGkkLCByZWYkLCBsZW4kLCB4O1xuICBtYXggPSB4c1swXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHhzLnNsaWNlKDEpKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSByZWYkW2kkXTtcbiAgICBpZiAoeCA+IG1heCkge1xuICAgICAgbWF4ID0geDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG1heDtcbn07XG5taW5pbXVtID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgbWluLCBpJCwgcmVmJCwgbGVuJCwgeDtcbiAgbWluID0geHNbMF07XG4gIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB4cy5zbGljZSgxKSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0gcmVmJFtpJF07XG4gICAgaWYgKHggPCBtaW4pIHtcbiAgICAgIG1pbiA9IHg7XG4gICAgfVxuICB9XG4gIHJldHVybiBtaW47XG59O1xubWF4aW11bUJ5ID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIG1heCwgaSQsIHJlZiQsIGxlbiQsIHg7XG4gIG1heCA9IHhzWzBdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0geHMuc2xpY2UoMSkpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHJlZiRbaSRdO1xuICAgIGlmIChmKHgpID4gZihtYXgpKSB7XG4gICAgICBtYXggPSB4O1xuICAgIH1cbiAgfVxuICByZXR1cm4gbWF4O1xufSk7XG5taW5pbXVtQnkgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgbWluLCBpJCwgcmVmJCwgbGVuJCwgeDtcbiAgbWluID0geHNbMF07XG4gIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB4cy5zbGljZSgxKSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0gcmVmJFtpJF07XG4gICAgaWYgKGYoeCkgPCBmKG1pbikpIHtcbiAgICAgIG1pbiA9IHg7XG4gICAgfVxuICB9XG4gIHJldHVybiBtaW47XG59KTtcbnNjYW4gPSBzY2FubCA9IGN1cnJ5JChmdW5jdGlvbihmLCBtZW1vLCB4cyl7XG4gIHZhciBsYXN0LCB4O1xuICBsYXN0ID0gbWVtbztcbiAgcmV0dXJuIFttZW1vXS5jb25jYXQoKGZ1bmN0aW9uKCl7XG4gICAgdmFyIGkkLCByZWYkLCBsZW4kLCByZXN1bHRzJCA9IFtdO1xuICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB4cykubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgIHggPSByZWYkW2kkXTtcbiAgICAgIHJlc3VsdHMkLnB1c2gobGFzdCA9IGYobGFzdCwgeCkpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cyQ7XG4gIH0oKSkpO1xufSk7XG5zY2FuMSA9IHNjYW5sMSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIGlmICgheHMubGVuZ3RoKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHJldHVybiBzY2FuKGYsIHhzWzBdLCB4cy5zbGljZSgxKSk7XG59KTtcbnNjYW5yID0gY3VycnkkKGZ1bmN0aW9uKGYsIG1lbW8sIHhzKXtcbiAgeHMgPSB4cy5jb25jYXQoKS5yZXZlcnNlKCk7XG4gIHJldHVybiBzY2FuKGYsIG1lbW8sIHhzKS5yZXZlcnNlKCk7XG59KTtcbnNjYW5yMSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIGlmICgheHMubGVuZ3RoKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHhzID0geHMuY29uY2F0KCkucmV2ZXJzZSgpO1xuICByZXR1cm4gc2NhbihmLCB4c1swXSwgeHMuc2xpY2UoMSkpLnJldmVyc2UoKTtcbn0pO1xuc2xpY2UgPSBjdXJyeSQoZnVuY3Rpb24oeCwgeSwgeHMpe1xuICByZXR1cm4geHMuc2xpY2UoeCwgeSk7XG59KTtcbnRha2UgPSBjdXJyeSQoZnVuY3Rpb24obiwgeHMpe1xuICBpZiAobiA8PSAwKSB7XG4gICAgcmV0dXJuIHhzLnNsaWNlKDAsIDApO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB4cy5zbGljZSgwLCBuKTtcbiAgfVxufSk7XG5kcm9wID0gY3VycnkkKGZ1bmN0aW9uKG4sIHhzKXtcbiAgaWYgKG4gPD0gMCkge1xuICAgIHJldHVybiB4cztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4geHMuc2xpY2Uobik7XG4gIH1cbn0pO1xuc3BsaXRBdCA9IGN1cnJ5JChmdW5jdGlvbihuLCB4cyl7XG4gIHJldHVybiBbdGFrZShuLCB4cyksIGRyb3AobiwgeHMpXTtcbn0pO1xudGFrZVdoaWxlID0gY3VycnkkKGZ1bmN0aW9uKHAsIHhzKXtcbiAgdmFyIGxlbiwgaTtcbiAgbGVuID0geHMubGVuZ3RoO1xuICBpZiAoIWxlbikge1xuICAgIHJldHVybiB4cztcbiAgfVxuICBpID0gMDtcbiAgd2hpbGUgKGkgPCBsZW4gJiYgcCh4c1tpXSkpIHtcbiAgICBpICs9IDE7XG4gIH1cbiAgcmV0dXJuIHhzLnNsaWNlKDAsIGkpO1xufSk7XG5kcm9wV2hpbGUgPSBjdXJyeSQoZnVuY3Rpb24ocCwgeHMpe1xuICB2YXIgbGVuLCBpO1xuICBsZW4gPSB4cy5sZW5ndGg7XG4gIGlmICghbGVuKSB7XG4gICAgcmV0dXJuIHhzO1xuICB9XG4gIGkgPSAwO1xuICB3aGlsZSAoaSA8IGxlbiAmJiBwKHhzW2ldKSkge1xuICAgIGkgKz0gMTtcbiAgfVxuICByZXR1cm4geHMuc2xpY2UoaSk7XG59KTtcbnNwYW4gPSBjdXJyeSQoZnVuY3Rpb24ocCwgeHMpe1xuICByZXR1cm4gW3Rha2VXaGlsZShwLCB4cyksIGRyb3BXaGlsZShwLCB4cyldO1xufSk7XG5icmVha0xpc3QgPSBjdXJyeSQoZnVuY3Rpb24ocCwgeHMpe1xuICByZXR1cm4gc3BhbihmdW5jdGlvbigpe1xuICAgIHJldHVybiBub3QkKHAuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gIH0sIHhzKTtcbn0pO1xuemlwID0gY3VycnkkKGZ1bmN0aW9uKHhzLCB5cyl7XG4gIHZhciByZXN1bHQsIGxlbiwgaSQsIGxlbiQsIGksIHg7XG4gIHJlc3VsdCA9IFtdO1xuICBsZW4gPSB5cy5sZW5ndGg7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICBpID0gaSQ7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoaSA9PT0gbGVuKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgcmVzdWx0LnB1c2goW3gsIHlzW2ldXSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn0pO1xuemlwV2l0aCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cywgeXMpe1xuICB2YXIgcmVzdWx0LCBsZW4sIGkkLCBsZW4kLCBpLCB4O1xuICByZXN1bHQgPSBbXTtcbiAgbGVuID0geXMubGVuZ3RoO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKGkgPT09IGxlbikge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJlc3VsdC5wdXNoKGYoeCwgeXNbaV0pKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufSk7XG56aXBBbGwgPSBmdW5jdGlvbigpe1xuICB2YXIgeHNzLCBtaW5MZW5ndGgsIGkkLCBsZW4kLCB4cywgcmVmJCwgaSwgbHJlc3VsdCQsIGokLCByZXN1bHRzJCA9IFtdO1xuICB4c3MgPSBzbGljZSQuY2FsbChhcmd1bWVudHMpO1xuICBtaW5MZW5ndGggPSA5ZTk7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHNzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeHMgPSB4c3NbaSRdO1xuICAgIG1pbkxlbmd0aCA8PSAocmVmJCA9IHhzLmxlbmd0aCkgfHwgKG1pbkxlbmd0aCA9IHJlZiQpO1xuICB9XG4gIGZvciAoaSQgPSAwOyBpJCA8IG1pbkxlbmd0aDsgKytpJCkge1xuICAgIGkgPSBpJDtcbiAgICBscmVzdWx0JCA9IFtdO1xuICAgIGZvciAoaiQgPSAwLCBsZW4kID0geHNzLmxlbmd0aDsgaiQgPCBsZW4kOyArK2okKSB7XG4gICAgICB4cyA9IHhzc1tqJF07XG4gICAgICBscmVzdWx0JC5wdXNoKHhzW2ldKTtcbiAgICB9XG4gICAgcmVzdWx0cyQucHVzaChscmVzdWx0JCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufTtcbnppcEFsbFdpdGggPSBmdW5jdGlvbihmKXtcbiAgdmFyIHhzcywgbWluTGVuZ3RoLCBpJCwgbGVuJCwgeHMsIHJlZiQsIGksIHJlc3VsdHMkID0gW107XG4gIHhzcyA9IHNsaWNlJC5jYWxsKGFyZ3VtZW50cywgMSk7XG4gIG1pbkxlbmd0aCA9IDllOTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4c3MubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4cyA9IHhzc1tpJF07XG4gICAgbWluTGVuZ3RoIDw9IChyZWYkID0geHMubGVuZ3RoKSB8fCAobWluTGVuZ3RoID0gcmVmJCk7XG4gIH1cbiAgZm9yIChpJCA9IDA7IGkkIDwgbWluTGVuZ3RoOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIHJlc3VsdHMkLnB1c2goZi5hcHBseShudWxsLCAoZm4kKCkpKSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xuICBmdW5jdGlvbiBmbiQoKXtcbiAgICB2YXIgaSQsIHJlZiQsIGxlbiQsIHJlc3VsdHMkID0gW107XG4gICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHhzcykubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgIHhzID0gcmVmJFtpJF07XG4gICAgICByZXN1bHRzJC5wdXNoKHhzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHMkO1xuICB9XG59O1xuYXQgPSBjdXJyeSQoZnVuY3Rpb24obiwgeHMpe1xuICBpZiAobiA8IDApIHtcbiAgICByZXR1cm4geHNbeHMubGVuZ3RoICsgbl07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHhzW25dO1xuICB9XG59KTtcbmVsZW1JbmRleCA9IGN1cnJ5JChmdW5jdGlvbihlbCwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIGksIHg7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICBpID0gaSQ7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoeCA9PT0gZWwpIHtcbiAgICAgIHJldHVybiBpO1xuICAgIH1cbiAgfVxufSk7XG5lbGVtSW5kaWNlcyA9IGN1cnJ5JChmdW5jdGlvbihlbCwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIGksIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICBpID0gaSQ7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoeCA9PT0gZWwpIHtcbiAgICAgIHJlc3VsdHMkLnB1c2goaSk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xuZmluZEluZGV4ID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCBpLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKGYoeCkpIHtcbiAgICAgIHJldHVybiBpO1xuICAgIH1cbiAgfVxufSk7XG5maW5kSW5kaWNlcyA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgaSwgeCwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIGkgPSBpJDtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmIChmKHgpKSB7XG4gICAgICByZXN1bHRzJC5wdXNoKGkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbm1vZHVsZS5leHBvcnRzID0ge1xuICBlYWNoOiBlYWNoLFxuICBtYXA6IG1hcCxcbiAgZmlsdGVyOiBmaWx0ZXIsXG4gIGNvbXBhY3Q6IGNvbXBhY3QsXG4gIHJlamVjdDogcmVqZWN0LFxuICBwYXJ0aXRpb246IHBhcnRpdGlvbixcbiAgZmluZDogZmluZCxcbiAgaGVhZDogaGVhZCxcbiAgZmlyc3Q6IGZpcnN0LFxuICB0YWlsOiB0YWlsLFxuICBsYXN0OiBsYXN0LFxuICBpbml0aWFsOiBpbml0aWFsLFxuICBlbXB0eTogZW1wdHksXG4gIHJldmVyc2U6IHJldmVyc2UsXG4gIGRpZmZlcmVuY2U6IGRpZmZlcmVuY2UsXG4gIGludGVyc2VjdGlvbjogaW50ZXJzZWN0aW9uLFxuICB1bmlvbjogdW5pb24sXG4gIGNvdW50Qnk6IGNvdW50QnksXG4gIGdyb3VwQnk6IGdyb3VwQnksXG4gIGZvbGQ6IGZvbGQsXG4gIGZvbGQxOiBmb2xkMSxcbiAgZm9sZGw6IGZvbGRsLFxuICBmb2xkbDE6IGZvbGRsMSxcbiAgZm9sZHI6IGZvbGRyLFxuICBmb2xkcjE6IGZvbGRyMSxcbiAgdW5mb2xkcjogdW5mb2xkcixcbiAgYW5kTGlzdDogYW5kTGlzdCxcbiAgb3JMaXN0OiBvckxpc3QsXG4gIGFueTogYW55LFxuICBhbGw6IGFsbCxcbiAgdW5pcXVlOiB1bmlxdWUsXG4gIHVuaXF1ZUJ5OiB1bmlxdWVCeSxcbiAgc29ydDogc29ydCxcbiAgc29ydFdpdGg6IHNvcnRXaXRoLFxuICBzb3J0Qnk6IHNvcnRCeSxcbiAgc3VtOiBzdW0sXG4gIHByb2R1Y3Q6IHByb2R1Y3QsXG4gIG1lYW46IG1lYW4sXG4gIGF2ZXJhZ2U6IGF2ZXJhZ2UsXG4gIGNvbmNhdDogY29uY2F0LFxuICBjb25jYXRNYXA6IGNvbmNhdE1hcCxcbiAgZmxhdHRlbjogZmxhdHRlbixcbiAgbWF4aW11bTogbWF4aW11bSxcbiAgbWluaW11bTogbWluaW11bSxcbiAgbWF4aW11bUJ5OiBtYXhpbXVtQnksXG4gIG1pbmltdW1CeTogbWluaW11bUJ5LFxuICBzY2FuOiBzY2FuLFxuICBzY2FuMTogc2NhbjEsXG4gIHNjYW5sOiBzY2FubCxcbiAgc2NhbmwxOiBzY2FubDEsXG4gIHNjYW5yOiBzY2FucixcbiAgc2NhbnIxOiBzY2FucjEsXG4gIHNsaWNlOiBzbGljZSxcbiAgdGFrZTogdGFrZSxcbiAgZHJvcDogZHJvcCxcbiAgc3BsaXRBdDogc3BsaXRBdCxcbiAgdGFrZVdoaWxlOiB0YWtlV2hpbGUsXG4gIGRyb3BXaGlsZTogZHJvcFdoaWxlLFxuICBzcGFuOiBzcGFuLFxuICBicmVha0xpc3Q6IGJyZWFrTGlzdCxcbiAgemlwOiB6aXAsXG4gIHppcFdpdGg6IHppcFdpdGgsXG4gIHppcEFsbDogemlwQWxsLFxuICB6aXBBbGxXaXRoOiB6aXBBbGxXaXRoLFxuICBhdDogYXQsXG4gIGVsZW1JbmRleDogZWxlbUluZGV4LFxuICBlbGVtSW5kaWNlczogZWxlbUluZGljZXMsXG4gIGZpbmRJbmRleDogZmluZEluZGV4LFxuICBmaW5kSW5kaWNlczogZmluZEluZGljZXNcbn07XG5mdW5jdGlvbiBjdXJyeSQoZiwgYm91bmQpe1xuICB2YXIgY29udGV4dCxcbiAgX2N1cnJ5ID0gZnVuY3Rpb24oYXJncykge1xuICAgIHJldHVybiBmLmxlbmd0aCA+IDEgPyBmdW5jdGlvbigpe1xuICAgICAgdmFyIHBhcmFtcyA9IGFyZ3MgPyBhcmdzLmNvbmNhdCgpIDogW107XG4gICAgICBjb250ZXh0ID0gYm91bmQgPyBjb250ZXh0IHx8IHRoaXMgOiB0aGlzO1xuICAgICAgcmV0dXJuIHBhcmFtcy5wdXNoLmFwcGx5KHBhcmFtcywgYXJndW1lbnRzKSA8XG4gICAgICAgICAgZi5sZW5ndGggJiYgYXJndW1lbnRzLmxlbmd0aCA/XG4gICAgICAgIF9jdXJyeS5jYWxsKGNvbnRleHQsIHBhcmFtcykgOiBmLmFwcGx5KGNvbnRleHQsIHBhcmFtcyk7XG4gICAgfSA6IGY7XG4gIH07XG4gIHJldHVybiBfY3VycnkoKTtcbn1cbmZ1bmN0aW9uIGluJCh4LCB4cyl7XG4gIHZhciBpID0gLTEsIGwgPSB4cy5sZW5ndGggPj4+IDA7XG4gIHdoaWxlICgrK2kgPCBsKSBpZiAoeCA9PT0geHNbaV0pIHJldHVybiB0cnVlO1xuICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBub3QkKHgpeyByZXR1cm4gIXg7IH0iLCIvLyBHZW5lcmF0ZWQgYnkgTGl2ZVNjcmlwdCAxLjIuMFxudmFyIG1heCwgbWluLCBuZWdhdGUsIGFicywgc2lnbnVtLCBxdW90LCByZW0sIGRpdiwgbW9kLCByZWNpcCwgcGksIHRhdSwgZXhwLCBzcXJ0LCBsbiwgcG93LCBzaW4sIHRhbiwgY29zLCBhc2luLCBhY29zLCBhdGFuLCBhdGFuMiwgdHJ1bmNhdGUsIHJvdW5kLCBjZWlsaW5nLCBmbG9vciwgaXNJdE5hTiwgZXZlbiwgb2RkLCBnY2QsIGxjbTtcbm1heCA9IGN1cnJ5JChmdW5jdGlvbih4JCwgeSQpe1xuICByZXR1cm4geCQgPiB5JCA/IHgkIDogeSQ7XG59KTtcbm1pbiA9IGN1cnJ5JChmdW5jdGlvbih4JCwgeSQpe1xuICByZXR1cm4geCQgPCB5JCA/IHgkIDogeSQ7XG59KTtcbm5lZ2F0ZSA9IGZ1bmN0aW9uKHgpe1xuICByZXR1cm4gLXg7XG59O1xuYWJzID0gTWF0aC5hYnM7XG5zaWdudW0gPSBmdW5jdGlvbih4KXtcbiAgaWYgKHggPCAwKSB7XG4gICAgcmV0dXJuIC0xO1xuICB9IGVsc2UgaWYgKHggPiAwKSB7XG4gICAgcmV0dXJuIDE7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cbn07XG5xdW90ID0gY3VycnkkKGZ1bmN0aW9uKHgsIHkpe1xuICByZXR1cm4gfn4oeCAvIHkpO1xufSk7XG5yZW0gPSBjdXJyeSQoZnVuY3Rpb24oeCQsIHkkKXtcbiAgcmV0dXJuIHgkICUgeSQ7XG59KTtcbmRpdiA9IGN1cnJ5JChmdW5jdGlvbih4LCB5KXtcbiAgcmV0dXJuIE1hdGguZmxvb3IoeCAvIHkpO1xufSk7XG5tb2QgPSBjdXJyeSQoZnVuY3Rpb24oeCQsIHkkKXtcbiAgdmFyIHJlZiQ7XG4gIHJldHVybiAoKHgkKSAlIChyZWYkID0geSQpICsgcmVmJCkgJSByZWYkO1xufSk7XG5yZWNpcCA9IChmdW5jdGlvbihpdCl7XG4gIHJldHVybiAxIC8gaXQ7XG59KTtcbnBpID0gTWF0aC5QSTtcbnRhdSA9IHBpICogMjtcbmV4cCA9IE1hdGguZXhwO1xuc3FydCA9IE1hdGguc3FydDtcbmxuID0gTWF0aC5sb2c7XG5wb3cgPSBjdXJyeSQoZnVuY3Rpb24oeCQsIHkkKXtcbiAgcmV0dXJuIE1hdGgucG93KHgkLCB5JCk7XG59KTtcbnNpbiA9IE1hdGguc2luO1xudGFuID0gTWF0aC50YW47XG5jb3MgPSBNYXRoLmNvcztcbmFzaW4gPSBNYXRoLmFzaW47XG5hY29zID0gTWF0aC5hY29zO1xuYXRhbiA9IE1hdGguYXRhbjtcbmF0YW4yID0gY3VycnkkKGZ1bmN0aW9uKHgsIHkpe1xuICByZXR1cm4gTWF0aC5hdGFuMih4LCB5KTtcbn0pO1xudHJ1bmNhdGUgPSBmdW5jdGlvbih4KXtcbiAgcmV0dXJuIH5+eDtcbn07XG5yb3VuZCA9IE1hdGgucm91bmQ7XG5jZWlsaW5nID0gTWF0aC5jZWlsO1xuZmxvb3IgPSBNYXRoLmZsb29yO1xuaXNJdE5hTiA9IGZ1bmN0aW9uKHgpe1xuICByZXR1cm4geCAhPT0geDtcbn07XG5ldmVuID0gZnVuY3Rpb24oeCl7XG4gIHJldHVybiB4ICUgMiA9PT0gMDtcbn07XG5vZGQgPSBmdW5jdGlvbih4KXtcbiAgcmV0dXJuIHggJSAyICE9PSAwO1xufTtcbmdjZCA9IGN1cnJ5JChmdW5jdGlvbih4LCB5KXtcbiAgdmFyIHo7XG4gIHggPSBNYXRoLmFicyh4KTtcbiAgeSA9IE1hdGguYWJzKHkpO1xuICB3aGlsZSAoeSAhPT0gMCkge1xuICAgIHogPSB4ICUgeTtcbiAgICB4ID0geTtcbiAgICB5ID0gejtcbiAgfVxuICByZXR1cm4geDtcbn0pO1xubGNtID0gY3VycnkkKGZ1bmN0aW9uKHgsIHkpe1xuICByZXR1cm4gTWF0aC5hYnMoTWF0aC5mbG9vcih4IC8gZ2NkKHgsIHkpICogeSkpO1xufSk7XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgbWF4OiBtYXgsXG4gIG1pbjogbWluLFxuICBuZWdhdGU6IG5lZ2F0ZSxcbiAgYWJzOiBhYnMsXG4gIHNpZ251bTogc2lnbnVtLFxuICBxdW90OiBxdW90LFxuICByZW06IHJlbSxcbiAgZGl2OiBkaXYsXG4gIG1vZDogbW9kLFxuICByZWNpcDogcmVjaXAsXG4gIHBpOiBwaSxcbiAgdGF1OiB0YXUsXG4gIGV4cDogZXhwLFxuICBzcXJ0OiBzcXJ0LFxuICBsbjogbG4sXG4gIHBvdzogcG93LFxuICBzaW46IHNpbixcbiAgdGFuOiB0YW4sXG4gIGNvczogY29zLFxuICBhY29zOiBhY29zLFxuICBhc2luOiBhc2luLFxuICBhdGFuOiBhdGFuLFxuICBhdGFuMjogYXRhbjIsXG4gIHRydW5jYXRlOiB0cnVuY2F0ZSxcbiAgcm91bmQ6IHJvdW5kLFxuICBjZWlsaW5nOiBjZWlsaW5nLFxuICBmbG9vcjogZmxvb3IsXG4gIGlzSXROYU46IGlzSXROYU4sXG4gIGV2ZW46IGV2ZW4sXG4gIG9kZDogb2RkLFxuICBnY2Q6IGdjZCxcbiAgbGNtOiBsY21cbn07XG5mdW5jdGlvbiBjdXJyeSQoZiwgYm91bmQpe1xuICB2YXIgY29udGV4dCxcbiAgX2N1cnJ5ID0gZnVuY3Rpb24oYXJncykge1xuICAgIHJldHVybiBmLmxlbmd0aCA+IDEgPyBmdW5jdGlvbigpe1xuICAgICAgdmFyIHBhcmFtcyA9IGFyZ3MgPyBhcmdzLmNvbmNhdCgpIDogW107XG4gICAgICBjb250ZXh0ID0gYm91bmQgPyBjb250ZXh0IHx8IHRoaXMgOiB0aGlzO1xuICAgICAgcmV0dXJuIHBhcmFtcy5wdXNoLmFwcGx5KHBhcmFtcywgYXJndW1lbnRzKSA8XG4gICAgICAgICAgZi5sZW5ndGggJiYgYXJndW1lbnRzLmxlbmd0aCA/XG4gICAgICAgIF9jdXJyeS5jYWxsKGNvbnRleHQsIHBhcmFtcykgOiBmLmFwcGx5KGNvbnRleHQsIHBhcmFtcyk7XG4gICAgfSA6IGY7XG4gIH07XG4gIHJldHVybiBfY3VycnkoKTtcbn0iLCIvLyBHZW5lcmF0ZWQgYnkgTGl2ZVNjcmlwdCAxLjIuMFxudmFyIHZhbHVlcywga2V5cywgcGFpcnNUb09iaiwgb2JqVG9QYWlycywgbGlzdHNUb09iaiwgb2JqVG9MaXN0cywgZW1wdHksIGVhY2gsIG1hcCwgY29tcGFjdCwgZmlsdGVyLCByZWplY3QsIHBhcnRpdGlvbiwgZmluZDtcbnZhbHVlcyA9IGZ1bmN0aW9uKG9iamVjdCl7XG4gIHZhciBpJCwgeCwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChpJCBpbiBvYmplY3QpIHtcbiAgICB4ID0gb2JqZWN0W2kkXTtcbiAgICByZXN1bHRzJC5wdXNoKHgpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn07XG5rZXlzID0gZnVuY3Rpb24ob2JqZWN0KXtcbiAgdmFyIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoeCBpbiBvYmplY3QpIHtcbiAgICByZXN1bHRzJC5wdXNoKHgpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn07XG5wYWlyc1RvT2JqID0gZnVuY3Rpb24ob2JqZWN0KXtcbiAgdmFyIGkkLCBsZW4kLCB4LCByZXN1bHRzJCA9IHt9O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IG9iamVjdC5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSBvYmplY3RbaSRdO1xuICAgIHJlc3VsdHMkW3hbMF1dID0geFsxXTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59O1xub2JqVG9QYWlycyA9IGZ1bmN0aW9uKG9iamVjdCl7XG4gIHZhciBrZXksIHZhbHVlLCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGtleSBpbiBvYmplY3QpIHtcbiAgICB2YWx1ZSA9IG9iamVjdFtrZXldO1xuICAgIHJlc3VsdHMkLnB1c2goW2tleSwgdmFsdWVdKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59O1xubGlzdHNUb09iaiA9IGN1cnJ5JChmdW5jdGlvbihrZXlzLCB2YWx1ZXMpe1xuICB2YXIgaSQsIGxlbiQsIGksIGtleSwgcmVzdWx0cyQgPSB7fTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSBrZXlzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIGtleSA9IGtleXNbaSRdO1xuICAgIHJlc3VsdHMkW2tleV0gPSB2YWx1ZXNbaV07XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufSk7XG5vYmpUb0xpc3RzID0gZnVuY3Rpb24ob2JqZWN0KXtcbiAgdmFyIGtleXMsIHZhbHVlcywga2V5LCB2YWx1ZTtcbiAga2V5cyA9IFtdO1xuICB2YWx1ZXMgPSBbXTtcbiAgZm9yIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgdmFsdWUgPSBvYmplY3Rba2V5XTtcbiAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB2YWx1ZXMucHVzaCh2YWx1ZSk7XG4gIH1cbiAgcmV0dXJuIFtrZXlzLCB2YWx1ZXNdO1xufTtcbmVtcHR5ID0gZnVuY3Rpb24ob2JqZWN0KXtcbiAgdmFyIHg7XG4gIGZvciAoeCBpbiBvYmplY3QpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59O1xuZWFjaCA9IGN1cnJ5JChmdW5jdGlvbihmLCBvYmplY3Qpe1xuICB2YXIgaSQsIHg7XG4gIGZvciAoaSQgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtpJF07XG4gICAgZih4KTtcbiAgfVxuICByZXR1cm4gb2JqZWN0O1xufSk7XG5tYXAgPSBjdXJyeSQoZnVuY3Rpb24oZiwgb2JqZWN0KXtcbiAgdmFyIGssIHgsIHJlc3VsdHMkID0ge307XG4gIGZvciAoayBpbiBvYmplY3QpIHtcbiAgICB4ID0gb2JqZWN0W2tdO1xuICAgIHJlc3VsdHMkW2tdID0gZih4KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbmNvbXBhY3QgPSBmdW5jdGlvbihvYmplY3Qpe1xuICB2YXIgaywgeCwgcmVzdWx0cyQgPSB7fTtcbiAgZm9yIChrIGluIG9iamVjdCkge1xuICAgIHggPSBvYmplY3Rba107XG5pZiAoeCkge1xuICAgICAgcmVzdWx0cyRba10gPSB4O1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59O1xuZmlsdGVyID0gY3VycnkkKGZ1bmN0aW9uKGYsIG9iamVjdCl7XG4gIHZhciBrLCB4LCByZXN1bHRzJCA9IHt9O1xuICBmb3IgKGsgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtrXTtcbmlmIChmKHgpKSB7XG4gICAgICByZXN1bHRzJFtrXSA9IHg7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xucmVqZWN0ID0gY3VycnkkKGZ1bmN0aW9uKGYsIG9iamVjdCl7XG4gIHZhciBrLCB4LCByZXN1bHRzJCA9IHt9O1xuICBmb3IgKGsgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtrXTtcbmlmICghZih4KSkge1xuICAgICAgcmVzdWx0cyRba10gPSB4O1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbnBhcnRpdGlvbiA9IGN1cnJ5JChmdW5jdGlvbihmLCBvYmplY3Qpe1xuICB2YXIgcGFzc2VkLCBmYWlsZWQsIGssIHg7XG4gIHBhc3NlZCA9IHt9O1xuICBmYWlsZWQgPSB7fTtcbiAgZm9yIChrIGluIG9iamVjdCkge1xuICAgIHggPSBvYmplY3Rba107XG4gICAgKGYoeCkgPyBwYXNzZWQgOiBmYWlsZWQpW2tdID0geDtcbiAgfVxuICByZXR1cm4gW3Bhc3NlZCwgZmFpbGVkXTtcbn0pO1xuZmluZCA9IGN1cnJ5JChmdW5jdGlvbihmLCBvYmplY3Qpe1xuICB2YXIgaSQsIHg7XG4gIGZvciAoaSQgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtpJF07XG4gICAgaWYgKGYoeCkpIHtcbiAgICAgIHJldHVybiB4O1xuICAgIH1cbiAgfVxufSk7XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmFsdWVzOiB2YWx1ZXMsXG4gIGtleXM6IGtleXMsXG4gIHBhaXJzVG9PYmo6IHBhaXJzVG9PYmosXG4gIG9ialRvUGFpcnM6IG9ialRvUGFpcnMsXG4gIGxpc3RzVG9PYmo6IGxpc3RzVG9PYmosXG4gIG9ialRvTGlzdHM6IG9ialRvTGlzdHMsXG4gIGVtcHR5OiBlbXB0eSxcbiAgZWFjaDogZWFjaCxcbiAgbWFwOiBtYXAsXG4gIGZpbHRlcjogZmlsdGVyLFxuICBjb21wYWN0OiBjb21wYWN0LFxuICByZWplY3Q6IHJlamVjdCxcbiAgcGFydGl0aW9uOiBwYXJ0aXRpb24sXG4gIGZpbmQ6IGZpbmRcbn07XG5mdW5jdGlvbiBjdXJyeSQoZiwgYm91bmQpe1xuICB2YXIgY29udGV4dCxcbiAgX2N1cnJ5ID0gZnVuY3Rpb24oYXJncykge1xuICAgIHJldHVybiBmLmxlbmd0aCA+IDEgPyBmdW5jdGlvbigpe1xuICAgICAgdmFyIHBhcmFtcyA9IGFyZ3MgPyBhcmdzLmNvbmNhdCgpIDogW107XG4gICAgICBjb250ZXh0ID0gYm91bmQgPyBjb250ZXh0IHx8IHRoaXMgOiB0aGlzO1xuICAgICAgcmV0dXJuIHBhcmFtcy5wdXNoLmFwcGx5KHBhcmFtcywgYXJndW1lbnRzKSA8XG4gICAgICAgICAgZi5sZW5ndGggJiYgYXJndW1lbnRzLmxlbmd0aCA/XG4gICAgICAgIF9jdXJyeS5jYWxsKGNvbnRleHQsIHBhcmFtcykgOiBmLmFwcGx5KGNvbnRleHQsIHBhcmFtcyk7XG4gICAgfSA6IGY7XG4gIH07XG4gIHJldHVybiBfY3VycnkoKTtcbn0iLCIvLyBHZW5lcmF0ZWQgYnkgTGl2ZVNjcmlwdCAxLjIuMFxudmFyIHNwbGl0LCBqb2luLCBsaW5lcywgdW5saW5lcywgd29yZHMsIHVud29yZHMsIGNoYXJzLCB1bmNoYXJzLCByZXZlcnNlLCByZXBlYXQsIGNhcGl0YWxpemUsIGNhbWVsaXplLCBkYXNoZXJpemU7XG5zcGxpdCA9IGN1cnJ5JChmdW5jdGlvbihzZXAsIHN0cil7XG4gIHJldHVybiBzdHIuc3BsaXQoc2VwKTtcbn0pO1xuam9pbiA9IGN1cnJ5JChmdW5jdGlvbihzZXAsIHhzKXtcbiAgcmV0dXJuIHhzLmpvaW4oc2VwKTtcbn0pO1xubGluZXMgPSBmdW5jdGlvbihzdHIpe1xuICBpZiAoIXN0ci5sZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgcmV0dXJuIHN0ci5zcGxpdCgnXFxuJyk7XG59O1xudW5saW5lcyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGl0LmpvaW4oJ1xcbicpO1xufTtcbndvcmRzID0gZnVuY3Rpb24oc3RyKXtcbiAgaWYgKCFzdHIubGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHJldHVybiBzdHIuc3BsaXQoL1sgXSsvKTtcbn07XG51bndvcmRzID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXQuam9pbignICcpO1xufTtcbmNoYXJzID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXQuc3BsaXQoJycpO1xufTtcbnVuY2hhcnMgPSBmdW5jdGlvbihpdCl7XG4gIHJldHVybiBpdC5qb2luKCcnKTtcbn07XG5yZXZlcnNlID0gZnVuY3Rpb24oc3RyKXtcbiAgcmV0dXJuIHN0ci5zcGxpdCgnJykucmV2ZXJzZSgpLmpvaW4oJycpO1xufTtcbnJlcGVhdCA9IGN1cnJ5JChmdW5jdGlvbihuLCBzdHIpe1xuICB2YXIgcmVzdWx0LCBpJDtcbiAgcmVzdWx0ID0gJyc7XG4gIGZvciAoaSQgPSAwOyBpJCA8IG47ICsraSQpIHtcbiAgICByZXN1bHQgKz0gc3RyO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59KTtcbmNhcGl0YWxpemUgPSBmdW5jdGlvbihzdHIpe1xuICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpO1xufTtcbmNhbWVsaXplID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXQucmVwbGFjZSgvWy1fXSsoLik/L2csIGZ1bmN0aW9uKGFyZyQsIGMpe1xuICAgIHJldHVybiAoYyAhPSBudWxsID8gYyA6ICcnKS50b1VwcGVyQ2FzZSgpO1xuICB9KTtcbn07XG5kYXNoZXJpemUgPSBmdW5jdGlvbihzdHIpe1xuICByZXR1cm4gc3RyLnJlcGxhY2UoLyhbXi1BLVpdKShbQS1aXSspL2csIGZ1bmN0aW9uKGFyZyQsIGxvd2VyLCB1cHBlcil7XG4gICAgcmV0dXJuIGxvd2VyICsgXCItXCIgKyAodXBwZXIubGVuZ3RoID4gMVxuICAgICAgPyB1cHBlclxuICAgICAgOiB1cHBlci50b0xvd2VyQ2FzZSgpKTtcbiAgfSkucmVwbGFjZSgvXihbQS1aXSspLywgZnVuY3Rpb24oYXJnJCwgdXBwZXIpe1xuICAgIGlmICh1cHBlci5sZW5ndGggPiAxKSB7XG4gICAgICByZXR1cm4gdXBwZXIgKyBcIi1cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHVwcGVyLnRvTG93ZXJDYXNlKCk7XG4gICAgfVxuICB9KTtcbn07XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc3BsaXQ6IHNwbGl0LFxuICBqb2luOiBqb2luLFxuICBsaW5lczogbGluZXMsXG4gIHVubGluZXM6IHVubGluZXMsXG4gIHdvcmRzOiB3b3JkcyxcbiAgdW53b3JkczogdW53b3JkcyxcbiAgY2hhcnM6IGNoYXJzLFxuICB1bmNoYXJzOiB1bmNoYXJzLFxuICByZXZlcnNlOiByZXZlcnNlLFxuICByZXBlYXQ6IHJlcGVhdCxcbiAgY2FwaXRhbGl6ZTogY2FwaXRhbGl6ZSxcbiAgY2FtZWxpemU6IGNhbWVsaXplLFxuICBkYXNoZXJpemU6IGRhc2hlcml6ZVxufTtcbmZ1bmN0aW9uIGN1cnJ5JChmLCBib3VuZCl7XG4gIHZhciBjb250ZXh0LFxuICBfY3VycnkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIGYubGVuZ3RoID4gMSA/IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGFyYW1zID0gYXJncyA/IGFyZ3MuY29uY2F0KCkgOiBbXTtcbiAgICAgIGNvbnRleHQgPSBib3VuZCA/IGNvbnRleHQgfHwgdGhpcyA6IHRoaXM7XG4gICAgICByZXR1cm4gcGFyYW1zLnB1c2guYXBwbHkocGFyYW1zLCBhcmd1bWVudHMpIDxcbiAgICAgICAgICBmLmxlbmd0aCAmJiBhcmd1bWVudHMubGVuZ3RoID9cbiAgICAgICAgX2N1cnJ5LmNhbGwoY29udGV4dCwgcGFyYW1zKSA6IGYuYXBwbHkoY29udGV4dCwgcGFyYW1zKTtcbiAgICB9IDogZjtcbiAgfTtcbiAgcmV0dXJuIF9jdXJyeSgpO1xufSIsIi8vIEdlbmVyYXRlZCBieSBMaXZlU2NyaXB0IDEuMi4wXG52YXIgRnVuYywgTGlzdCwgT2JqLCBTdHIsIE51bSwgaWQsIGlzVHlwZSwgcmVwbGljYXRlLCBwcmVsdWRlLCB0b1N0cmluZyQgPSB7fS50b1N0cmluZztcbkZ1bmMgPSByZXF1aXJlKCcuL0Z1bmMuanMnKTtcbkxpc3QgPSByZXF1aXJlKCcuL0xpc3QuanMnKTtcbk9iaiA9IHJlcXVpcmUoJy4vT2JqLmpzJyk7XG5TdHIgPSByZXF1aXJlKCcuL1N0ci5qcycpO1xuTnVtID0gcmVxdWlyZSgnLi9OdW0uanMnKTtcbmlkID0gZnVuY3Rpb24oeCl7XG4gIHJldHVybiB4O1xufTtcbmlzVHlwZSA9IGN1cnJ5JChmdW5jdGlvbih0eXBlLCB4KXtcbiAgcmV0dXJuIHRvU3RyaW5nJC5jYWxsKHgpLnNsaWNlKDgsIC0xKSA9PT0gdHlwZTtcbn0pO1xucmVwbGljYXRlID0gY3VycnkkKGZ1bmN0aW9uKG4sIHgpe1xuICB2YXIgaSQsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgPSAwOyBpJCA8IG47ICsraSQpIHtcbiAgICByZXN1bHRzJC5wdXNoKHgpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xuU3RyLmVtcHR5ID0gTGlzdC5lbXB0eTtcblN0ci5zbGljZSA9IExpc3Quc2xpY2U7XG5TdHIudGFrZSA9IExpc3QudGFrZTtcblN0ci5kcm9wID0gTGlzdC5kcm9wO1xuU3RyLnNwbGl0QXQgPSBMaXN0LnNwbGl0QXQ7XG5TdHIudGFrZVdoaWxlID0gTGlzdC50YWtlV2hpbGU7XG5TdHIuZHJvcFdoaWxlID0gTGlzdC5kcm9wV2hpbGU7XG5TdHIuc3BhbiA9IExpc3Quc3BhbjtcblN0ci5icmVha1N0ciA9IExpc3QuYnJlYWtMaXN0O1xucHJlbHVkZSA9IHtcbiAgRnVuYzogRnVuYyxcbiAgTGlzdDogTGlzdCxcbiAgT2JqOiBPYmosXG4gIFN0cjogU3RyLFxuICBOdW06IE51bSxcbiAgaWQ6IGlkLFxuICBpc1R5cGU6IGlzVHlwZSxcbiAgcmVwbGljYXRlOiByZXBsaWNhdGVcbn07XG5wcmVsdWRlLmVhY2ggPSBMaXN0LmVhY2g7XG5wcmVsdWRlLm1hcCA9IExpc3QubWFwO1xucHJlbHVkZS5maWx0ZXIgPSBMaXN0LmZpbHRlcjtcbnByZWx1ZGUuY29tcGFjdCA9IExpc3QuY29tcGFjdDtcbnByZWx1ZGUucmVqZWN0ID0gTGlzdC5yZWplY3Q7XG5wcmVsdWRlLnBhcnRpdGlvbiA9IExpc3QucGFydGl0aW9uO1xucHJlbHVkZS5maW5kID0gTGlzdC5maW5kO1xucHJlbHVkZS5oZWFkID0gTGlzdC5oZWFkO1xucHJlbHVkZS5maXJzdCA9IExpc3QuZmlyc3Q7XG5wcmVsdWRlLnRhaWwgPSBMaXN0LnRhaWw7XG5wcmVsdWRlLmxhc3QgPSBMaXN0Lmxhc3Q7XG5wcmVsdWRlLmluaXRpYWwgPSBMaXN0LmluaXRpYWw7XG5wcmVsdWRlLmVtcHR5ID0gTGlzdC5lbXB0eTtcbnByZWx1ZGUucmV2ZXJzZSA9IExpc3QucmV2ZXJzZTtcbnByZWx1ZGUuZGlmZmVyZW5jZSA9IExpc3QuZGlmZmVyZW5jZTtcbnByZWx1ZGUuaW50ZXJzZWN0aW9uID0gTGlzdC5pbnRlcnNlY3Rpb247XG5wcmVsdWRlLnVuaW9uID0gTGlzdC51bmlvbjtcbnByZWx1ZGUuY291bnRCeSA9IExpc3QuY291bnRCeTtcbnByZWx1ZGUuZ3JvdXBCeSA9IExpc3QuZ3JvdXBCeTtcbnByZWx1ZGUuZm9sZCA9IExpc3QuZm9sZDtcbnByZWx1ZGUuZm9sZGwgPSBMaXN0LmZvbGRsO1xucHJlbHVkZS5mb2xkMSA9IExpc3QuZm9sZDE7XG5wcmVsdWRlLmZvbGRsMSA9IExpc3QuZm9sZGwxO1xucHJlbHVkZS5mb2xkciA9IExpc3QuZm9sZHI7XG5wcmVsdWRlLmZvbGRyMSA9IExpc3QuZm9sZHIxO1xucHJlbHVkZS51bmZvbGRyID0gTGlzdC51bmZvbGRyO1xucHJlbHVkZS5hbmRMaXN0ID0gTGlzdC5hbmRMaXN0O1xucHJlbHVkZS5vckxpc3QgPSBMaXN0Lm9yTGlzdDtcbnByZWx1ZGUuYW55ID0gTGlzdC5hbnk7XG5wcmVsdWRlLmFsbCA9IExpc3QuYWxsO1xucHJlbHVkZS51bmlxdWUgPSBMaXN0LnVuaXF1ZTtcbnByZWx1ZGUudW5pcXVlQnkgPSBMaXN0LnVuaXF1ZUJ5O1xucHJlbHVkZS5zb3J0ID0gTGlzdC5zb3J0O1xucHJlbHVkZS5zb3J0V2l0aCA9IExpc3Quc29ydFdpdGg7XG5wcmVsdWRlLnNvcnRCeSA9IExpc3Quc29ydEJ5O1xucHJlbHVkZS5zdW0gPSBMaXN0LnN1bTtcbnByZWx1ZGUucHJvZHVjdCA9IExpc3QucHJvZHVjdDtcbnByZWx1ZGUubWVhbiA9IExpc3QubWVhbjtcbnByZWx1ZGUuYXZlcmFnZSA9IExpc3QuYXZlcmFnZTtcbnByZWx1ZGUuY29uY2F0ID0gTGlzdC5jb25jYXQ7XG5wcmVsdWRlLmNvbmNhdE1hcCA9IExpc3QuY29uY2F0TWFwO1xucHJlbHVkZS5mbGF0dGVuID0gTGlzdC5mbGF0dGVuO1xucHJlbHVkZS5tYXhpbXVtID0gTGlzdC5tYXhpbXVtO1xucHJlbHVkZS5taW5pbXVtID0gTGlzdC5taW5pbXVtO1xucHJlbHVkZS5tYXhpbXVtQnkgPSBMaXN0Lm1heGltdW1CeTtcbnByZWx1ZGUubWluaW11bUJ5ID0gTGlzdC5taW5pbXVtQnk7XG5wcmVsdWRlLnNjYW4gPSBMaXN0LnNjYW47XG5wcmVsdWRlLnNjYW5sID0gTGlzdC5zY2FubDtcbnByZWx1ZGUuc2NhbjEgPSBMaXN0LnNjYW4xO1xucHJlbHVkZS5zY2FubDEgPSBMaXN0LnNjYW5sMTtcbnByZWx1ZGUuc2NhbnIgPSBMaXN0LnNjYW5yO1xucHJlbHVkZS5zY2FucjEgPSBMaXN0LnNjYW5yMTtcbnByZWx1ZGUuc2xpY2UgPSBMaXN0LnNsaWNlO1xucHJlbHVkZS50YWtlID0gTGlzdC50YWtlO1xucHJlbHVkZS5kcm9wID0gTGlzdC5kcm9wO1xucHJlbHVkZS5zcGxpdEF0ID0gTGlzdC5zcGxpdEF0O1xucHJlbHVkZS50YWtlV2hpbGUgPSBMaXN0LnRha2VXaGlsZTtcbnByZWx1ZGUuZHJvcFdoaWxlID0gTGlzdC5kcm9wV2hpbGU7XG5wcmVsdWRlLnNwYW4gPSBMaXN0LnNwYW47XG5wcmVsdWRlLmJyZWFrTGlzdCA9IExpc3QuYnJlYWtMaXN0O1xucHJlbHVkZS56aXAgPSBMaXN0LnppcDtcbnByZWx1ZGUuemlwV2l0aCA9IExpc3QuemlwV2l0aDtcbnByZWx1ZGUuemlwQWxsID0gTGlzdC56aXBBbGw7XG5wcmVsdWRlLnppcEFsbFdpdGggPSBMaXN0LnppcEFsbFdpdGg7XG5wcmVsdWRlLmF0ID0gTGlzdC5hdDtcbnByZWx1ZGUuZWxlbUluZGV4ID0gTGlzdC5lbGVtSW5kZXg7XG5wcmVsdWRlLmVsZW1JbmRpY2VzID0gTGlzdC5lbGVtSW5kaWNlcztcbnByZWx1ZGUuZmluZEluZGV4ID0gTGlzdC5maW5kSW5kZXg7XG5wcmVsdWRlLmZpbmRJbmRpY2VzID0gTGlzdC5maW5kSW5kaWNlcztcbnByZWx1ZGUuYXBwbHkgPSBGdW5jLmFwcGx5O1xucHJlbHVkZS5jdXJyeSA9IEZ1bmMuY3Vycnk7XG5wcmVsdWRlLmZsaXAgPSBGdW5jLmZsaXA7XG5wcmVsdWRlLmZpeCA9IEZ1bmMuZml4O1xucHJlbHVkZS5vdmVyID0gRnVuYy5vdmVyO1xucHJlbHVkZS5zcGxpdCA9IFN0ci5zcGxpdDtcbnByZWx1ZGUuam9pbiA9IFN0ci5qb2luO1xucHJlbHVkZS5saW5lcyA9IFN0ci5saW5lcztcbnByZWx1ZGUudW5saW5lcyA9IFN0ci51bmxpbmVzO1xucHJlbHVkZS53b3JkcyA9IFN0ci53b3JkcztcbnByZWx1ZGUudW53b3JkcyA9IFN0ci51bndvcmRzO1xucHJlbHVkZS5jaGFycyA9IFN0ci5jaGFycztcbnByZWx1ZGUudW5jaGFycyA9IFN0ci51bmNoYXJzO1xucHJlbHVkZS5yZXBlYXQgPSBTdHIucmVwZWF0O1xucHJlbHVkZS5jYXBpdGFsaXplID0gU3RyLmNhcGl0YWxpemU7XG5wcmVsdWRlLmNhbWVsaXplID0gU3RyLmNhbWVsaXplO1xucHJlbHVkZS5kYXNoZXJpemUgPSBTdHIuZGFzaGVyaXplO1xucHJlbHVkZS52YWx1ZXMgPSBPYmoudmFsdWVzO1xucHJlbHVkZS5rZXlzID0gT2JqLmtleXM7XG5wcmVsdWRlLnBhaXJzVG9PYmogPSBPYmoucGFpcnNUb09iajtcbnByZWx1ZGUub2JqVG9QYWlycyA9IE9iai5vYmpUb1BhaXJzO1xucHJlbHVkZS5saXN0c1RvT2JqID0gT2JqLmxpc3RzVG9PYmo7XG5wcmVsdWRlLm9ialRvTGlzdHMgPSBPYmoub2JqVG9MaXN0cztcbnByZWx1ZGUubWF4ID0gTnVtLm1heDtcbnByZWx1ZGUubWluID0gTnVtLm1pbjtcbnByZWx1ZGUubmVnYXRlID0gTnVtLm5lZ2F0ZTtcbnByZWx1ZGUuYWJzID0gTnVtLmFicztcbnByZWx1ZGUuc2lnbnVtID0gTnVtLnNpZ251bTtcbnByZWx1ZGUucXVvdCA9IE51bS5xdW90O1xucHJlbHVkZS5yZW0gPSBOdW0ucmVtO1xucHJlbHVkZS5kaXYgPSBOdW0uZGl2O1xucHJlbHVkZS5tb2QgPSBOdW0ubW9kO1xucHJlbHVkZS5yZWNpcCA9IE51bS5yZWNpcDtcbnByZWx1ZGUucGkgPSBOdW0ucGk7XG5wcmVsdWRlLnRhdSA9IE51bS50YXU7XG5wcmVsdWRlLmV4cCA9IE51bS5leHA7XG5wcmVsdWRlLnNxcnQgPSBOdW0uc3FydDtcbnByZWx1ZGUubG4gPSBOdW0ubG47XG5wcmVsdWRlLnBvdyA9IE51bS5wb3c7XG5wcmVsdWRlLnNpbiA9IE51bS5zaW47XG5wcmVsdWRlLnRhbiA9IE51bS50YW47XG5wcmVsdWRlLmNvcyA9IE51bS5jb3M7XG5wcmVsdWRlLmFjb3MgPSBOdW0uYWNvcztcbnByZWx1ZGUuYXNpbiA9IE51bS5hc2luO1xucHJlbHVkZS5hdGFuID0gTnVtLmF0YW47XG5wcmVsdWRlLmF0YW4yID0gTnVtLmF0YW4yO1xucHJlbHVkZS50cnVuY2F0ZSA9IE51bS50cnVuY2F0ZTtcbnByZWx1ZGUucm91bmQgPSBOdW0ucm91bmQ7XG5wcmVsdWRlLmNlaWxpbmcgPSBOdW0uY2VpbGluZztcbnByZWx1ZGUuZmxvb3IgPSBOdW0uZmxvb3I7XG5wcmVsdWRlLmlzSXROYU4gPSBOdW0uaXNJdE5hTjtcbnByZWx1ZGUuZXZlbiA9IE51bS5ldmVuO1xucHJlbHVkZS5vZGQgPSBOdW0ub2RkO1xucHJlbHVkZS5nY2QgPSBOdW0uZ2NkO1xucHJlbHVkZS5sY20gPSBOdW0ubGNtO1xucHJlbHVkZS5WRVJTSU9OID0gJzEuMS4xJztcbm1vZHVsZS5leHBvcnRzID0gcHJlbHVkZTtcbmZ1bmN0aW9uIGN1cnJ5JChmLCBib3VuZCl7XG4gIHZhciBjb250ZXh0LFxuICBfY3VycnkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIGYubGVuZ3RoID4gMSA/IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGFyYW1zID0gYXJncyA/IGFyZ3MuY29uY2F0KCkgOiBbXTtcbiAgICAgIGNvbnRleHQgPSBib3VuZCA/IGNvbnRleHQgfHwgdGhpcyA6IHRoaXM7XG4gICAgICByZXR1cm4gcGFyYW1zLnB1c2guYXBwbHkocGFyYW1zLCBhcmd1bWVudHMpIDxcbiAgICAgICAgICBmLmxlbmd0aCAmJiBhcmd1bWVudHMubGVuZ3RoID9cbiAgICAgICAgX2N1cnJ5LmNhbGwoY29udGV4dCwgcGFyYW1zKSA6IGYuYXBwbHkoY29udGV4dCwgcGFyYW1zKTtcbiAgICB9IDogZjtcbiAgfTtcbiAgcmV0dXJuIF9jdXJyeSgpO1xufSIsInZhciBzdGQsIEdhbWUsIFNwcml0ZSwgQW5pbWF0ZWRTcHJpdGU7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcbkdhbWUgPSByZXF1aXJlKCcuL2dhbWUnKTtcblNwcml0ZSA9IHJlcXVpcmUoJy4vc3ByaXRlJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEFuaW1hdGVkU3ByaXRlID0gKGZ1bmN0aW9uKHN1cGVyY2xhc3Mpe1xuICB2YXIgcHJvdG90eXBlID0gZXh0ZW5kJCgoaW1wb3J0JChBbmltYXRlZFNwcml0ZSwgc3VwZXJjbGFzcykuZGlzcGxheU5hbWUgPSAnQW5pbWF0ZWRTcHJpdGUnLCBBbmltYXRlZFNwcml0ZSksIHN1cGVyY2xhc3MpLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBBbmltYXRlZFNwcml0ZTtcbiAgZnVuY3Rpb24gQW5pbWF0ZWRTcHJpdGUoZ3JhcGhpY3MsIHBhdGgsIHNvdXJjZVgsIHNvdXJjZVksIHdpZHRoLCBoZWlnaHQsIGZwcywgbnVtRnJhbWVzKXtcbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgdGhpcy5mcHMgPSBmcHM7XG4gICAgdGhpcy5udW1GcmFtZXMgPSBudW1GcmFtZXM7XG4gICAgc3RkLmxvZygnQW5pbWF0ZWRTcHJpdGU6Ok5ldyAtJywgc291cmNlWCwgc291cmNlWSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuICAgIEFuaW1hdGVkU3ByaXRlLnN1cGVyY2xhc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB0aGlzLmZyYW1lVGltZSA9IDEwMDAgLyB0aGlzLmZwcztcbiAgICB0aGlzLmN1cnJlbnRGcmFtZSA9IDA7XG4gICAgdGhpcy5lbGFwc2VkVGltZSA9IDA7XG4gIH1cbiAgcHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKGVsYXBzZWRUaW1lKXtcbiAgICB0aGlzLmVsYXBzZWRUaW1lICs9IGVsYXBzZWRUaW1lO1xuICAgIGlmICh0aGlzLmVsYXBzZWRUaW1lID4gdGhpcy5mcmFtZVRpbWUpIHtcbiAgICAgIHRoaXMuY3VycmVudEZyYW1lICs9IDE7XG4gICAgICB0aGlzLmVsYXBzZWRUaW1lID0gMDtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRGcmFtZSA8IHRoaXMubnVtRnJhbWVzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvdXJjZVJlY3QueCArPSBHYW1lLmtUaWxlU2l6ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc291cmNlUmVjdC54IC09IEdhbWUua1RpbGVTaXplICogKHRoaXMubnVtRnJhbWVzIC0gMSk7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRGcmFtZSA9IDA7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICByZXR1cm4gQW5pbWF0ZWRTcHJpdGU7XG59KFNwcml0ZSkpO1xuZnVuY3Rpb24gZXh0ZW5kJChzdWIsIHN1cCl7XG4gIGZ1bmN0aW9uIGZ1bigpe30gZnVuLnByb3RvdHlwZSA9IChzdWIuc3VwZXJjbGFzcyA9IHN1cCkucHJvdG90eXBlO1xuICAoc3ViLnByb3RvdHlwZSA9IG5ldyBmdW4pLmNvbnN0cnVjdG9yID0gc3ViO1xuICBpZiAodHlwZW9mIHN1cC5leHRlbmRlZCA9PSAnZnVuY3Rpb24nKSBzdXAuZXh0ZW5kZWQoc3ViKTtcbiAgcmV0dXJuIHN1Yjtcbn1cbmZ1bmN0aW9uIGltcG9ydCQob2JqLCBzcmMpe1xuICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gIGZvciAodmFyIGtleSBpbiBzcmMpIGlmIChvd24uY2FsbChzcmMsIGtleSkpIG9ialtrZXldID0gc3JjW2tleV07XG4gIHJldHVybiBvYmo7XG59IiwidmFyIHN0ZCwgU0RMLCBpbnB1dCwgZ3JhcGhpY3MsIFBsYXllciwga0RlYnVnTW9kZSwga0Zwcywga1RpbGVTaXplLCBydW5uaW5nLCBwbGF5ZXIsIGxhc3RGcmFtZVRpbWUsIGV2ZW50TG9vcCwgdXBkYXRlLCBkcmF3LCBjcmVhdGVUZXN0V29ybGQsIHN0YXJ0LCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuc3RkID0gcmVxdWlyZSgnc3RkJyk7XG5TREwgPSByZXF1aXJlKCdTREwnKTtcbmlucHV0ID0gcmVxdWlyZSgnLi9pbnB1dCcpO1xuZ3JhcGhpY3MgPSByZXF1aXJlKCcuL2dyYXBoaWNzJyk7XG5QbGF5ZXIgPSByZXF1aXJlKCcuL3BsYXllcicpO1xub3V0JC5rRGVidWdNb2RlID0ga0RlYnVnTW9kZSA9IHRydWU7XG5vdXQkLmtGcHMgPSBrRnBzID0gNjA7XG5vdXQkLmtUaWxlU2l6ZSA9IGtUaWxlU2l6ZSA9IDMyO1xuc3RkLmxvZyhcIkdhbWUgLSBuZXcgR2FtZVwiKTtcbnJ1bm5pbmcgPSB0cnVlO1xucGxheWVyID0gbnVsbDtcbmxhc3RGcmFtZVRpbWUgPSAwO1xuZXZlbnRMb29wID0gZnVuY3Rpb24oKXtcbiAgdmFyIHN0YXJ0VGltZSwgZXZlbnQsIGVsYXBzZWRUaW1lO1xuICBzdGFydFRpbWUgPSBTREwuZ2V0VGlja3MoKTtcbiAgaW5wdXQuYmVnaW5OZXdGcmFtZSgpO1xuICB3aGlsZSAoZXZlbnQgPSBTREwucG9sbEV2ZW50KCkpIHtcbiAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcbiAgICBjYXNlIFNETC5LRVlET1dOOlxuICAgICAgaW5wdXQua2V5RG93bkV2ZW50KGV2ZW50KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgU0RMLktFWVVQOlxuICAgICAgaW5wdXQua2V5VXBFdmVudChldmVudCk7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKHtcbiAgICAgICAgbWVzc2FnZTogXCJVbmtub3duIGV2ZW50IHR5cGU6IFwiICsgZXZlbnRcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBpZiAoaW5wdXQud2FzS2V5UHJlc3NlZChTREwuS0VZLkVTQ0FQRSkpIHtcbiAgICBydW5uaW5nID0gZmFsc2U7XG4gIH1cbiAgaWYgKGlucHV0LmlzS2V5SGVsZChTREwuS0VZLkxFRlQpICYmIGlucHV0LmlzS2V5SGVsZChTREwuS0VZLlJJR0hUKSkge1xuICAgIHBsYXllci5zdG9wTW92aW5nKCk7XG4gIH0gZWxzZSBpZiAoaW5wdXQuaXNLZXlIZWxkKFNETC5LRVkuTEVGVCkpIHtcbiAgICBwbGF5ZXIuc3RhcnRNb3ZpbmdMZWZ0KCk7XG4gIH0gZWxzZSBpZiAoaW5wdXQuaXNLZXlIZWxkKFNETC5LRVkuUklHSFQpKSB7XG4gICAgcGxheWVyLnN0YXJ0TW92aW5nUmlnaHQoKTtcbiAgfSBlbHNlIHtcbiAgICBwbGF5ZXIuc3RvcE1vdmluZygpO1xuICB9XG4gIHVwZGF0ZShTREwuZ2V0VGlja3MoKSAtIGxhc3RGcmFtZVRpbWUpO1xuICBkcmF3KCk7XG4gIGlmIChydW5uaW5nKSB7XG4gICAgbGFzdEZyYW1lVGltZSA9IFNETC5nZXRUaWNrcygpO1xuICAgIGVsYXBzZWRUaW1lID0gbGFzdEZyYW1lVGltZSAtIHN0YXJ0VGltZTtcbiAgICByZXR1cm4gU0RMLmRlbGF5KDEwMDAgLyBrRnBzIC0gZWxhcHNlZFRpbWUsIGV2ZW50TG9vcCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHN0ZC5sb2coJ0dhbWUgc3RvcHBlZC4nKTtcbiAgfVxufTtcbnVwZGF0ZSA9IGZ1bmN0aW9uKGVsYXBzZWRUaW1lKXtcbiAgcmV0dXJuIHBsYXllci51cGRhdGUoZWxhcHNlZFRpbWUpO1xufTtcbmRyYXcgPSBmdW5jdGlvbigpe1xuICBncmFwaGljcy5jbGVhcigpO1xuICByZXR1cm4gcGxheWVyLmRyYXcoZ3JhcGhpY3MsIDMyMCwgMjQwKTtcbn07XG5jcmVhdGVUZXN0V29ybGQgPSBmdW5jdGlvbigpe1xuICByZXR1cm4gcGxheWVyID0gbmV3IFBsYXllcigzMjAsIDI0MCk7XG59O1xub3V0JC5zdGFydCA9IHN0YXJ0ID0gZnVuY3Rpb24oKXtcbiAgU0RMLmluaXQoU0RMLklOSVRfRVZFUllUSElORyk7XG4gIGNyZWF0ZVRlc3RXb3JsZCgpO1xuICBldmVudExvb3AoKTtcbiAgcmV0dXJuIHN0ZC5kZWxheSgxMDAwMCwgZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gcnVubmluZyA9IGZhbHNlO1xuICB9KTtcbn07IiwidmFyIHN0ZCwgU0RMLCBrU2NyZWVuV2lkdGgsIGtTY3JlZW5IZWlnaHQsIHNjcmVlbiwgc3ByaXRlc2hlZXRzLCBsb2FkSW1hZ2UsIGJsaXRTdXJmYWNlLCBjbGVhciwgb3V0JCA9IHR5cGVvZiBleHBvcnRzICE9ICd1bmRlZmluZWQnICYmIGV4cG9ydHMgfHwgdGhpcztcbnN0ZCA9IHJlcXVpcmUoJ3N0ZCcpO1xuU0RMID0gcmVxdWlyZSgnU0RMJyk7XG5rU2NyZWVuV2lkdGggPSA2NDA7XG5rU2NyZWVuSGVpZ2h0ID0gNDgwO1xuc2NyZWVuID0gU0RMLnNldFZpZGVvTW9kZShrU2NyZWVuV2lkdGgsIGtTY3JlZW5IZWlnaHQsIFNETC5GVUxMU0NSRUVOKTtcbnNwcml0ZXNoZWV0cyA9IHt9O1xub3V0JC5sb2FkSW1hZ2UgPSBsb2FkSW1hZ2UgPSBmdW5jdGlvbihwYXRoKXtcbiAgaWYgKHNwcml0ZXNoZWV0c1twYXRoXSA9PSBudWxsKSB7XG4gICAgc3RkLmxvZygnR3JhcGhpY3M6OmxvYWRJbWFnZSAtIG5vIHN1cmZhY2UgZm9yJywgcGF0aCwgJy0gY3JlYXRpbmcgbmV3IHN1cmZhY2UnKTtcbiAgICBzcHJpdGVzaGVldHNbcGF0aF0gPSBuZXcgU0RMLlN1cmZhY2UocGF0aCk7XG4gIH0gZWxzZSB7XG4gICAgc3RkLmxvZygnR3JhcGhpY3M6OmxvYWRJbWFnZSAtIHJldXNpbmcgYXZhaWxhYmxlIHN1cmZhY2UgZm9yJywgcGF0aCk7XG4gIH1cbiAgcmV0dXJuIHNwcml0ZXNoZWV0c1twYXRoXTtcbn07XG5vdXQkLmJsaXRTdXJmYWNlID0gYmxpdFN1cmZhY2UgPSBmdW5jdGlvbihzb3VyY2UsIHNyY1JlY3QsIGRlc3RSZWN0KXtcbiAgcmV0dXJuIFNETC5ibGl0U3VyZmFjZShzb3VyY2UsIHNyY1JlY3QsIHNjcmVlbiwgZGVzdFJlY3QpO1xufTtcbm91dCQuY2xlYXIgPSBjbGVhciA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiBzY3JlZW4uY2xlYXIoKTtcbn07IiwidmFyIHN0ZCwgSW5wdXQ7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcbklucHV0ID0gKGZ1bmN0aW9uKCl7XG4gIElucHV0LmRpc3BsYXlOYW1lID0gJ0lucHV0JztcbiAgdmFyIHByb3RvdHlwZSA9IElucHV0LnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBJbnB1dDtcbiAgZnVuY3Rpb24gSW5wdXQoKXtcbiAgICB0aGlzLmhlbGRLZXlzID0ge307XG4gICAgdGhpcy5wcmVzc2VkS2V5cyA9IHt9O1xuICAgIHRoaXMucmVsZWFzZWRLZXlzID0ge307XG4gIH1cbiAgcHJvdG90eXBlLmJlZ2luTmV3RnJhbWUgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMucHJlc3NlZEtleXMgPSB7fTtcbiAgICByZXR1cm4gdGhpcy5yZWxlYXNlZEtleXMgPSB7fTtcbiAgfTtcbiAgcHJvdG90eXBlLmtleURvd25FdmVudCA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgICB0aGlzLnByZXNzZWRLZXlzW2V2ZW50LmtleV0gPSB0cnVlO1xuICAgIHJldHVybiB0aGlzLmhlbGRLZXlzW2V2ZW50LmtleV0gPSB0cnVlO1xuICB9O1xuICBwcm90b3R5cGUua2V5VXBFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgICB0aGlzLnJlbGVhc2VkS2V5c1tldmVudC5rZXldID0gdHJ1ZTtcbiAgICByZXR1cm4gdGhpcy5oZWxkS2V5c1tldmVudC5rZXldID0gZmFsc2U7XG4gIH07XG4gIHByb3RvdHlwZS53YXNLZXlQcmVzc2VkID0gZnVuY3Rpb24oa2V5KXtcbiAgICByZXR1cm4gdGhpcy5wcmVzc2VkS2V5c1trZXldO1xuICB9O1xuICBwcm90b3R5cGUud2FzS2V5UmVsZWFzZWQgPSBmdW5jdGlvbihrZXkpe1xuICAgIHJldHVybiB0aGlzLnJlbGVhc2VkS2V5c1trZXldO1xuICB9O1xuICBwcm90b3R5cGUuaXNLZXlIZWxkID0gZnVuY3Rpb24oa2V5KXtcbiAgICByZXR1cm4gdGhpcy5oZWxkS2V5c1trZXldO1xuICB9O1xuICByZXR1cm4gSW5wdXQ7XG59KCkpO1xubW9kdWxlLmV4cG9ydHMgPSBuZXcgSW5wdXQ7IiwidmFyIHN0ZCwgZ3JhcGhpY3MsIEdhbWUsIEFuaW1hdGVkU3ByaXRlLCBrU3ByaXRlRnJhbWVUaW1lLCBrU2xvd2Rvd25GYWN0b3IsIGtXYWxraW5nQWNjZWxlcmF0aW9uLCBrTWF4U3BlZWRYLCBQbGF5ZXI7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcbmdyYXBoaWNzID0gcmVxdWlyZSgnLi9ncmFwaGljcycpO1xuR2FtZSA9IHJlcXVpcmUoJy4vZ2FtZScpO1xuQW5pbWF0ZWRTcHJpdGUgPSByZXF1aXJlKCcuL2FuaW1hdGVkLXNwcml0ZScpO1xua1Nwcml0ZUZyYW1lVGltZSA9IDE1O1xua1Nsb3dkb3duRmFjdG9yID0gMC44O1xua1dhbGtpbmdBY2NlbGVyYXRpb24gPSAwLjAwMTI7XG5rTWF4U3BlZWRYID0gMC4zMjU7XG5tb2R1bGUuZXhwb3J0cyA9IFBsYXllciA9IChmdW5jdGlvbigpe1xuICBQbGF5ZXIuZGlzcGxheU5hbWUgPSAnUGxheWVyJztcbiAgdmFyIHByb3RvdHlwZSA9IFBsYXllci5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gUGxheWVyO1xuICBmdW5jdGlvbiBQbGF5ZXIoeCwgeSl7XG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICAgIHRoaXMudmVsb2NpdHlYID0gMDtcbiAgICB0aGlzLmFjY2VsZXJhdGlvblggPSAwO1xuICAgIHRoaXMuc3ByaXRlID0gbmV3IEFuaW1hdGVkU3ByaXRlKGdyYXBoaWNzLCAnY29udGVudC9NeUNoYXIuYm1wJywgMCwgMCwgR2FtZS5rVGlsZVNpemUsIEdhbWUua1RpbGVTaXplLCBrU3ByaXRlRnJhbWVUaW1lLCAzKTtcbiAgfVxuICBwcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oZWxhcHNlZFRpbWUpe1xuICAgIHRoaXMuc3ByaXRlLnVwZGF0ZShlbGFwc2VkVGltZSk7XG4gICAgdGhpcy54ICs9IHN0ZC5yb3VuZCh0aGlzLnZlbG9jaXR5WCAqIGVsYXBzZWRUaW1lKTtcbiAgICB0aGlzLnZlbG9jaXR5WCArPSB0aGlzLmFjY2VsZXJhdGlvblggKiBlbGFwc2VkVGltZTtcbiAgICBpZiAodGhpcy5hY2NlbGVyYXRpb25YIDwgMCkge1xuICAgICAgcmV0dXJuIHRoaXMudmVsb2NpdHlYID0gc3RkLm1heCh0aGlzLnZlbG9jaXR5WCwgLWtNYXhTcGVlZFgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5hY2NlbGVyYXRpb25YID4gMCkge1xuICAgICAgcmV0dXJuIHRoaXMudmVsb2NpdHlYID0gc3RkLm1pbih0aGlzLnZlbG9jaXR5WCwga01heFNwZWVkWCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnZlbG9jaXR5WCAqPSBrU2xvd2Rvd25GYWN0b3I7XG4gICAgfVxuICB9O1xuICBwcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKGdyYXBoaWNzKXtcbiAgICByZXR1cm4gdGhpcy5zcHJpdGUuZHJhdyhncmFwaGljcywgdGhpcy54LCB0aGlzLnkpO1xuICB9O1xuICBwcm90b3R5cGUuc3RhcnRNb3ZpbmdMZWZ0ID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gdGhpcy5hY2NlbGVyYXRpb25YID0gLWtXYWxraW5nQWNjZWxlcmF0aW9uO1xuICB9O1xuICBwcm90b3R5cGUuc3RhcnRNb3ZpbmdSaWdodCA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuYWNjZWxlcmF0aW9uWCA9IGtXYWxraW5nQWNjZWxlcmF0aW9uO1xuICB9O1xuICBwcm90b3R5cGUuc3RvcE1vdmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuYWNjZWxlcmF0aW9uWCA9IDA7XG4gIH07XG4gIHJldHVybiBQbGF5ZXI7XG59KCkpOyIsInZhciByYWYsIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXM7XG5yYWYgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG5pbXBvcnQkKG91dCQsIHtcbiAgZGVsYXk6IGZ1bmN0aW9uKHRpbWUsIM67KXtcbiAgICByZXR1cm4gcmFmKM67KTtcbiAgfVxufSk7XG5mdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgdmFyIG93biA9IHt9Lmhhc093blByb3BlcnR5O1xuICBmb3IgKHZhciBrZXkgaW4gc3JjKSBpZiAob3duLmNhbGwoc3JjLCBrZXkpKSBvYmpba2V5XSA9IHNyY1trZXldO1xuICByZXR1cm4gb2JqO1xufSIsInZhciBzdGQsIHF1ZXVlLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuc3RkID0gcmVxdWlyZSgnc3RkJyk7XG5xdWV1ZSA9IFtdO1xuaW1wb3J0JChvdXQkLCB7XG4gIHB1c2hFdmVudDogZnVuY3Rpb24oZXZlbnQpe1xuICAgIHJldHVybiBxdWV1ZS5wdXNoKGV2ZW50KTtcbiAgfSxcbiAgcG9sbEV2ZW50OiBmdW5jdGlvbigpe1xuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBxdWV1ZS5zaGlmdCgpO1xuICAgIH1cbiAgfVxufSk7XG5mdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgdmFyIG93biA9IHt9Lmhhc093blByb3BlcnR5O1xuICBmb3IgKHZhciBrZXkgaW4gc3JjKSBpZiAob3duLmNhbGwoc3JjLCBrZXkpKSBvYmpba2V5XSA9IHNyY1trZXldO1xuICByZXR1cm4gb2JqO1xufSIsInZhciBzdGQsIGRlbGF5LCB0aW1lciwgc2NyZWVuLCBrZXlib2FyZCwgZXZlbnRRdWV1ZSwgUmVjdCwgU3VyZmFjZSwgcmVmJCwgSU5JVF9FVkVSWVRISU5HLCBGVUxMU0NSRUVOLCBpbml0LCBLRVksIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXM7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcbmRlbGF5ID0gcmVxdWlyZSgnLi9kZWxheScpO1xudGltZXIgPSByZXF1aXJlKCcuL3RpbWVyJyk7XG5zY3JlZW4gPSByZXF1aXJlKCcuL3NjcmVlbicpO1xua2V5Ym9hcmQgPSByZXF1aXJlKCcuL2tleWJvYXJkJyk7XG5ldmVudFF1ZXVlID0gcmVxdWlyZSgnLi9ldmVudC1xdWV1ZScpO1xub3V0JC5SZWN0ID0gUmVjdCA9IHJlcXVpcmUoJy4vcmVjdCcpO1xub3V0JC5TdXJmYWNlID0gU3VyZmFjZSA9IHJlcXVpcmUoJy4vc3VyZmFjZScpO1xucmVmJCA9IHN0ZFsnZW51bSddLCBJTklUX0VWRVJZVEhJTkcgPSByZWYkWzBdLCBGVUxMU0NSRUVOID0gcmVmJFsxXTtcbm91dCQuaW5pdCA9IGluaXQgPSBmdW5jdGlvbihtb2RlKXtcbiAgc3RkLmxvZyhcIlNETDo6SW5pdCAtIHdpdGggbW9kZTpcIiwgbW9kZSk7XG4gIHRpbWVyLmluaXQoKTtcbiAgcmV0dXJuIGtleWJvYXJkLmluaXQoKTtcbn07XG5vdXQkLklOSVRfRVZFUllUSElORyA9IElOSVRfRVZFUllUSElORztcbm91dCQuRlVMTFNDUkVFTiA9IEZVTExTQ1JFRU47XG5vdXQkLktFWURPV04gPSBrZXlib2FyZC5LRVlET1dOO1xub3V0JC5LRVlVUCA9IGtleWJvYXJkLktFWVVQO1xub3V0JC5LRVkgPSBLRVkgPSBrZXlib2FyZC5LRVlDT0RFUztcbm91dCQuZGVsYXkgPSBkZWxheS5kZWxheTtcbm91dCQuZ2V0VGlja3MgPSB0aW1lci5nZXRUaWNrcztcbm91dCQucG9sbEV2ZW50ID0gZXZlbnRRdWV1ZS5wb2xsRXZlbnQ7XG5vdXQkLnNldFZpZGVvTW9kZSA9IHNjcmVlbi5zZXRWaWRlb01vZGU7XG5vdXQkLmJsaXRTdXJmYWNlID0gU3VyZmFjZS5ibGl0U3VyZmFjZTtcbm91dCQubG9hZEltYWdlID0gU3VyZmFjZS5sb2FkSW1hZ2U7IiwidmFyIHN0ZCwgcXVldWUsIHJlZiQsIEtFWURPV04sIEtFWVVQLCBLRVlDT0RFUywgbW9uaXRvcktleXMsIGluaXQsIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXM7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcbnF1ZXVlID0gcmVxdWlyZSgnLi9ldmVudC1xdWV1ZScpO1xucmVmJCA9IHN0ZFsnZW51bSddLCBLRVlET1dOID0gcmVmJFswXSwgS0VZVVAgPSByZWYkWzFdO1xub3V0JC5LRVlDT0RFUyA9IEtFWUNPREVTID0ge1xuICBFU0NBUEU6IDI3LFxuICBMRUZUOiAzNyxcbiAgVVA6IDM4LFxuICBSSUdIVDogMzksXG4gIERPV046IDQwXG59O1xubW9uaXRvcktleXMgPSBmdW5jdGlvbigpe1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oYXJnJCl7XG4gICAgdmFyIHdoaWNoO1xuICAgIHdoaWNoID0gYXJnJC53aGljaDtcbiAgICBzdGQuaW5mbyh3aGljaCk7XG4gICAgcXVldWUucHVzaEV2ZW50KHtcbiAgICAgIHR5cGU6IEtFWURPV04sXG4gICAgICBrZXk6IHdoaWNoXG4gICAgfSk7XG4gICAgcmV0dXJuIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH0pO1xuICByZXR1cm4gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihhcmckKXtcbiAgICB2YXIgd2hpY2g7XG4gICAgd2hpY2ggPSBhcmckLndoaWNoO1xuICAgIHF1ZXVlLnB1c2hFdmVudCh7XG4gICAgICB0eXBlOiBLRVlVUCxcbiAgICAgIGtleTogd2hpY2hcbiAgICB9KTtcbiAgICByZXR1cm4gZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgfSk7XG59O1xub3V0JC5pbml0ID0gaW5pdCA9IGZ1bmN0aW9uKCl7XG4gIHN0ZC5sb2coXCJTREw6OktleWJvYXJkIC0gTW9uaXRvcmluZyBrZXkgaW5wdXRcIik7XG4gIHJldHVybiBtb25pdG9yS2V5cygpO1xufTtcbm91dCQuS0VZRE9XTiA9IEtFWURPV047XG5vdXQkLktFWVVQID0gS0VZVVA7IiwidmFyIFJlY3Q7XG5tb2R1bGUuZXhwb3J0cyA9IFJlY3QgPSAoZnVuY3Rpb24oKXtcbiAgUmVjdC5kaXNwbGF5TmFtZSA9ICdSZWN0JztcbiAgdmFyIHByb3RvdHlwZSA9IFJlY3QucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IFJlY3Q7XG4gIGZ1bmN0aW9uIFJlY3QoeCwgeSwgdywgaCl7XG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICAgIHRoaXMudyA9IHc7XG4gICAgdGhpcy5oID0gaDtcbiAgfVxuICByZXR1cm4gUmVjdDtcbn0oKSk7IiwidmFyIHN0ZCwgU3VyZmFjZSwgRlVMTFNDUkVFTiwgY3JlYXRlTmV3U2NyZWVuLCBzZXRWaWRlb01vZGUsIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXM7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcblN1cmZhY2UgPSByZXF1aXJlKCcuL3N1cmZhY2UnKTtcbkZVTExTQ1JFRU4gPSBzdGRbJ2VudW0nXVswXTtcbmNyZWF0ZU5ld1NjcmVlbiA9IGZ1bmN0aW9uKHcsIGgsIGlzRnVsbHNjcmVlbil7XG4gIHZhciBzY3JlZW47XG4gIHNjcmVlbiA9IG5ldyBTdXJmYWNlKG51bGwsIHcsIGgpO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmVlbi5jYW52YXMpO1xuICByZXR1cm4gc2NyZWVuO1xufTtcbm91dCQuc2V0VmlkZW9Nb2RlID0gc2V0VmlkZW9Nb2RlID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgZmxhZ3Mpe1xuICByZXR1cm4gY3JlYXRlTmV3U2NyZWVuKHdpZHRoLCBoZWlnaHQsIGZsYWdzID09PSBGVUxMU0NSRUVOKTtcbn07IiwidmFyIHN0ZCwgUmVjdCwgU3VyZmFjZTtcbnN0ZCA9IHJlcXVpcmUoJ3N0ZCcpO1xuUmVjdCA9IHJlcXVpcmUoJy4vcmVjdCcpO1xubW9kdWxlLmV4cG9ydHMgPSBTdXJmYWNlID0gKGZ1bmN0aW9uKCl7XG4gIFN1cmZhY2UuZGlzcGxheU5hbWUgPSAnU3VyZmFjZSc7XG4gIHZhciBwcm90b3R5cGUgPSBTdXJmYWNlLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBTdXJmYWNlO1xuICBmdW5jdGlvbiBTdXJmYWNlKHNyYywgd2lkdGgsIGhlaWdodCl7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB0aGlzLnJlc2V0Q2FudmFzU2l6ZSgpO1xuICAgIGlmICh0eXBlb2Ygc3JjID09PSAnc3RyaW5nJykge1xuICAgICAgc3RkLmxvZygnU0RMOjpTdXJmYWNlIC0gc3JjIHVubG9hZGVkLiBMb2FkaW5nLi4uJywgc3JjKTtcbiAgICAgIHRoaXMubG9hZEltYWdlRGF0YShzcmMpO1xuICAgIH0gZWxzZSBpZiAoc3JjICE9IG51bGwpIHtcbiAgICAgIHN0ZC5sb2coJ1NETDo6U3VyZmFjZSAtIHNyYyBhbHJlYWR5IHByZXBhcmVkOicsIHNyYyk7XG4gICAgICB0aGlzLnNhdmVJbWFnZURhdGEoc3JjKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RkLmxvZygnU0RMOjpTdXJmYWNlIC0gQmxhbmsgc3VyZmFjZSBjcmVhdGVkJyk7XG4gICAgfVxuICB9XG4gIHByb3RvdHlwZS5yZXNldENhbnZhc1NpemUgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy53aWR0aDtcbiAgICByZXR1cm4gdGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG4gIH07XG4gIHByb3RvdHlwZS5pbmhlcml0U2l6ZUZyb21JbWFnZSA9IGZ1bmN0aW9uKGRhdGEpe1xuICAgIGlmICh0aGlzLndpZHRoID09IG51bGwgJiYgdGhpcy5oZWlnaHQgPT0gbnVsbCkge1xuICAgICAgdGhpcy53aWR0aCA9IGRhdGEubmF0dXJhbFdpZHRoO1xuICAgICAgdGhpcy5oZWlnaHQgPSBkYXRhLm5hdHVyYWxIZWlnaHQ7XG4gICAgICByZXR1cm4gdGhpcy5yZXNldENhbnZhc1NpemUoKTtcbiAgICB9XG4gIH07XG4gIHByb3RvdHlwZS5sb2FkSW1hZ2VEYXRhID0gZnVuY3Rpb24ocGF0aCl7XG4gICAgdmFyIGRhdGEsIHRoaXMkID0gdGhpcztcbiAgICBkYXRhID0gbmV3IEltYWdlO1xuICAgIGRhdGEub25sb2FkID0gZnVuY3Rpb24oKXtcbiAgICAgIHN0ZC5sb2coJ1NETDo6U3VyZmFjZTo6bG9hZEltYWdlRGF0YSAtIGFzc2V0IHJlYWR5OicsIHBhdGgpO1xuICAgICAgdGhpcyQuaW5oZXJpdFNpemVGcm9tSW1hZ2UoZGF0YSk7XG4gICAgICByZXR1cm4gdGhpcyQuc2F2ZUltYWdlRGF0YShkYXRhKTtcbiAgICB9O1xuICAgIHJldHVybiBkYXRhLnNyYyA9IHBhdGg7XG4gIH07XG4gIHByb3RvdHlwZS5zYXZlSW1hZ2VEYXRhID0gZnVuY3Rpb24oZGF0YSl7XG4gICAgc3RkLmxvZygnU0RMOjpTdXJmYWNlOjpzYXZlSW1hZ2VEYXRhIC0nLCBkYXRhKTtcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgIHRoaXMucmVhZHkgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzLmN0eC5kcmF3SW1hZ2UodGhpcy5kYXRhLCAwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gIH07XG4gIHByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gIH07XG4gIFN1cmZhY2UuYmxpdFN1cmZhY2UgPSBmdW5jdGlvbihzb3VyY2UsIHNyY1JlY3QsIGRlc3QsIGRlc3RSZWN0KXtcbiAgICByZXR1cm4gZGVzdC5jdHguZHJhd0ltYWdlKHNvdXJjZS5jYW52YXMsIHNyY1JlY3QueCwgc3JjUmVjdC55LCBzcmNSZWN0LncsIHNyY1JlY3QuaCwgZGVzdFJlY3QueCwgZGVzdFJlY3QueSwgZGVzdFJlY3QudywgZGVzdFJlY3QuaCk7XG4gIH07XG4gIHJldHVybiBTdXJmYWNlO1xufSgpKTsiLCJ2YXIgc3RhcnRUaW1lLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuc3RhcnRUaW1lID0gMDtcbmltcG9ydCQob3V0JCwge1xuICBpbml0OiBmdW5jdGlvbigpe1xuICAgIHJldHVybiBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICB9LFxuICBnZXRUaWNrczogZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgfVxufSk7XG5mdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgdmFyIG93biA9IHt9Lmhhc093blByb3BlcnR5O1xuICBmb3IgKHZhciBrZXkgaW4gc3JjKSBpZiAob3duLmNhbGwoc3JjLCBrZXkpKSBvYmpba2V5XSA9IHNyY1trZXldO1xuICByZXR1cm4gb2JqO1xufSIsInZhciBTREwsIHN0ZCwgR2FtZSwgU3ByaXRlO1xuU0RMID0gcmVxdWlyZSgnU0RMJyk7XG5zdGQgPSByZXF1aXJlKCdzdGQnKTtcbkdhbWUgPSByZXF1aXJlKCcuL2dhbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gU3ByaXRlID0gKGZ1bmN0aW9uKCl7XG4gIFNwcml0ZS5kaXNwbGF5TmFtZSA9ICdTcHJpdGUnO1xuICB2YXIgcHJvdG90eXBlID0gU3ByaXRlLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBTcHJpdGU7XG4gIGZ1bmN0aW9uIFNwcml0ZShncmFwaGljcywgcGF0aCwgc291cmNlWCwgc291cmNlWSwgd2lkdGgsIGhlaWdodCl7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHRoaXMuc291cmNlUmVjdCA9IG5ldyBTREwuUmVjdChzb3VyY2VYLCBzb3VyY2VZLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB0aGlzLnNwcml0ZVNoZWV0ID0gZ3JhcGhpY3MubG9hZEltYWdlKHBhdGgpO1xuICAgIGlmIChHYW1lLmtEZWJ1Z01vZGUpIHtcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5zcHJpdGVTaGVldC5jYW52YXMpO1xuICAgIH1cbiAgfVxuICBwcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKGdyYXBoaWNzLCB4LCB5KXtcbiAgICB2YXIgZGVzdFJlY3Q7XG4gICAgZGVzdFJlY3QgPSBuZXcgU0RMLlJlY3QoeCwgeSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuICAgIHJldHVybiBncmFwaGljcy5ibGl0U3VyZmFjZSh0aGlzLnNwcml0ZVNoZWV0LCB0aGlzLnNvdXJjZVJlY3QsIGRlc3RSZWN0KTtcbiAgfTtcbiAgcmV0dXJuIFNwcml0ZTtcbn0oKSk7IiwidmFyIHJlZiQsIGlkLCBtYXAsIGZpbHRlciwgYW55LCBsb2csIGluZm8sIG9iak1hcCwgZmxpcCwgZGVsYXksIHJvdW5kLCBtYXgsIG1pbiwgb3V0JCA9IHR5cGVvZiBleHBvcnRzICE9ICd1bmRlZmluZWQnICYmIGV4cG9ydHMgfHwgdGhpcztcbnJlZiQgPSByZXF1aXJlKCdwcmVsdWRlLWxzJyksIGlkID0gcmVmJC5pZCwgbWFwID0gcmVmJC5tYXAsIGZpbHRlciA9IHJlZiQuZmlsdGVyLCBhbnkgPSByZWYkLmFueTtcbm91dCQubG9nID0gbG9nID0gZnVuY3Rpb24oKXtcbiAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcbiAgcmV0dXJuIGFyZ3VtZW50c1swXTtcbn07XG5vdXQkLmluZm8gPSBpbmZvID0gZnVuY3Rpb24oKXtcbiAgY29uc29sZS5pbmZvLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XG4gIHJldHVybiBhcmd1bWVudHNbMF07XG59O1xub3V0JC5vYmpNYXAgPSBvYmpNYXAgPSBjdXJyeSQoZnVuY3Rpb24ozrssIG8pe1xuICB2YXIgaywgdiwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChrIGluIG8pIHtcbiAgICB2ID0gb1trXTtcbiAgICByZXN1bHRzJC5wdXNoKM67KGssIHYpKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbm91dCQuZmxpcCA9IGZsaXAgPSBmdW5jdGlvbijOuyl7XG4gIHJldHVybiBjdXJyeSQoZnVuY3Rpb24oYSwgYil7XG4gICAgcmV0dXJuIM67KGIsIGEpO1xuICB9KTtcbn07XG5vdXQkLmRlbGF5ID0gZGVsYXkgPSBmbGlwKHNldFRpbWVvdXQpO1xub3V0JC5yb3VuZCA9IHJvdW5kID0gTWF0aC5yb3VuZDtcbm91dCQubWF4ID0gbWF4ID0gTWF0aC5tYXg7XG5vdXQkLm1pbiA9IG1pbiA9IE1hdGgubWluO1xucmVmJCA9IG91dCQ7XG5yZWYkLmlkID0gaWQ7XG5yZWYkLmFueSA9IGFueTtcbnJlZiQubWFwID0gbWFwO1xucmVmJC5maWx0ZXIgPSBmaWx0ZXI7XG5yZWYkWydlbnVtJ10gPSBbMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTksIDIwXTtcbmZ1bmN0aW9uIGN1cnJ5JChmLCBib3VuZCl7XG4gIHZhciBjb250ZXh0LFxuICBfY3VycnkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIGYubGVuZ3RoID4gMSA/IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGFyYW1zID0gYXJncyA/IGFyZ3MuY29uY2F0KCkgOiBbXTtcbiAgICAgIGNvbnRleHQgPSBib3VuZCA/IGNvbnRleHQgfHwgdGhpcyA6IHRoaXM7XG4gICAgICByZXR1cm4gcGFyYW1zLnB1c2guYXBwbHkocGFyYW1zLCBhcmd1bWVudHMpIDxcbiAgICAgICAgICBmLmxlbmd0aCAmJiBhcmd1bWVudHMubGVuZ3RoID9cbiAgICAgICAgX2N1cnJ5LmNhbGwoY29udGV4dCwgcGFyYW1zKSA6IGYuYXBwbHkoY29udGV4dCwgcGFyYW1zKTtcbiAgICB9IDogZjtcbiAgfTtcbiAgcmV0dXJuIF9jdXJyeSgpO1xufSJdfQ==
